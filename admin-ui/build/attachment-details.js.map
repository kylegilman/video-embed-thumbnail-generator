{"version":3,"file":"attachment-details.js","mappings":";;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACkD;AACF;AAChD,iCAAiC,sDAAI,CAAC,sDAAG;AACzC;AACA;AACA,yBAAyB,sDAAI,CAAC,uDAAI;AAClC;AACA,GAAG;AACH,CAAC;AACD,iEAAe,WAAW,EAAC;AAC3B,wC;;;;;;;;;;;;;;;;;;ACbA;AACA;AACA;AACkD;AACF;AAChD,+BAA+B,sDAAI,CAAC,sDAAG;AACvC;AACA;AACA,yBAAyB,sDAAI,CAAC,uDAAI;AAClC;AACA,GAAG;AACH,CAAC;AACD,iEAAe,SAAS,EAAC;AACzB,sC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACbA;;AAE8C;AACF;AASb;AACsB;AACY;AACrB;AACc;AACvB;AAAA;AAEnC,MAAMyB,iBAAiB,GAAGA,CAAC;EAAEC,UAAU;EAAEC,OAAO,GAAG,CAAC;AAAE,CAAC,KAAK;EAC3D,MAAM;IAAEC,EAAE;IAAEC;EAAI,CAAC,GAAGH,UAAU;EAC9B,MAAM;IAAEI;EAAc,CAAC,GAAGH,OAAO;EACjC,MAAM,CAACI,YAAY,EAAEC,eAAe,CAAC,GAAGjB,4DAAQ,CAAC,CAAC,CAAC,CAAC;EACpD,MAAM,CAACkB,aAAa,EAAEC,gBAAgB,CAAC,GAAGnB,4DAAQ,CAAC,CAAC;EACpD,MAAM,CAACoB,YAAY,EAAEC,eAAe,CAAC,GAAGrB,4DAAQ,CAAC,IAAI,CAAC,CAAC,CAAC;EACxD,MAAM,CAACsB,gBAAgB,EAAEC,mBAAmB,CAAC,GAAGvB,4DAAQ,CAAC,IAAI,CAAC,CAAC,CAAC;EAChE,MAAM,CAACwB,aAAa,EAAEC,gBAAgB,CAAC,GAAGzB,4DAAQ,CAAC,KAAK,CAAC;EACzD,MAAM,CAAC0B,SAAS,EAAEC,YAAY,CAAC,GAAG3B,4DAAQ,CAAC,KAAK,CAAC;EACjD,MAAM,CAAC4B,UAAU,EAAEC,aAAa,CAAC,GAAG7B,4DAAQ,CAAC,KAAK,CAAC;EACnD,MAAM8B,gBAAgB,GAAGhC,0DAAM,CAAC,IAAI,CAAC;EACrC,MAAMiC,YAAY,GAAG,qBAAqB;EAE1C,MAAMC,SAAS,GAAGA,CAACC,IAAI,EAAEC,IAAI,KAAK;IACjC,IAAID,IAAI,KAAKC,IAAI,EAAE;MAClB,OAAO,IAAI;IACZ;IAEA,IACC,OAAOD,IAAI,KAAK,QAAQ,IACxB,OAAOC,IAAI,KAAK,QAAQ,IACxBD,IAAI,KAAK,IAAI,IACbC,IAAI,KAAK,IAAI,EACZ;MACD,OAAO,KAAK;IACb;IAEA,MAAMC,KAAK,GAAGC,MAAM,CAACC,IAAI,CAACJ,IAAI,CAAC;IAC/B,MAAMK,KAAK,GAAGF,MAAM,CAACC,IAAI,CAACH,IAAI,CAAC;IAE/B,IAAIC,KAAK,CAACI,MAAM,KAAKD,KAAK,CAACC,MAAM,EAAE;MAClC,OAAO,KAAK;IACb;IAEA,KAAK,MAAMC,GAAG,IAAIL,KAAK,EAAE;MACxB,IAAI,CAACG,KAAK,CAACG,QAAQ,CAACD,GAAG,CAAC,IAAI,CAACR,SAAS,CAACC,IAAI,CAACO,GAAG,CAAC,EAAEN,IAAI,CAACM,GAAG,CAAC,CAAC,EAAE;QAC7D,OAAO,KAAK;MACb;IACD;IAEA,OAAO,IAAI;EACZ,CAAC;EAED,MAAME,kBAAkB,GAAIC,QAAQ,IAAK;IACxC1B,eAAe,CAAE2B,mBAAmB,IAAK;MACxC,IAAID,QAAQ,IAAI,OAAOA,QAAQ,KAAK,QAAQ,EAAE;QAC7C,MAAME,UAAU,GAAG;UAAE,GAAGF;QAAS,CAAC;QAClCP,MAAM,CAACC,IAAI,CAACQ,UAAU,CAAC,CAACC,OAAO,CAAEN,GAAG,IAAK;UACxC,MAAMO,SAAS,GAAGF,UAAU,CAACL,GAAG,CAAC;UACjC,MAAMQ,SAAS,GAAGJ,mBAAmB,GAAGJ,GAAG,CAAC;;UAE5C;UACAO,SAAS,CAACE,OAAO,GAAGD,SAAS,EAAEC,OAAO,IAAI,KAAK;;UAE/C;UACA,IAAIF,SAAS,CAACG,YAAY,IAAIH,SAAS,CAACI,QAAQ,EAAE;YACjD;YACA,IAAIH,SAAS,EAAEG,QAAQ,EAAE;cACxBJ,SAAS,CAACI,QAAQ,GAAG;gBACpB,GAAGH,SAAS,CAACG,QAAQ;gBACrB,GAAGJ,SAAS,CAACI;cACd,CAAC;YACF,CAAC,MAAM;cACN;cACAJ,SAAS,CAACI,QAAQ,CAACC,OAAO,GACzBL,SAAS,CAACI,QAAQ,CAACC,OAAO,GAAG,CAAC,GAC3BL,SAAS,CAACI,QAAQ,CAACC,OAAO,GAC1B,CAAC;YACN;UACD;QACD,CAAC,CAAC;;QAEF;QACA,IAAI,CAACpB,SAAS,CAACY,mBAAmB,EAAEC,UAAU,CAAC,EAAE;UAChD,OAAOA,UAAU;QAClB;MACD,CAAC,MAAM,IAAI,CAACb,SAAS,CAACY,mBAAmB,EAAED,QAAQ,CAAC,EAAE;QACrD;QACA,OAAOA,QAAQ;MAChB;MACA,OAAOC,mBAAmB;IAC3B,CAAC,CAAC;EACH,CAAC;EAED,MAAMS,iBAAiB,GAAGA,CAAA,KAAM;IAC/B,IAAI,CAACxC,EAAE,EAAE;MACR;IACD,CAAC,CAAC;IACF1B,2DAAQ,CAAC;MAAEmE,IAAI,EAAE,wBAAwB,GAAGzC;IAAG,CAAC,CAAC,CAAC0C,IAAI,CACrDb,kBACD,CAAC;EACF,CAAC;EAED,MAAMc,gBAAgB,GAAGA,CAAA,KAAM;IAC9BC,OAAO,CAACC,GAAG,CAAC,QAAQ,CAAC;IACrB,IAAI5C,GAAG,IAAID,EAAE,EAAE;MACd1B,2DAAQ,CAAC;QAAEmE,IAAI,EAAE,wBAAwB,GAAGzC,EAAE;QAAE8C,MAAM,EAAE;MAAM,CAAC,CAAC,CAC9DJ,IAAI,CAACb,kBAAkB,CAAC,CACxBkB,KAAK,CAAEC,KAAK,IACZJ,OAAO,CAACI,KAAK,CAAC,8BAA8B,EAAEA,KAAK,CACpD,CAAC;IACH;EACD,CAAC;EAED9D,6DAAS,CAAC,MAAM;IACfsD,iBAAiB,CAAC,CAAC;EACpB,CAAC,EAAE,CAACxC,EAAE,CAAC,CAAC,CAAC,CAAC;;EAEV,MAAMiD,OAAO,GAAIC,KAAK,IAAK;IAC1B,IACCA,KAAK,KAAK,KAAK,IACfA,KAAK,KAAK,IAAI,IACbC,KAAK,CAACC,OAAO,CAACF,KAAK,CAAC,IAAIA,KAAK,CAACxB,MAAM,KAAK,CAAE,IAC3C,OAAOwB,KAAK,KAAK,QAAQ,IAAI3B,MAAM,CAACC,IAAI,CAAC0B,KAAK,CAAC,CAACxB,MAAM,KAAK,CAAE,EAC7D;MACD,OAAO,IAAI;IACZ;IAEA,OAAO,KAAK;EACb,CAAC;EAED,MAAM2B,YAAY,GAAGjE,0DAAS,CAAEkE,MAAM,IAAK;IAC1C,OAAOA,MAAM,CAAC,MAAM,CAAC,CAACC,OAAO,CAAC,CAAC;EAChC,CAAC,EAAE,EAAE,CAAC;EAEN,MAAMC,UAAU,GAAIC,OAAO,IAAK;IAC/B,IAAI,CAACA,OAAO,EAAE;MACb,OAAO,KAAK;IACb;IACA;IACA,OAAOlC,MAAM,CAACmC,MAAM,CAACD,OAAO,CAAC,CAACE,IAAI,CAChCC,MAAM,IACNA,MAAM,CAACC,MAAM,KAAK,QAAQ,IAC1BD,MAAM,CAACC,MAAM,KAAK,UAAU,IAC5BD,MAAM,CAACC,MAAM,KAAK,YAAY,IAC9BD,MAAM,CAACC,MAAM,KAAK,cACpB,CAAC;EACF,CAAC;EAED,MAAMC,uBAAuB,GAAGA,CAAA,KAAM;IACrC1D,eAAe,CAAE2B,mBAAmB,IAAK;MACxC,IAAI,CAACA,mBAAmB,IAAI,CAAChB,UAAU,EAAE;QACxC,OAAOgB,mBAAmB;MAC3B;MAEA,MAAMgC,mBAAmB,GAAG;QAAE,GAAGhC;MAAoB,CAAC;MACtDR,MAAM,CAACC,IAAI,CAACuC,mBAAmB,CAAC,CAAC9B,OAAO,CAAEN,GAAG,IAAK;QACjD,MAAMiC,MAAM,GAAGG,mBAAmB,CAACpC,GAAG,CAAC;QACvC,IAAIiC,MAAM,CAACvB,YAAY,IAAIuB,MAAM,CAACtB,QAAQ,EAAE;UAC3C,MAAM0B,OAAO,GACZ,IAAIC,IAAI,CAAC,CAAC,CAACC,OAAO,CAAC,CAAC,GAAG,IAAI,GAAGN,MAAM,CAACO,OAAO;UAC7C,IAAI5B,OAAO,GAAGqB,MAAM,CAACtB,QAAQ,CAACC,OAAO,IAAI,CAAC;UAC1C,IAAI6B,SAAS,GAAG,IAAI;;UAEpB;UACA,IAAIR,MAAM,CAACS,cAAc,EAAE;YAC1B,MAAMC,sBAAsB,GAC3BV,MAAM,CAACS,cAAc,GAAG,OAAO;YAChC,MAAME,UAAU,GAAGX,MAAM,CAACtB,QAAQ,CAACkC,KAAK,GACrCC,MAAM,CAACb,MAAM,CAACtB,QAAQ,CAACkC,KAAK,CAAC,CAACE,KAAK,CAAC,aAAa,CAAC,GAClD,IAAI;YACP,MAAMF,KAAK,GAAGD,UAAU,GACrBI,UAAU,CAACJ,UAAU,CAAC,CAAC,CAAC,CAAC,GACzB,CAAC;;YAEJ;YACA,IAAIC,KAAK,GAAG,CAAC,EAAE;cACd,MAAMI,SAAS,GACb,CAAC,GAAGN,sBAAsB,GAAI,GAAG,GAAGE,KAAK;cAC3CjC,OAAO,IAAIqC,SAAS;YACrB;;YAEA;YACA,IAAIrC,OAAO,GAAG,CAAC,IAAIiC,KAAK,GAAG,CAAC,EAAE;cAC7B,MAAMK,gBAAgB,GAAG,GAAG,GAAGtC,OAAO;cACtC6B,SAAS,GACPE,sBAAsB,IACrBO,gBAAgB,GAAG,GAAG,CAAC,GACzBL,KAAK;YACP,CAAC,MAAM;cACNJ,SAAS,GAAGE,sBAAsB,GAAGN,OAAO;YAC7C;UACD;;UAEA;UACAzB,OAAO,GAAGuC,IAAI,CAACC,GAAG,CAAC,GAAG,EAAED,IAAI,CAACE,GAAG,CAAC,CAAC,EAAEzC,OAAO,CAAC,CAAC;UAC7C6B,SAAS,GACRA,SAAS,KAAK,IAAI,GAAGU,IAAI,CAACE,GAAG,CAAC,CAAC,EAAEZ,SAAS,CAAC,GAAG,IAAI;UAEnDL,mBAAmB,CAACpC,GAAG,CAAC,GAAG;YAC1B,GAAGiC,MAAM;YACTtB,QAAQ,EAAE;cACT,GAAGsB,MAAM,CAACtB,QAAQ;cAClB0B,OAAO;cACPI,SAAS;cACT7B;YACD;UACD,CAAC;QACF;MACD,CAAC,CAAC;MACF,OAAOwB,mBAAmB;IAC3B,CAAC,CAAC;EACH,CAAC;EAED7E,6DAAS,CAAC,MAAM;IACf8B,aAAa,CAACwC,UAAU,CAACrD,YAAY,CAAC,CAAC;EACxC,CAAC,EAAE,CAACA,YAAY,CAAC,CAAC;EAElBjB,6DAAS,CAAC,MAAM;IACf,IAAI+F,SAAS,GAAG,IAAI;IACpB;IACA,IAAIlE,UAAU,EAAE;MACf;MACA4B,gBAAgB,CAAC,CAAC,CAAC,CAAC;MACpBsC,SAAS,GAAGC,WAAW,CAACvC,gBAAgB,EAAE,IAAI,CAAC;MAE/C,IAAI1B,gBAAgB,CAACkE,OAAO,KAAK,IAAI,EAAE;QACtClE,gBAAgB,CAACkE,OAAO,GAAGD,WAAW,CACrCpB,uBAAuB,EACvB,IACD,CAAC;MACF;IACD,CAAC,MAAM;MACN;MACAsB,aAAa,CAACnE,gBAAgB,CAACkE,OAAO,CAAC;MACvClE,gBAAgB,CAACkE,OAAO,GAAG,IAAI;MAC/BC,aAAa,CAACH,SAAS,CAAC;MACxBA,SAAS,GAAG,IAAI;IACjB;IAEA,OAAO,MAAM;MACZ,IAAIhE,gBAAgB,CAACkE,OAAO,KAAK,IAAI,EAAE;QACtCC,aAAa,CAACnE,gBAAgB,CAACkE,OAAO,CAAC;QACvClE,gBAAgB,CAACkE,OAAO,GAAG,IAAI;MAChC;MACA,IAAIF,SAAS,KAAK,IAAI,EAAE;QACvBG,aAAa,CAACH,SAAS,CAAC;QACxBA,SAAS,GAAG,IAAI;MACjB;IACD,CAAC;EACF,CAAC,EAAE,CAAClE,UAAU,CAAC,CAAC,CAAC,CAAC;;EAElB,MAAMsE,oBAAoB,GAAGA,CAACC,KAAK,EAAEC,QAAQ,KAAK;IACjDnF,eAAe,CAAEoF,gBAAgB,IAAK;MACrC,MAAMC,cAAc,GAAG;QAAE,GAAGD;MAAiB,CAAC;MAC9C,IAAIC,cAAc,CAACF,QAAQ,CAAC,EAAE;QAC7BE,cAAc,CAACF,QAAQ,CAAC,CAACnD,OAAO,GAAGkD,KAAK;MACzC;MACA,OAAOG,cAAc;IACtB,CAAC,CAAC;IACF;EACD,CAAC;EAED,MAAMC,uBAAuB,GAAIC,UAAU,IAAK;IAC/C,OAAOA,UAAU,CAACvD,OAAO,IAAIuD,UAAU,CAAC9B,MAAM,KAAK,QAAQ;EAC5D,CAAC;EAED,MAAM+B,wBAAwB,GAAID,UAAU,IAAK;IAChD,OACCA,UAAU,CAACE,MAAM,IACjBF,UAAU,CAAC9B,MAAM,KAAK,QAAQ,IAC9B8B,UAAU,CAAC9B,MAAM,KAAK,UAAU,IAChC8B,UAAU,CAAC9B,MAAM,KAAK,YAAY,IAClC8B,UAAU,CAAC9B,MAAM,KAAK,WAAW;EAEnC,CAAC;EAED,MAAMiC,aAAa,GAAGA,CAAA,KAAM;IAC3B,IAAI,CAACC,MAAM,CAACC,SAAS,IAAI,CAACD,MAAM,CAACC,SAAS,CAACC,QAAQ,EAAE;MACpD,oBAAOzG,sDAAA,CAACb,0DAAO,IAAE,CAAC;IACnB;IAEAmC,YAAY,CAAC,IAAI,CAAC;;IAElB;IACA,MAAMoF,eAAe,GAAG3E,MAAM,CAAC4E,OAAO,CAAChG,YAAY,CAAC,CAClDiG,MAAM,CACN,CAAC,CAACzE,GAAG,EAAEuB,KAAK,CAAC,KACZA,KAAK,CAACd,OAAO,IACbc,KAAK,CAACW,MAAM,KAAK,QAAQ,IACzBX,KAAK,CAACW,MAAM,KAAK,YAAY,IAC7BX,KAAK,CAACW,MAAM,KAAK,WACnB,CAAC,CACAwC,MAAM,CAAC,CAACC,GAAG,EAAE,CAAC3E,GAAG,EAAEuB,KAAK,CAAC,KAAK;MAC9BoD,GAAG,CAAC3E,GAAG,CAAC,GAAG,IAAI,CAAC,CAAC;MACjB,OAAO2E,GAAG;IACX,CAAC,EAAE,CAAC,CAAC,CAAC;IAEPhI,2DAAQ,CAAC;MACRmE,IAAI,EAAE,GAAGvB,YAAY,IAAIlB,EAAE,EAAE;MAC7B8C,MAAM,EAAE,MAAM;MACdyD,IAAI,EAAE;QACLC,GAAG,EAAEvG,GAAG;QACRwD,OAAO,EAAEyC;MACV;IACD,CAAC,CAAC,CACAxD,IAAI,CAAEZ,QAAQ,IAAK;MACnBc,OAAO,CAACC,GAAG,CAACf,QAAQ,CAAC;MACrB,MAAM2E,YAAY,GAAGA,CAAA,KAAM;QAC1B,MAAMC,SAAS,GAAG,CAAC,MAAM;UACxB,IACC5E,QAAQ,EAAE6E,WAAW,IACrBxD,KAAK,CAACC,OAAO,CAACtB,QAAQ,CAAC6E,WAAW,CAAC,IACnC7E,QAAQ,CAAC6E,WAAW,CAACjF,MAAM,GAAG,CAAC,EAC9B;YACD,OAAO,IAAIkF,IAAI,CAACC,UAAU,CACzBxD,YAAY,EAAEyD,QAAQ,GACnBzD,YAAY,CAACyD,QAAQ,CAACC,OAAO,CAAC,GAAG,EAAE,GAAG,CAAC,GACvC,OAAO,EACV;cAAEC,KAAK,EAAE,MAAM;cAAEC,IAAI,EAAE;YAAc,CACtC,CAAC,CAACrD,MAAM,CAAC9B,QAAQ,CAAC6E,WAAW,CAAC;UAC/B;UACA,OAAO,EAAE;QACV,CAAC,EAAE,CAAC;QAEJ,IAAI,CAACD,SAAS,EAAE;UACf,IAAI5E,QAAQ,EAAEe,GAAG,EAAEnB,MAAM,GAAG,CAAC,EAAE;YAC9B,OAAOI,QAAQ,CAACe,GAAG,CAACqE,IAAI,CAAC,GAAG,CAAC;UAC9B;UACA,OAAO9I,mDAAE,CAAC,qCAAqC,CAAC;QACjD;QAEA,MAAM+I,aAAa,GAAGrF,QAAQ,EAAEsF,kBAAkB;QAElD,OAAO/I,wDAAO,CACb;QACAD,mDAAE,CAAC,uCAAuC,CAAC,EAC3CsI,SAAS,EACTS,aACD,CAAC;MACF,CAAC;MACD7G,gBAAgB,CAACmG,YAAY,CAAC,CAAC,CAAC;MAChC3F,YAAY,CAAC,KAAK,CAAC;MACnB0B,iBAAiB,CAAC,CAAC,CAAC,CAAC;IACtB,CAAC,CAAC,CACDO,KAAK,CAAEC,KAAK,IAAK;MACjBJ,OAAO,CAACI,KAAK,CAACA,KAAK,CAAC;MACpB;MACA,MAAMqE,YAAY,GAAGrE,KAAK,EAAEuD,IAAI,EAAEe,OAAO,GACtCtE,KAAK,CAACuD,IAAI,CAACe,OAAO,CAACJ,IAAI,CAAC,IAAI,CAAC,GAC7BlE,KAAK,CAACuE,OAAO;MAChB;MACAjH,gBAAgB,CAACjC,wDAAO,CAACD,mDAAE,CAAC,WAAW,CAAC,EAAEiJ,YAAY,CAAC,CAAC;MACxDvG,YAAY,CAAC,KAAK,CAAC;MACnB0B,iBAAiB,CAAC,CAAC,CAAC,CAAC;IACtB,CAAC,CAAC;EACJ,CAAC;EAED,MAAMgF,cAAc,GAAIjC,QAAQ,IAAMkC,KAAK,IAAK;IAC/C,IAAI,CAACA,KAAK,IAAI,CAACA,KAAK,CAACzH,EAAE,IAAI,CAACuF,QAAQ,EAAE;MACrC;IACD;IAEAzE,YAAY,CAAC,IAAI,CAAC;IAElB,MAAMyF,IAAI,GAAG;MACZmB,IAAI,EAAE;QACL,4BAA4B,EAAEnC,QAAQ;QACtC,4BAA4B,EAAEvF;MAC/B;IACD,CAAC;IAED1B,2DAAQ,CAAC;MACRmE,IAAI,EAAE,gBAAgBgF,KAAK,CAACzH,EAAE,EAAE;MAChC8C,MAAM,EAAE,MAAM;MACdyD;IACD,CAAC,CAAC,CACA7D,IAAI,CAAC,MAAM;MACXpC,gBAAgB,CAAClC,mDAAE,CAAC,qCAAqC,CAAC,CAAC;MAC3D0C,YAAY,CAAC,KAAK,CAAC;MACnB0B,iBAAiB,CAAC,CAAC,CAAC,CAAC;IACtB,CAAC,CAAC,CACDO,KAAK,CAAEC,KAAK,IAAK;MACjBJ,OAAO,CAACI,KAAK,CAAC,+BAA+B,EAAEA,KAAK,CAAC;MACrD1C,gBAAgB,CACfjC,wDAAO,CACN;MACAD,mDAAE,CAAC,WAAW,CAAC,EACf4E,KAAK,CAACuE,OACP,CACD,CAAC;MACDzG,YAAY,CAAC,KAAK,CAAC;IACpB,CAAC,CAAC;EACJ,CAAC;EAED,MAAM6G,cAAc,GAAI/D,MAAM,IAAK;IAClC,IACCzD,YAAY,IACZA,YAAY,CAACyD,MAAM,CAAC;IACpB;IACE,CAACzD,YAAY,CAACyD,MAAM,CAAC,CAACiC,MAAM,IAC7B1F,YAAY,CAACyD,MAAM,CAAC,CAACC,MAAM,KAAK,aAAa,IAC7C1D,YAAY,CAACyD,MAAM,CAAC,CAACgE,UAAU,CAAC,IACjC,CAACzH,YAAY,CAACyD,MAAM,CAAC,CAACvB,YAAY,EACjC;MACD,OAAO,IAAI;IACZ;IACA,OAAO,KAAK;EACb,CAAC;;EAED;EACA,MAAMwF,gBAAgB,GAAItC,QAAQ,IAAK;IACtC,MAAMI,UAAU,GAAGxF,YAAY,GAAGoF,QAAQ,CAAC;IAC3C,IAAI,CAACI,UAAU,IAAI,CAACA,UAAU,CAAC3F,EAAE,EAAE;MAClCM,gBAAgB,CACflC,mDAAE,CAAC,mDAAmD,CACvD,CAAC;MACDwE,OAAO,CAACI,KAAK,CACZ,2CAA2C,EAC3CuC,QACD,CAAC;MACD;IACD;IACA7E,mBAAmB,CAAC6E,QAAQ,CAAC,CAAC,CAAC;IAC/BjH,2DAAQ,CAAC;MACRmE,IAAI,EAAE,gBAAgBkD,UAAU,CAAC3F,EAAE,aAAa;MAChD8C,MAAM,EAAE;IACT,CAAC,CAAC,CACAJ,IAAI,CAAC,MAAM;MACXpC,gBAAgB,CAAClC,mDAAE,CAAC,4BAA4B,CAAC,CAAC;MAClDoE,iBAAiB,CAAC,CAAC,CAAC,CAAC;IACtB,CAAC,CAAC,CACDO,KAAK,CAAEC,KAAK,IAAK;MACjBJ,OAAO,CAACI,KAAK,CAAC,qBAAqB,EAAEA,KAAK,CAAC;MAC3C1C,gBAAgB,CACf;MACAjC,wDAAO,CAACD,mDAAE,CAAC,yBAAyB,CAAC,EAAE4E,KAAK,CAACuE,OAAO,CACrD,CAAC;MACD/E,iBAAiB,CAAC,CAAC,CAAC,CAAC;IACtB,CAAC,CAAC,CACDsF,OAAO,CAAC,MAAM;MACdpH,mBAAmB,CAAC,IAAI,CAAC;IAC1B,CAAC,CAAC;EACJ,CAAC;;EAED;EACA,MAAMqH,eAAe,GAAIC,KAAK,IAAK;IAClC,IAAI,CAACA,KAAK,EAAE;MACX1H,gBAAgB,CAAClC,mDAAE,CAAC,2CAA2C,CAAC,CAAC;MACjEwE,OAAO,CAACI,KAAK,CAAC,mCAAmC,CAAC;MAClD;IACD;IACAtC,mBAAmB,CAACsH,KAAK,CAAC,CAAC,CAAC;IAC5B1J,2DAAQ,CAAC;MACRmE,IAAI,EAAE,GAAGvB,YAAY,IAAI8G,KAAK,EAAE;MAChClF,MAAM,EAAE;IACT,CAAC,CAAC,CACAJ,IAAI,CAAEZ,QAAQ,IAAK;MACnBxB,gBAAgB,CAAClC,mDAAE,CAAC,qCAAqC,CAAC,CAAC;MAC3DoE,iBAAiB,CAAC,CAAC,CAAC,CAAC;IACtB,CAAC,CAAC,CACDO,KAAK,CAAEC,KAAK,IAAK;MACjBJ,OAAO,CAACI,KAAK,CAAC,oBAAoB,EAAEA,KAAK,CAAC;MAC1C1C,gBAAgB,CACf;MACAjC,wDAAO,CAACD,mDAAE,CAAC,wBAAwB,CAAC,EAAE4E,KAAK,CAACuE,OAAO,CACpD,CAAC;MACD/E,iBAAiB,CAAC,CAAC,CAAC,CAAC;IACtB,CAAC,CAAC,CACDsF,OAAO,CAAC,MAAM;MACdpH,mBAAmB,CAAC,IAAI,CAAC;IAC1B,CAAC,CAAC;EACJ,CAAC;EAED,MAAMuH,iBAAiB,GAAGA,CAAChB,IAAI,EAAE1B,QAAQ,KAAK;IAC7C,MAAMI,UAAU,GAAGxF,YAAY,GAAGoF,QAAQ,CAAC;IAC3C,IAAI,CAACI,UAAU,EAAE;MAChB;IACD;IAEAnF,eAAe,CAAC;MACfyG,IAAI;MAAE;MACN1B,QAAQ;MACRyC,KAAK,EAAErC,UAAU,CAACuC,MAAM;MACxBlI,EAAE,EAAE2F,UAAU,CAAC3F,EAAE;MACjBmI,IAAI,EAAExC,UAAU,CAACwC;IAClB,CAAC,CAAC;IACFvH,gBAAgB,CAAC,IAAI,CAAC;EACvB,CAAC;EAED,MAAMwH,aAAa,GAAGA,CAAA,KAAM;IAC3BxH,gBAAgB,CAAC,KAAK,CAAC;IACvB,IAAIL,YAAY,EAAE;MACjB,IAAIA,YAAY,CAAC0G,IAAI,KAAK,MAAM,IAAI1G,YAAY,CAACP,EAAE,EAAE;QACpD6H,gBAAgB,CAACtH,YAAY,CAACgF,QAAQ,CAAC;MACxC,CAAC,MAAM,IAAIhF,YAAY,CAAC0G,IAAI,KAAK,KAAK,IAAI1G,YAAY,CAACyH,KAAK,EAAE;QAC7DD,eAAe,CAACxH,YAAY,CAACyH,KAAK,CAAC;MACpC;IACD;IACAxH,eAAe,CAAC,IAAI,CAAC;EACtB,CAAC;EAED,MAAM6H,YAAY,GAAGA,CAAA,KAAM;IAC1B7H,eAAe,CAAC,IAAI,CAAC;IACrBI,gBAAgB,CAAC,KAAK,CAAC;EACxB,CAAC;EAED,MAAM0H,iBAAiB,GAAIC,IAAI,IAAK;IACnC,IAAIA,IAAI,KAAK,IAAI,IAAIA,IAAI,KAAKC,SAAS,IAAIC,KAAK,CAACF,IAAI,CAAC,EAAE;MACvD,OAAO,OAAO;IACf;IACA,MAAMG,OAAO,GAAIC,GAAG,IAAK7D,IAAI,CAAC8D,KAAK,CAACD,GAAG,CAAC,CAACE,QAAQ,CAAC,CAAC,CAACC,QAAQ,CAAC,CAAC,EAAE,GAAG,CAAC;IAEpE,MAAMC,CAAC,GAAGjE,IAAI,CAAC8D,KAAK,CAACL,IAAI,GAAG,IAAI,CAAC;IACjC,MAAMS,CAAC,GAAGlE,IAAI,CAAC8D,KAAK,CAAEL,IAAI,GAAG,IAAI,GAAI,EAAE,CAAC;IACxC,MAAMU,CAAC,GAAGnE,IAAI,CAAC8D,KAAK,CAACL,IAAI,GAAG,EAAE,CAAC;IAE/B,MAAMW,EAAE,GAAGH,CAAC,GAAG,CAAC,GAAGL,OAAO,CAACK,CAAC,CAAC,GAAG,GAAG,GAAG,EAAE;IACxC,MAAMI,EAAE,GAAGT,OAAO,CAACM,CAAC,CAAC;IACrB,MAAMI,EAAE,GAAGV,OAAO,CAACO,CAAC,CAAC;IAErB,OAAOC,EAAE,GAAGC,EAAE,GAAG,GAAG,GAAGC,EAAE;EAC1B,CAAC;EAED,MAAMC,cAAc,GAAGA,CAAC;IAAEzF;EAAO,CAAC,KAAK;IACtC,MAAM+B,UAAU,GAAGxF,YAAY,GAAGyD,MAAM,CAAC;IAEzC,IAAI+B,UAAU,EAAEtD,YAAY,IAAI,CAACY,OAAO,CAAC0C,UAAU,EAAErD,QAAQ,CAAC,EAAE;MAC/D,MAAMC,OAAO,GAAGuC,IAAI,CAACwE,KAAK,CAAC3D,UAAU,CAACrD,QAAQ,CAACC,OAAO,CAAC;MACvD,MAAMgH,WAAW,GAAGlL,wDAAO,CAAC,MAAM,EAAEkE,OAAO,CAAC;MAC5C,MAAMiH,WAAW,GAAGA,CAAA,KAAM;QACzB,IAAI7D,UAAU,CAACuC,MAAM,EAAE;UACtBH,eAAe,CAACpC,UAAU,CAACuC,MAAM,CAAC;QACnC;MACD,CAAC;MAED,oBACCxI,uDAAA;QAAK+J,SAAS,EAAC,2BAA2B;QAAAC,QAAA,gBACzClK,sDAAA;UAAKiK,SAAS,EAAC,iBAAiB;UAAAC,QAAA,eAC/BlK,sDAAA;YACCiK,SAAS,EAAC,qBAAqB;YAC/BzC,KAAK,EAAE;cAAE2C,KAAK,EAAEJ;YAAY,CAAE;YAAAG,QAAA,eAE9BlK,sDAAA;cAAKiK,SAAS,EAAC,sBAAsB;cAAAC,QAAA,EACnCH;YAAW,CACR;UAAC,CACF;QAAC,CACF,CAAC,EACL5D,UAAU,CAACuC,MAAM,iBACjB1I,sDAAA,CAACjB,yDAAM;UACNqL,OAAO,EAAEJ,WAAY;UACrBK,OAAO,EAAC,WAAW;UACnBC,aAAa;UACbC,IAAI,EAAC,OAAO;UACZC,MAAM,EAAEvJ,gBAAgB,KAAKkF,UAAU,CAACuC,MAAO;UAAAwB,QAAA,EAE9CtL,mDAAE,CAAC,QAAQ;QAAC,CACN,CACR,eACDsB,uDAAA;UAAK+J,SAAS,EAAC,sCAAsC;UAAAC,QAAA,gBACpDlK,sDAAA;YAAAkK,QAAA,EACEtL,mDAAE,CAAC,UAAU,CAAC,GACd,GAAG,GACHkK,iBAAiB,CAAC3C,UAAU,CAACrD,QAAQ,CAAC0B,OAAO;UAAC,CAC1C,CAAC,eACPxE,sDAAA;YAAAkK,QAAA,EACEtL,mDAAE,CAAC,YAAY,CAAC,GAChB,GAAG,GACHkK,iBAAiB,CAChB3C,UAAU,CAACrD,QAAQ,CAAC8B,SACrB;UAAC,CACG,CAAC,eACP5E,sDAAA;YAAAkK,QAAA,EACEtL,mDAAE,CAAC,MAAM,CAAC,GAAG,GAAG,GAAGuH,UAAU,CAACrD,QAAQ,CAAC2H;UAAG,CACtC,CAAC;QAAA,CACH,CAAC;MAAA,CACF,CAAC;IAER;IACA;IACA,IACCtE,UAAU,EAAE9B,MAAM,KAAK,QAAQ,IAC/B,CAACZ,OAAO,CAAC0C,UAAU,EAAEuE,aAAa,CAAC,EAClC;MACD,oBACCxK,uDAAA;QAAK+J,SAAS,EAAC,wBAAwB;QAAAC,QAAA,GAErC;QACArL,wDAAO,CAACD,mDAAE,CAAC,WAAW,CAAC,EAAEuH,UAAU,CAACuE,aAAa,CAAC,EAElDvE,UAAU,CAACuC,MAAM;QAAA;QAAM;QACvB1I,sDAAA,CAACjB,yDAAM;UACNqL,OAAO,EAAEA,CAAA,KAAM3B,iBAAiB,CAAC,KAAK,EAAErE,MAAM,CAAE;UAChDiG,OAAO,EAAC,MAAM;UACdM,IAAI,EAAE/L,mDAAE,CAAC,YAAY,CAAE;UACvB0L,aAAa;UACbE,MAAM,EAAEvJ,gBAAgB,KAAKkF,UAAU,CAACuC;QAAO,CAC/C,CACD;MAAA,CACG,CAAC;IAER;IACA,OAAO,IAAI;EACZ,CAAC;EAED,MAAMkC,iBAAiB,GAAGA,CAAA,KAAM;IAC/B,IAAIjK,YAAY,EAAE;MACjB;MACA,OAAOoB,MAAM,CAACmC,MAAM,CAACvD,YAAY,CAAC,CAACwD,IAAI,CACrC0G,GAAG,IACHA,GAAG,CAACjI,OAAO,IACXiI,GAAG,CAACxG,MAAM,KAAK,QAAQ,IACvBwG,GAAG,CAACxG,MAAM,KAAK,YAAY,IAC3BwG,GAAG,CAACxG,MAAM,KAAK,WAAW,IAC1BwG,GAAG,CAACxG,MAAM,KAAK,qBACjB,CAAC;IACF;IACA,OAAO,KAAK;EACb,CAAC;EAED,MAAMyG,iBAAiB,GAAGA,CAAA,KAAM;IAC/B,IAAIF,iBAAiB,CAAC,CAAC,EAAE;MACxB,OAAOvJ,SAAS,GAAGzC,mDAAE,CAAC,UAAU,CAAC,GAAGA,mDAAE,CAAC,yBAAyB,CAAC;IAClE;IAEA,OAAOA,mDAAE,CAAC,0BAA0B,CAAC;EACtC,CAAC;EAED,MAAMmM,sBAAsB,GAC3B1J,SAAS,IAAIX,aAAa,KAAK,IAAI,IAAI,CAACkK,iBAAiB,CAAC,CAAC;EAE5D,MAAMI,oBAAoB,GAAGA,CAAA,KAAM;IAClC,IAAI,CAACjK,YAAY,EAAE;MAClB,OAAO,EAAE;IACV;IACA,IAAIA,YAAY,CAAC0G,IAAI,KAAK,MAAM,EAAE;MACjC,OAAO5I,wDAAO,CACb;MACAD,mDAAE,CACD,6GACD,CAAC,EACDmC,YAAY,CAAC4H,IACd,CAAC;IACF;IACA,IAAI5H,YAAY,CAAC0G,IAAI,KAAK,KAAK,EAAE;MAChC,OAAO5I,wDAAO,CACb;MACAD,mDAAE,CACD,4NACD,CAAC,EACDmC,YAAY,CAAC4H,IACd,CAAC;IACF;EACD,CAAC;EAED,MAAMsC,cAAc,GAAGrL,0DAAS,CAC9BkE,MAAM,IAAKA,MAAM,CAAChE,uDAAS,CAAC,CAACoL,OAAO,CAAC,QAAQ,EAAE,OAAO,EAAE1K,EAAE,CAAC,EAC5D,CAACA,EAAE,CACJ,CAAC;EAED,oBACCR,sDAAA,CAAAI,uDAAA;IAAA8J,QAAA,eACChK,uDAAA,CAACjB,4DAAS;MAACkM,KAAK,EAAEvM,mDAAE,CAAC,oBAAoB,CAAE;MAAAsL,QAAA,GACzCe,cAAc,iBACdjL,sDAAA,CAACd,2DAAQ;QAAAgL,QAAA,EACPvJ,YAAY,gBACZT,uDAAA,CAAAE,uDAAA;UAAA8J,QAAA,gBACClK,sDAAA;YACCiK,SAAS,EAAE,yBAAyBvJ,aAAa,KAAK,IAAI,GAAG,EAAE,GAAG,YAAY,EAAG;YAAAwJ,QAAA,EAEhF1D,SAAS,CAACC,QAAQ,CAAC2E,MAAM,CAACC,GAAG,CAAEC,KAAK,IAAK;cACzC,IACC/K,OAAO,CAACgL,MAAM,CAACD,KAAK,CAAC9K,EAAE,CAAC,EACrBgL,OAAO,KAAK,GAAG,EACjB;gBACD,OAAO,IAAI;cACZ;cACA,oBACCtL,uDAAA;gBAAAgK,QAAA,gBACClK,sDAAA;kBAAIiK,SAAS,EAAC,sBAAsB;kBAAAC,QAAA,EAClCoB,KAAK,CAAC3C;gBAAI,CACR,CAAC,eACL3I,sDAAA;kBAAAkK,QAAA,EACE1D,SAAS,CAACC,QAAQ,CAACgF,WAAW,CAACJ,GAAG,CACjCK,UAAU,IAAK;oBACf,MAAM3F,QAAQ,GAAG,GAAGuF,KAAK,CAAC9K,EAAE,IAAIkL,UAAU,CAAClL,EAAE,EAAE;oBAC/C,MAAM2F,UAAU,GACfxF,YAAY,CACXoF,QAAQ,CACR;oBAEF,IAAI,CAACI,UAAU,EAAE;sBAChB,OAAO,IAAI;oBACZ;oBACA,oBACCjG,uDAAA;sBAAAgK,QAAA,GAKExJ,aAAa,KACd,IAAI,gBACHV,sDAAA,CAAChB,kEAAe;wBACf2M,uBAAuB;wBACvB1B,SAAS,EAAC,kBAAkB;wBAC5B2B,KAAK,EACJzF,UAAU,CAACyF,KACX;wBACDhJ,OAAO,EAAEsD,uBAAuB,CAC/BC,UACD,CAAE;wBACF0F,QAAQ,EAAEzF,wBAAwB,CACjCD,UACD,CAAE;wBACF2F,QAAQ,EACPhG,KAAK,IAELD,oBAAoB,CACnBC,KAAK,EACLC,QACD;sBACA,CACD,CAAC,gBAEF/F,sDAAA;wBAAMiK,SAAS,EAAC,kBAAkB;wBAAAC,QAAA,EAEhC/D,UAAU,CAACyF;sBAAK,CAEZ,CACN,EACAzF,UAAU,CAAC9B,MAAM,KACjB,aAAa,iBACbrE,sDAAA;wBAAMiK,SAAS,EAAC,yBAAyB;wBAAAC,QAAA,EAEvC/D,UAAU,CAAC4F;sBAAW,CAElB,CACN,EACA5F,UAAU,CAAC9B,MAAM,KACjB,aAAa,IACb,CAAC8B,UAAU,CAACiC,UAAU,iBACrBpI,sDAAA,CAACR,+DAAW;wBACX2L,KAAK,EAAEvM,mDAAE,CACR,oBACD,CAAE;wBACFoN,QAAQ,EAAEhE,cAAc,CACvBjC,QACD,CAAE;wBACFkG,YAAY,EAAE,CACb,OAAO,CACN;wBACFC,MAAM,EAAEA,CAAC;0BACRC;wBACD,CAAC,kBACAnM,sDAAA,CAACjB,yDAAM;0BACNsL,OAAO,EAAC,WAAW;0BACnBD,OAAO,EACN+B,IACA;0BACDlC,SAAS,EAAC,yBAAyB;0BACnCM,IAAI,EAAC,OAAO;0BAAAL,QAAA,EAEXtL,mDAAE,CACF,MACD;wBAAC,CACM;sBACP,CACF,CACD,EACDuH,UAAU,CAACiC,UAAU;sBAAA;sBAAM;sBAC3BpI,sDAAA,CAACR,+DAAW;wBACX2L,KAAK,EAAEtM,wDAAO,CACb;wBACAD,mDAAE,CACD,YACD,CAAC,EACDuH,UAAU,CAACyF,KACZ,CAAE;wBACFI,QAAQ,EAAEhE,cAAc,CACvBjC,QACD,CAAE,CAAC;wBAAA;wBACHkG,YAAY,EAAE,CACb,OAAO,CACN;wBACFC,MAAM,EAAEA,CAAC;0BACRC;wBACD,CAAC,kBACAnM,sDAAA,CAACjB,yDAAM;0BACNsL,OAAO,EAAC,WAAW;0BACnBD,OAAO,EACN+B,IACA;0BACDlC,SAAS,EAAC,yBAAyB;0BACnCM,IAAI,EAAC,OAAO;0BACZY,KAAK,EAAEvM,mDAAE,CACR,cACD,CAAE;0BAAAsL,QAAA,EAEDtL,mDAAE,CACF,SACD;wBAAC,CACM;sBACP,CACF,CACD,EACAuH,UAAU,CAACiG,SAAS,IACpBjG,UAAU,CAAC3F,EAAE;sBAAA;sBAAM;sBAClBR,sDAAA,CAACjB,yDAAM;wBACNyL,MAAM,EACLvJ,gBAAgB,KAChB8E,QACA;wBACDqE,OAAO,EAAEA,CAAA,KACR3B,iBAAiB,CAChB,MAAM,EACN1C,QACD,CACA;wBACDsE,OAAO,EAAC,MAAM;wBACdM,IAAI,EAAE/L,mDAAE,CACP,oBACD,CAAE;wBACF0L,aAAa;sBAAA,CACb,CACD,EACD,CAACnE,UAAU,CAACtD,YAAY,IACxBsD,UAAU,CAAC9B,MAAM,KAChB,QAAQ,kBACTrE,sDAAA,CAAC6J,cAAc;wBACdzF,MAAM,EACL2B;sBACA,CACD,CACD,eACD/F,sDAAA,CAACX,wEAAO,IAAE,CAAC;oBAAA,GAzIV0G,QA0IE,CAAC;kBAEP,CACD;gBAAC,CACE,CAAC;cAAA,GAjKGuF,KAAK,CAAC9K,EAkKX,CAAC;YAEP,CAAC;UAAC,CACC,CAAC,eACLR,sDAAA,CAACT,8EAAa;YACb8M,MAAM,EAAElL,aAAc;YACtBmL,SAAS,EAAE1D,aAAc;YACzB2D,QAAQ,EAAE1D,YAAa;YAAAqB,QAAA,EAEtBc,oBAAoB,CAAC;UAAC,CACT,CAAC;QAAA,CACf,CAAC,gBAEHhL,sDAAA,CAAAI,uDAAA;UAAA8J,QAAA,eACClK,sDAAA,CAACb,0DAAO,IAAE;QAAC,CACV;MACF,CACQ,CACV,EACAuB,aAAa,KAAK,IAAI,IAAIC,YAAY,IAAIsK,cAAc,iBACxD/K,uDAAA,CAAChB,2DAAQ;QAAAgL,QAAA,gBACRlK,sDAAA,CAACjB,yDAAM;UACNsL,OAAO,EAAC,WAAW;UACnBD,OAAO,EAAE9D,aAAc;UACvB6E,KAAK,EAAEL,iBAAiB,CAAC,CAAE;UAC3BH,IAAI,EAAE/L,mDAAE,CAAC,QAAQ,CAAE;UACnBiN,QAAQ,EAAEd;QAAuB,CACzB,CAAC,EACT1J,SAAS,iBAAIrB,sDAAA,CAACb,0DAAO,IAAE,CAAC,EACxB0B,aAAa,iBACbb,sDAAA;UAAMiK,SAAS,EAAC,0BAA0B;UAAAC,QAAA,EACxCrJ;QAAa,CACT,CACN;MAAA,CACQ,CACV;IAAA,CACS;EAAC,CACX,CAAC;AAEL,CAAC;AAED,iEAAeR,iBAAiB,E;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC13BhC;;AAE4C;AAUb;AACuB;AACwB;AACzB;AAChB;AACsB;AACD;AAC/B;AAAA;AAE3B,MAAM8M,UAAU,GAAGA,CAAC;EACnBC,aAAa;EACb9M,UAAU;EACV+M,UAAU;EACV9M,OAAO,GAAG,CAAC;AACZ,CAAC,KAAK;EACL,MAAM;IAAEC,EAAE;IAAEC,GAAG;IAAE6M,MAAM;IAAEC;EAAU,CAAC,GAAGjN,UAAU;EACjD,MAAMkN,gBAAgB,GACrBlN,UAAU,CAACkN,gBAAgB,IAAIjN,OAAO,CAACiN,gBAAgB;EACxD,MAAMC,eAAe,GAAGhO,0DAAM,CAAC,CAAC;EAChC,MAAMiO,QAAQ,GAAGjO,0DAAM,CAAC,CAAC;EACzB,MAAMkO,YAAY,GAAGlO,0DAAM,CAAC,CAAC;EAC7B,MAAMmO,iBAAiB,GAAGnO,0DAAM,CAAC,CAAC;EAClC,MAAM,CAACoO,SAAS,EAAEC,YAAY,CAAC,GAAGnO,4DAAQ,CAAC,KAAK,CAAC;EACjD,MAAM,CAACoO,QAAQ,EAAEC,WAAW,CAAC,GAAGrO,4DAAQ,CAAC,KAAK,CAAC;EAC/C,MAAM,CAACsO,WAAW,EAAEC,cAAc,CAAC,GAAGvO,4DAAQ,CAAC,KAAK,CAAC;EACrD,MAAM,CAACwO,YAAY,EAAEC,eAAe,CAAC,GAAGzO,4DAAQ,CAAC,EAAE,CAAC;EACpD,MAAM,CAAC0O,QAAQ,EAAEC,WAAW,CAAC,GAAG3O,4DAAQ,CAAC,KAAK,CAAC;EAC/C,MAAM4O,YAAY,GAAG,sBAAsB;EAE3C,MAAMC,gCAAgC,GAAG,CAAC,OAAO,CAAC;EAElD9O,6DAAS,CAAC,MAAM;IACf,IAAI6G,MAAM,CAACkI,IAAI,IAAIlI,MAAM,CAACkI,IAAI,CAACC,OAAO,IAAIpB,MAAM,EAAE;MACjD;MACA,MAAMqB,aAAa,GAAGC,QAAQ,CAACC,aAAa,CAC3C,qEACD,CAAC;MACD,IAAIF,aAAa,EAAE;QAClB,MAAMG,MAAM,GAAGH,aAAa,CAACnO,EAAE;QAC/B,IAAIsO,MAAM,IAAIvI,MAAM,CAACkI,IAAI,CAACC,OAAO,CAACI,MAAM,CAAC,EAAE;UAC1C,MAAMC,MAAM,GAAGxI,MAAM,CAACkI,IAAI,CAACC,OAAO,CAACI,MAAM,CAAC;UAC1CC,MAAM,CAACC,SAAS,CAAC1B,MAAM,CAAC;QACzB;MACD;IACD;EACD,CAAC,EAAE,CAACA,MAAM,CAAC,CAAC;EAEZ,SAAS2B,cAAcA,CAACC,KAAK,EAAE;IAC9B9B,aAAa,CAAC;MAAEE,MAAM,EAAE4B,KAAK,CAAClI,GAAG;MAAEuG,SAAS,EAAE4B,MAAM,CAACD,KAAK,CAAC1O,EAAE;IAAE,CAAC,CAAC;EAClE;EAEA,SAAS4O,cAAcA,CAAA,EAAG;IACzBhC,aAAa,CAAC;MAAEE,MAAM,EAAEtE;IAAU,CAAC,CAAC;;IAEpC;IACA4E,iBAAiB,CAACjI,OAAO,CAAC0J,KAAK,CAAC,CAAC;EAClC;EAEA,MAAMC,cAAc,GAAG,MAAAA,CAAO7H,IAAI,GAAG,UAAU,KAAK;IACnD6G,WAAW,CAAC,IAAI,CAAC;IACjB,IAAI/N,OAAO,EAAEG,aAAa,IAAI,CAACH,OAAO,EAAEgP,kBAAkB,EAAE;MAC3D,MAAMC,cAAc,GAAG,EAAE;MACzB,KAAK,IAAIC,CAAC,GAAG,CAAC,EAAEA,CAAC,IAAIN,MAAM,CAAC3B,gBAAgB,CAAC,EAAEiC,CAAC,EAAE,EAAE;QACnD,MAAMnN,QAAQ,GAAG,MAAMoN,aAAa,CAACD,CAAC,EAAEhI,IAAI,CAAC;QAC7C,MAAMkI,KAAK,GAAG;UACblP,GAAG,EAAE6B,QAAQ,CAACsN,cAAc;UAC5BnI,IAAI,EAAE;QACP,CAAC;QACD+H,cAAc,CAACK,IAAI,CAACF,KAAK,CAAC;QAC1BvB,eAAe,CAAC,CAAC,GAAGoB,cAAc,CAAC,CAAC,CAAC,CAAC;MACvC;IACD,CAAC,MAAM;MACNM,qBAAqB,CAACrI,IAAI,CAAC;IAC5B;EACD,CAAC;EAED,MAAMqI,qBAAqB,GAAGjD,+DAAW,CAAC,MAAOpF,IAAI,IAAK;IACzD,MAAMsI,SAAS,GAAGZ,MAAM,CAAC3B,gBAAgB,CAAC;IAE1C,MAAMwC,gBAAgB,GAAG,EAAE;IAC3B,MAAMC,UAAU,GAAG,CAAC,GAAGtM,KAAK,CAACoM,SAAS,CAAC,CAAC,CAAC1E,GAAG,CAAC,CAAC6E,CAAC,EAAET,CAAC,KAAK;MACtD,IAAIU,WAAW,GACb,CAACV,CAAC,GAAG,CAAC,KAAKM,SAAS,GAAG,CAAC,CAAC,GAAIrC,QAAQ,CAAC/H,OAAO,CAACyK,QAAQ;MACxD,IAAI3I,IAAI,KAAK,QAAQ,EAAE;QACtB,MAAM4I,YAAY,GAAG/K,IAAI,CAAC8D,KAAK,CAC9B9D,IAAI,CAACgL,MAAM,CAAC,CAAC,IAAI5C,QAAQ,CAAC/H,OAAO,CAACyK,QAAQ,GAAGL,SAAS,CACvD,CAAC;QACDI,WAAW,GAAG7K,IAAI,CAACE,GAAG,CAAC2K,WAAW,GAAGE,YAAY,EAAE,CAAC,CAAC;MACtD;MACA,OAAOF,WAAW;IACnB,CAAC,CAAC;IAEF,MAAMI,kBAAkB,GAAGA,CAAA,KAAM;MAChC,IAAIZ,KAAK;MACTa,eAAe,CAAC,CAAC,CAAC;MAAA,CAChBtN,IAAI,CAAEuN,MAAM,IAAK;QACjB,IAAI;UACHd,KAAK,GAAG;YACPlP,GAAG,EAAEgQ,MAAM,CAACC,SAAS,CAAC,CAAC;YACvBjJ,IAAI,EAAE,QAAQ;YACdkJ,YAAY,EAAEF,MAAM,CAAE;UACvB,CAAC;QACF,CAAC,CAAC,OAAOjN,KAAK,EAAE;UACfJ,OAAO,CAACI,KAAK,CAACA,KAAK,CAAC;UACpBkK,QAAQ,CAAC/H,OAAO,CAACiL,mBAAmB,CACnC,YAAY,EACZL,kBACD,CAAC;UACDjC,WAAW,CAAC,KAAK,CAAC;UAClB;QACD;QACA0B,gBAAgB,CAACH,IAAI,CAACF,KAAK,CAAC;QAC5BvB,eAAe,CAAC,CAAC,GAAG4B,gBAAgB,CAAC,CAAC;QACtC,IAAIA,gBAAgB,CAAC9N,MAAM,KAAK6N,SAAS,EAAE;UAC1CrC,QAAQ,CAAC/H,OAAO,CAACiL,mBAAmB,CACnC,YAAY,EACZL,kBACD,CAAC;UACDjC,WAAW,CAAC,KAAK,CAAC;QACnB,CAAC,MAAM;UACNZ,QAAQ,CAAC/H,OAAO,CAACsI,WAAW,GAC3BgC,UAAU,CAACD,gBAAgB,CAAC9N,MAAM,CAAC;QACrC;MACD,CAAC,CAAC,CACDqB,KAAK,CAAEC,KAAK,IAAK;QACjBJ,OAAO,CAACI,KAAK,CAAC,0BAA0B,EAAEA,KAAK,CAAC;MACjD,CAAC,CAAC;IACJ,CAAC;IAEDkK,QAAQ,CAAC/H,OAAO,CAACkL,gBAAgB,CAAC,YAAY,EAAEN,kBAAkB,CAAC;IACnE7C,QAAQ,CAAC/H,OAAO,CAACsI,WAAW,GAAGgC,UAAU,CAAC,CAAC,CAAC;EAC7C,CAAC,CAAC;;EAEF;EACA,MAAMa,cAAc,GAAGA,CAAA,KAAM;IAC5B,IAAIpD,QAAQ,CAAC/H,OAAO,EAAEoL,MAAM,EAAE;MAC7BrD,QAAQ,CAAC/H,OAAO,CAACqL,IAAI,CAAC,CAAC;MACvBlD,YAAY,CAAC,IAAI,CAAC;IACnB,CAAC,MAAM;MACNJ,QAAQ,CAAC/H,OAAO,EAAEsL,KAAK,CAAC,CAAC;MACzBnD,YAAY,CAAC,KAAK,CAAC;IACpB;EACD,CAAC;EAED,MAAMoD,UAAU,GAAGA,CAAA,KAAM;IACxBxD,QAAQ,CAAC/H,OAAO,CAACsL,KAAK,CAAC,CAAC;IACxBnD,YAAY,CAAC,KAAK,CAAC;EACpB,CAAC;EAED,MAAMqD,SAAS,GAAGA,CAAA,KAAM;IACvBzD,QAAQ,CAAC/H,OAAO,CAACqL,IAAI,CAAC,CAAC;IACvBlD,YAAY,CAAC,IAAI,CAAC;EACnB,CAAC;;EAED;EACA,MAAMsD,kBAAkB,GAAI1N,KAAK,IAAK;IACrCgK,QAAQ,CAAC/H,OAAO,CAACsI,WAAW,GAAGvK,KAAK;IACpCwK,cAAc,CAACxK,KAAK,CAAC;EACtB,CAAC;EAEDhE,6DAAS,CAAC,MAAM;IACf,MAAM2R,gBAAgB,GAAGA,CAAA,KAAM;MAC9BnD,cAAc,CAACR,QAAQ,CAAC/H,OAAO,CAACsI,WAAW,CAAC,CAAC,CAAC;IAC/C,CAAC;IAEDP,QAAQ,CAAC/H,OAAO,EAAEkL,gBAAgB,CAAC,YAAY,EAAEQ,gBAAgB,CAAC;IAClE,OAAO,MAAM;MACZ3D,QAAQ,CAAC/H,OAAO,EAAEiL,mBAAmB,CACpC,YAAY,EACZS,gBACD,CAAC;IACF,CAAC;EACF,CAAC,EAAE,EAAE,CAAC;EAEN,MAAMb,eAAe,GAAG,MAAAA,CAAA,KAAY;IACnC,MAAMC,MAAM,GAAG7B,QAAQ,CAAC0C,aAAa,CAAC,QAAQ,CAAC;IAC/Cb,MAAM,CAACtG,KAAK,GAAGuD,QAAQ,CAAC/H,OAAO,CAAC4L,UAAU;IAC1Cd,MAAM,CAACe,MAAM,GAAG9D,QAAQ,CAAC/H,OAAO,CAAC8L,WAAW;IAC5C,MAAMC,GAAG,GAAGjB,MAAM,CAACkB,UAAU,CAAC,IAAI,CAAC;IACnCD,GAAG,CAACE,SAAS,CAAClE,QAAQ,CAAC/H,OAAO,EAAE,CAAC,EAAE,CAAC,EAAE8K,MAAM,CAACtG,KAAK,EAAEsG,MAAM,CAACe,MAAM,CAAC;IAElE,IAAIjR,OAAO,EAAEsR,sBAAsB,EAAE7K,GAAG,EAAE;MACzC,IAAI;QACH,MAAM8K,eAAe,GAAGC,qBAAqB,CAACtB,MAAM,CAAC;QACrD,OAAOqB,eAAe;MACvB,CAAC,CAAC,OAAOtO,KAAK,EAAE;QACfJ,OAAO,CAACI,KAAK,CAAC,0BAA0B,EAAEA,KAAK,CAAC;MACjD;IACD,CAAC,MAAM;MACN,OAAOiN,MAAM;IACd;EACD,CAAC;EAED,MAAMuB,mBAAmB,GAAGA,CAAClM,KAAK,EAAE6J,KAAK,EAAEsC,KAAK,KAAK;IACpDnM,KAAK,CAACoM,aAAa,CAACC,SAAS,CAACC,GAAG,CAAC,QAAQ,CAAC;IAC3C9D,WAAW,CAAC,IAAI,CAAC;IACjB,IAAIqB,KAAK,CAAClI,IAAI,KAAK,QAAQ,EAAE;MAC5B4K,cAAc,CAAC1C,KAAK,CAAClP,GAAG,CAAC,CAAC,CAAC;IAC5B,CAAC,MAAM;MACN6R,iBAAiB,CAAC3C,KAAK,CAACgB,YAAY,EAAEsB,KAAK,CAAC,CAAC,CAAC;IAC/C;EACD,CAAC;EAED,MAAMM,uBAAuB,GAAG,MAAAA,CAAA,KAAY;IAC3CjE,WAAW,CAAC,IAAI,CAAC,CAAC,CAAC;IACnB,MAAMkE,cAAc,GAAGrE,YAAY,CAAC,CAAC,CAAC,EAAE1G,IAAI,CAAC,CAAC;;IAE9C,IAAI+K,cAAc,KAAK,QAAQ,EAAE;MAChC;MACA,KAAK,MAAM,CAACP,KAAK,EAAEtC,KAAK,CAAC,IAAIxB,YAAY,CAACxH,OAAO,CAAC,CAAC,EAAE;QACpD,IAAI;UACH,MAAM8L,aAAa,GAAGzF,2DAAW,CAACvM,GAAG,CAAC;UACtC,MAAMiS,aAAa,GAClBD,aAAa,CAACE,SAAS,CACtB,CAAC,EACDF,aAAa,CAACG,WAAW,CAAC,GAAG,CAC9B,CAAC,IAAIH,aAAa;UAEnB,MAAMI,IAAI,GAAG,MAAM,IAAIC,OAAO,CAAEC,OAAO,IACtCpD,KAAK,CAACgB,YAAY,CAACqC,MAAM,CAAEC,IAAI,IAAK;YACnCF,OAAO,CACN,IAAIG,IAAI,CACP,CAACD,IAAI,CAAC,EACN,GAAGP,aAAa,GAAGS,cAAc,EAAE,EACnC;cACC1L,IAAI,EAAE;YACP,CACD,CACD,CAAC;UACF,CAAC,EAAE,WAAW,CACf,CAAC;UAED,MAAMqF,mEAAW,CAAC;YACjB;YACAsG,SAAS,EAAE,CAACP,IAAI,CAAC;YACjB5G,YAAY,EAAE,CAAC,WAAW,CAAC;YAC3Bd,KAAK,EAAE,GAAGuH,aAAa,IAAI9T,mDAAE,CAAC,WAAW,CAAC,IAAIqT,KAAK,GAAG,CAAC;UACxD,CAAC,CAAC;QACH,CAAC,CAAC,OAAOzO,KAAK,EAAE;UACfJ,OAAO,CAACI,KAAK,CACZ,oCAAoCyO,KAAK,GAAG,CAAC,GAAG,EAChDzO,KACD,CAAC;UACD;QACD;MACD;MACA4K,eAAe,CAAC,EAAE,CAAC,CAAC,CAAC;IACtB,CAAC,MAAM,IAAIoE,cAAc,KAAK,QAAQ,EAAE;MACvC;MACA,MAAMa,SAAS,GAAGlF,YAAY,CAAC9C,GAAG,CAAEsE,KAAK,IAAKA,KAAK,CAAClP,GAAG,CAAC;MACxD,IAAI;QACH,MAAM3B,2DAAQ,CAAC;UACdmE,IAAI,EAAE,GAAGsL,YAAY,WAAW;UAChCjL,MAAM,EAAE,MAAM;UACdyD,IAAI,EAAE;YACLuM,aAAa,EAAE9S,EAAE;YACjB+S,UAAU,EAAEF;UACb;QACD,CAAC,CAAC;QACFjF,eAAe,CAAC,EAAE,CAAC,CAAC,CAAC;MACtB,CAAC,CAAC,OAAO5K,KAAK,EAAE;QACfJ,OAAO,CAACI,KAAK,CAAC,qCAAqC,EAAEA,KAAK,CAAC;MAC5D;IACD;IACA8K,WAAW,CAAC,KAAK,CAAC,CAAC,CAAC;EACrB,CAAC;EAED,SAASyD,qBAAqBA,CAACtB,MAAM,EAAE;IACtC,OAAO,IAAIqC,OAAO,CAAC,OAAOC,OAAO,EAAES,MAAM,KAAK;MAC7C,IAAI;QACH,IAAI,CAACjT,OAAO,EAAEsR,sBAAsB,EAAE7K,GAAG,EAAE;UAC1CwM,MAAM,CAAC,IAAIC,KAAK,CAAC,4BAA4B,CAAC,CAAC;QAChD;QACA,MAAM/B,GAAG,GAAGjB,MAAM,CAACkB,UAAU,CAAC,IAAI,CAAC;QACnC,MAAM+B,cAAc,GAAG,IAAIC,KAAK,CAAC,CAAC;QAClC,MAAM;UAAE3M,GAAG;UAAE4M,KAAK;UAAEC,KAAK;UAAEC,CAAC;UAAEC,MAAM;UAAEC;QAAE,CAAC,GACxCzT,OAAO,CAACsR,sBAAsB;QAE/B6B,cAAc,CAACO,WAAW,GAAG,WAAW;QACxCP,cAAc,CAACjT,GAAG,GAAGuG,GAAG;QAExB0M,cAAc,CAACQ,MAAM,GAAG,MAAM;UAC7B,MAAMC,WAAW,GAAG1D,MAAM,CAACtG,KAAK;UAChC,MAAMiK,YAAY,GAAG3D,MAAM,CAACe,MAAM;UAClC,MAAM6C,cAAc,GAAIF,WAAW,GAAGP,KAAK,GAAI,GAAG;UAClD,MAAMU,eAAe,GAAIF,YAAY,GAAGR,KAAK,GAAI,GAAG;UAEpD,MAAMW,gBAAgB,GAAIJ,WAAW,GAAGL,CAAC,GAAI,GAAG;UAChD,MAAMU,cAAc,GAAIJ,YAAY,GAAGJ,CAAC,GAAI,GAAG;UAE/C,IAAIS,IAAI,EAAEC,IAAI;UAEd,QAAQb,KAAK;YACZ,KAAK,MAAM;cACVY,IAAI,GAAGF,gBAAgB;cACvB;YACD,KAAK,QAAQ;cACZE,IAAI,GACH,CAACN,WAAW,GAAGE,cAAc,IAAI,CAAC,GAClCE,gBAAgB;cACjB;YACD,KAAK,OAAO;cACXE,IAAI,GACHN,WAAW,GAAGE,cAAc,GAAGE,gBAAgB;cAChD;YACD;cACCf,MAAM,CACL,IAAIC,KAAK,CACR7U,mDAAE,CAAC,uCAAuC,CAC3C,CACD,CAAC;cACD;UACF;UAEA,QAAQmV,MAAM;YACb,KAAK,KAAK;cACTW,IAAI,GAAGF,cAAc;cACrB;YACD,KAAK,QAAQ;cACZE,IAAI,GACH,CAACN,YAAY,GAAGE,eAAe,IAAI,CAAC,GACpCE,cAAc;cACf;YACD,KAAK,QAAQ;cACZE,IAAI,GACHN,YAAY,GAAGE,eAAe,GAAGE,cAAc;cAChD;YACD;cACChB,MAAM,CACL,IAAIC,KAAK,CACR7U,mDAAE,CAAC,qCAAqC,CACzC,CACD,CAAC;cACD;UACF;UAEA8S,GAAG,CAACE,SAAS,CACZ8B,cAAc,EACde,IAAI,EACJC,IAAI,EACJL,cAAc,EACdC,eACD,CAAC;UACDvB,OAAO,CAACtC,MAAM,CAAC;QAChB,CAAC;QAEDiD,cAAc,CAACiB,OAAO,GAAG,MAAM;UAC9BnB,MAAM,CAAC,IAAIC,KAAK,CAAC7U,mDAAE,CAAC,gCAAgC,CAAC,CAAC,CAAC;QACxD,CAAC;MACF,CAAC,CAAC,OAAO4E,KAAK,EAAE;QACfgQ,MAAM,CAAChQ,KAAK,CAAC;MACd;IACD,CAAC,CAAC;EACH;EAEA,MAAM8O,iBAAiB,GAAG,MAAAA,CAAO3B,YAAY,EAAEiE,cAAc,GAAG,IAAI,KAAK;IACxE,MAAMnC,aAAa,GAAGzF,2DAAW,CAACvM,GAAG,CAAC;IACtC,MAAMiS,aAAa,GAClBD,aAAa,CAACE,SAAS,CAAC,CAAC,EAAEF,aAAa,CAACG,WAAW,CAAC,GAAG,CAAC,CAAC,IAC1DH,aAAa;IACd,MAAMU,cAAc,GACnByB,cAAc,KAAK,IAAI,GACpB,iBAAiBA,cAAc,GAAG,CAAC,MAAM,GACzC,mBAAmB;IACvB,MAAMC,WAAW,GAChBD,cAAc,KAAK,IAAI,GACpB,IAAIhW,mDAAE,CAAC,WAAW,CAAC,IAAIgW,cAAc,GAAG,CAAC,EAAE,GAC3C,IAAIhW,mDAAE,CAAC,WAAW,CAAC,EAAE;IAEzB,IAAI;MACH,MAAMiU,IAAI,GAAG,MAAM,IAAIC,OAAO,CAAEC,OAAO,IACtCpC,YAAY,CAACqC,MAAM,CAAEC,IAAI,IAAK;QAC7BF,OAAO,CACN,IAAIG,IAAI,CAAC,CAACD,IAAI,CAAC,EAAE,GAAGP,aAAa,GAAGS,cAAc,EAAE,EAAE;UACrD1L,IAAI,EAAE;QACP,CAAC,CACF,CAAC;MACF,CAAC,EAAE,WAAW,CACf,CAAC;MAED6G,WAAW,CAAC,IAAI,CAAC;;MAEjB;MACA,MAAMrG,KAAK,GAAG,MAAM,IAAI6K,OAAO,CAAC,CAACC,OAAO,EAAES,MAAM,KAAK;QACpD1G,mEAAW,CAAC;UACXsG,SAAS,EAAE,CAACP,IAAI,CAAC;UACjB5G,YAAY,EAAE,CAAC,WAAW,CAAC;UAC3Bd,KAAK,EAAE,GAAGuH,aAAa,GAAGmC,WAAW,EAAE;UACvCC,YAAY,EAAGC,SAAS,IAAK;YAC5B,IAAIA,SAAS,CAAC,CAAC,CAAC,CAACvU,EAAE,EAAE;cACpBuS,OAAO,CAACgC,SAAS,CAAC,CAAC,CAAC,CAAC;YACtB;UACD,CAAC;UACDC,OAAO,EAAGxR,KAAK,IAAKgQ,MAAM,CAAChQ,KAAK;QACjC,CAAC,CAAC;MACH,CAAC,CAAC;MAEF,IAAIyE,KAAK,EAAE;QACV,IACCgN,EAAE,CAAChN,KAAK,IACRgN,EAAE,CAAChN,KAAK,CAACiN,aAAa,IACtBD,EAAE,CAAChN,KAAK,CAACiN,aAAa,CAACC,GAAG,EACzB;UACDF,EAAE,CAAChN,KAAK,CAACiN,aAAa,CAACC,GAAG,CAAClN,KAAK,CAACzH,EAAE,CAAC;QACrC;QACA4U,aAAa,CAACnN,KAAK,CAACjB,GAAG,EAAEiB,KAAK,CAACzH,EAAE,CAAC;MACnC,CAAC,MAAM;QACN;QACA,MAAM,IAAIiT,KAAK,CAAC7U,mDAAE,CAAC,qCAAqC,CAAC,CAAC;MAC3D;MACA0P,WAAW,CAAC,KAAK,CAAC;IACnB,CAAC,CAAC,OAAO9K,KAAK,EAAE;MACfJ,OAAO,CAACI,KAAK,CAAC5E,mDAAE,CAAC,eAAe,CAAC,EAAE4E,KAAK,CAAC;MACzC8K,WAAW,CAAC,KAAK,CAAC;MAClB;IACD;EACD,CAAC;EAED,MAAM8G,aAAa,GAAG,MAAAA,CAAOC,UAAU,EAAEC,aAAa,KAAK;IAC1D,IAAI;MACH,MAAMC,QAAQ,GAAG,CAAC,CAAC;MACnB,IAAIF,UAAU,EAAE;QACf;QACAE,QAAQ,CAAC,4BAA4B,CAAC,GAAGF,UAAU;QACnDE,QAAQ,CAAC,+BAA+B,CAAC,GACxCpG,MAAM,CAACmG,aAAa,CAAC;MACvB;MAEA,MAAMjI,UAAU,EAAEmI,IAAI,CAAC;QACtBC,cAAc,EAAEH,aAAa,GAAGnG,MAAM,CAACmG,aAAa,CAAC,GAAG,IAAI;QAC5DpN,IAAI,EAAEqN;MACP,CAAC,CAAC;MACF,MAAMlI,UAAU,EAAEqI,IAAI,CAAC,CAAC;MAExBtI,aAAa,CAAC;QAAEE,MAAM,EAAE+H,UAAU;QAAE9H,SAAS,EAAE+H;MAAc,CAAC,CAAC;MAC/DlH,eAAe,CAAC,EAAE,CAAC;IACpB,CAAC,CAAC,OAAO5K,KAAK,EAAE;MACfJ,OAAO,CAACI,KAAK,CAAC,4BAA4B,EAAEA,KAAK,CAAC;IACnD;EACD,CAAC;EAED,MAAM6O,cAAc,GAAG,MAAAA,CAAOsD,SAAS,EAAE1D,KAAK,KAAK;IAClD,IAAI;MACH,MAAM3P,QAAQ,GAAG,MAAMxD,2DAAQ,CAAC;QAC/BmE,IAAI,EAAEsL,YAAY;QAClBjL,MAAM,EAAE,KAAK;QACbyD,IAAI,EAAE;UACLuM,aAAa,EAAE9S,EAAE;UACjBoV,QAAQ,EAAED,SAAS;UACnBE,eAAe,EAAE5D;QAClB;MACD,CAAC,CAAC;MACFmD,aAAa,CAAC9S,QAAQ,CAACqT,SAAS,EAAErT,QAAQ,CAACwT,QAAQ,CAAC;IACrD,CAAC,CAAC,OAAOtS,KAAK,EAAE;MACfJ,OAAO,CAACI,KAAK,CAACA,KAAK,CAAC;IACrB;EACD,CAAC;EAED,MAAMkM,aAAa,GAAG,MAAAA,CAAOD,CAAC,EAAEhI,IAAI,KAAK;IACxC,IAAI;MACH,MAAMxE,IAAI,GAAG8J,4DAAY,CAACwB,YAAY,EAAE;QACvCvH,GAAG,EAAEvG,GAAG;QACR+M,gBAAgB;QAChBqI,eAAe,EAAEpG,CAAC;QAClB6D,aAAa,EAAE9S,EAAE;QACjBuV,eAAe,EAAEtO;MAClB,CAAC,CAAC;MAEF,MAAMnF,QAAQ,GAAG,MAAMxD,2DAAQ,CAAC;QAAEmE;MAAK,CAAC,CAAC;MAEzC,OAAOX,QAAQ;IAChB,CAAC,CAAC,OAAOkB,KAAK,EAAE;MACfJ,OAAO,CAACI,KAAK,CAACA,KAAK,CAAC;IACrB;EACD,CAAC;EAED,MAAMwS,0BAA0B,GAAIlQ,KAAK,IAAK;IAC7CA,KAAK,CAACmQ,wBAAwB,CAAC,CAAC;IAEhC,QAAQnQ,KAAK,CAACoQ,IAAI;MACjB,KAAK,OAAO;QAAE;QACbpF,cAAc,CAAC,CAAC;QAChB;MAED,KAAK,WAAW;QAAE;QACjBI,UAAU,CAAC,CAAC;QACZxD,QAAQ,CAAC/H,OAAO,CAACsI,WAAW,GAC3BP,QAAQ,CAAC/H,OAAO,CAACsI,WAAW,GAAG,KAAK;QACrC;MAED,KAAK,YAAY;QAAE;QAClBiD,UAAU,CAAC,CAAC;QACZxD,QAAQ,CAAC/H,OAAO,CAACsI,WAAW,GAC3BP,QAAQ,CAAC/H,OAAO,CAACsI,WAAW,GAAG,KAAK;QACrC;MAED,KAAK,MAAM;QAAE;QACZ,IAAIJ,SAAS,EAAE;UACdH,QAAQ,CAAC/H,OAAO,CAACwQ,YAAY,GAAG7Q,IAAI,CAACE,GAAG,CACvC,CAAC,EACDkI,QAAQ,CAAC/H,OAAO,CAACwQ,YAAY,GAAG,CACjC,CAAC;QACF;QACA;MAED,KAAK,MAAM;QAAE;QACZjF,UAAU,CAAC,CAAC;QACZ;MAED,KAAK,MAAM;QAAE;QACZ,IAAIrD,SAAS,EAAE;UACdH,QAAQ,CAAC/H,OAAO,CAACwQ,YAAY,GAC5BzI,QAAQ,CAAC/H,OAAO,CAACwQ,YAAY,GAAG,CAAC;QACnC;QACAhF,SAAS,CAAC,CAAC;QACX;MAED;QACC;MAAQ;IACV;IACArL,KAAK,CAACsQ,cAAc,CAAC,CAAC,CAAC,CAAC;EACzB,CAAC;EAED,MAAMC,kBAAkB,GAAG,MAAAA,CAAA,KAAY;IACtC/H,WAAW,CAAC,IAAI,CAAC;IACjB,MAAMmC,MAAM,GAAG,MAAMD,eAAe,CAAC,CAAC,CAAC,CAAC;IACxC8B,iBAAiB,CAAC7B,MAAM,CAAC,CAAC,CAAC;EAC5B,CAAC;EAED,MAAM6F,uBAAuB,GAAIxQ,KAAK,IAAK;IAC1CA,KAAK,CAACsQ,cAAc,CAAC,CAAC;IACtB,MAAMG,IAAI,GAAG,CAACxI,QAAQ;IACtBC,WAAW,CAACuI,IAAI,CAAC;IACjB,IAAIA,IAAI,IAAI9I,eAAe,CAAC9H,OAAO,EAAE;MACpC8H,eAAe,CAAC9H,OAAO,CAAC0J,KAAK,CAAC,CAAC;MAC/B5B,eAAe,CAAC9H,OAAO,CAACkL,gBAAgB,CACvC,SAAS,EACTmF,0BACD,CAAC;IACF,CAAC,MAAM;MACNvI,eAAe,CAAC9H,OAAO,CAACkL,gBAAgB,CACvC,SAAS,EACTmF,0BACD,CAAC;IACF;EACD,CAAC;EAED,oBACChW,uDAAA;IAAKiK,SAAS,EAAC,+BAA+B;IAAAC,QAAA,eAC7ChK,wDAAA,CAACjB,4DAAS;MAACkM,KAAK,EAAEvM,mDAAE,CAAC,YAAY,CAAE;MAAAsL,QAAA,GACjCoD,MAAM,iBACNtN,uDAAA;QACCiK,SAAS,EAAC,6BAA6B;QACvCxJ,GAAG,EAAE6M,MAAO;QACZkJ,GAAG,EAAE5X,mDAAE,CAAC,mBAAmB;MAAE,CAC7B,CACD,eACDsB,wDAAA,CAACsM,8DAAW;QAACvC,SAAS,EAAC,6BAA6B;QAAAC,QAAA,gBACnDlK,uDAAA,CAACwM,8DAAW,CAACiK,WAAW;UAAAvM,QAAA,EACtBtL,mDAAE,CAAC,iBAAiB;QAAC,CACE,CAAC,eAC1BoB,uDAAA,CAACR,gEAAW;UACX2L,KAAK,EAAEvM,mDAAE,CAAC,wBAAwB,CAAE;UACpCoN,QAAQ,EAAEiD,cAAe;UACzBhD,YAAY,EAAEuC,gCAAiC;UAC/CtC,MAAM,EAAEA,CAAC;YAAEC;UAAK,CAAC,kBAChBnM,uDAAA,CAACjB,yDAAM;YACNsL,OAAO,EAAC,WAAW;YACnBD,OAAO,EAAE+B,IAAK;YACduK,GAAG,EAAE9I,iBAAkB;YAAA1D,QAAA,EAEtB,CAACoD,MAAM,GAAG1O,mDAAE,CAAC,QAAQ,CAAC,GAAGA,mDAAE,CAAC,SAAS;UAAC,CAChC;QACP,CACF,CAAC,EACD,CAAC,CAAC0O,MAAM,iBACRtN,uDAAA,CAACjB,yDAAM;UAACqL,OAAO,EAAEgF,cAAe;UAAC/E,OAAO,EAAC,UAAU;UAAAH,QAAA,EACjDtL,mDAAE,CAAC,QAAQ;QAAC,CACN,CACR;MAAA,CACW,CAAC,eACdoB,uDAAA,CAAC4M,8DAAW,CAAC;MAAA;QACZlJ,KAAK,EAAE8J,gBAAiB;QACxB1B,QAAQ,EAAGpI,KAAK,IAAK;UACpB,IAAI,CAACA,KAAK,EAAE;YACX0J,aAAa,CAAC;cAAEI,gBAAgB,EAAE;YAAG,CAAC,CAAC;UACxC,CAAC,MAAM;YACNJ,aAAa,CAAC;cAAEI,gBAAgB,EAAE2B,MAAM,CAACzL,KAAK;YAAE,CAAC,CAAC;UACnD;QACD,CAAE;QACFuG,SAAS,EAAC,4BAA4B;QACtC4B,QAAQ,EAAEwC;MAAS,CACnB,CAAC,eACFrO,uDAAA,CAACjB,yDAAM;QACNsL,OAAO,EAAC,WAAW;QACnBD,OAAO,EAAEA,CAAA,KAAMkF,cAAc,CAAC,UAAU,CAAE;QAC1CrF,SAAS,EAAC,oBAAoB;QAC9B4B,QAAQ,EAAEwC,QAAS;QAAAnE,QAAA,EAElBtL,mDAAE,CAAC,UAAU;MAAC,CACR,CAAC,eACToB,uDAAA,CAACjB,yDAAM;QACNsL,OAAO,EAAC,WAAW;QACnBD,OAAO,EAAEA,CAAA,KAAMkF,cAAc,CAAC,QAAQ,CAAE;QACxCrF,SAAS,EAAC,oBAAoB;QAC9B4B,QAAQ,EAAEwC,QAAS;QAAAnE,QAAA,EAElBtL,mDAAE,CAAC,QAAQ;MAAC,CACN,CAAC,EACRuP,YAAY,CAACjM,MAAM,GAAG,CAAC,iBACvBlC,uDAAA,CAACjB,yDAAM;QACNsL,OAAO,EAAC,SAAS;QACjBD,OAAO,EAAEmI,uBAAwB;QACjC1G,QAAQ,EAAEwC,QAAS;QAAAnE,QAAA,EAElBtL,mDAAE,CAAC,UAAU;MAAC,CACR,CACR,EACAuP,YAAY,CAACjM,MAAM,GAAG,CAAC,iBACvBlC,uDAAA;QACCiK,SAAS,EAAE,6BAA6BoE,QAAQ,GAAG,WAAW,GAAG,EAAE,EAAG;QAAAnE,QAAA,EAErEiE,YAAY,CAAC9C,GAAG,CAAC,CAACsE,KAAK,EAAEsC,KAAK,kBAC9B/R,wDAAA;UACCuH,IAAI,EAAC,QAAQ;UACbwC,SAAS,EAAE,uCAAwC;UAEnDG,OAAO,EAAGtE,KAAK,IAAK;YACnBkM,mBAAmB,CAAClM,KAAK,EAAE6J,KAAK,EAAEsC,KAAK,CAAC;UACzC,CAAE;UAAA/H,QAAA,gBAEFlK,uDAAA;YACCS,GAAG,EAAEkP,KAAK,CAAClP,GAAI;YACf+V,GAAG,EAAE,aAAavE,KAAK,GAAG,CAAC,EAAG;YAC9B9G,KAAK,EAAEvM,mDAAE,CAAC,wBAAwB;UAAE,CACpC,CAAC,EACDyP,QAAQ,iBAAIrO,uDAAA,CAACb,0DAAO,IAAE,CAAC;QAAA,GAVnB8S,KAWE,CACR;MAAC,CACE,CACL,eACD/R,wDAAA;QACC+J,SAAS,EAAE,gDAAgD8D,QAAQ,GAAG,WAAW,GAAG,EAAE,EAAG;QAAA7D,QAAA,gBAEzFlK,uDAAA;UAAIiK,SAAS,EAAC,8BAA8B;UAAAC,QAAA,eAC3ChK,wDAAA;YACC+J,SAAS,EAAC,iDAAiD;YAC3DxC,IAAI,EAAC,QAAQ;YACb2C,OAAO,EAAEkM,uBAAwB;YACjC,iBAAevI,QAAS;YAAA7D,QAAA,gBAExBlK,uDAAA;cAAM,eAAY,MAAM;cAAAkK,QAAA,eACvBlK,uDAAA,CAAC0M,uDAAI;gBACJzC,SAAS,EAAC,yBAAyB;gBACnC0M,IAAI,EAAE5I,QAAQ,GAAGd,wDAAS,GAAGC,wDAAWA;cAAC,CACzC;YAAC,CACG,CAAC,EACNtO,mDAAE,CAAC,mBAAmB,CAAC;UAAA,CACjB;QAAC,CACN,CAAC,eACLsB,wDAAA;UACE+J,SAAS,EAAE,gDACVoE,QAAQ,GAAG,SAAS,GAAG,EAAE,EACvB;UACHuI,QAAQ,EAAE,CAAE;UACZF,GAAG,EAAEjJ,eAAgB;UAAAvD,QAAA,gBAEtBlK,uDAAA;YACCS,GAAG,EAAEA,GAAI;YACTiW,GAAG,EAAEhJ,QAAS;YACdmJ,KAAK,EAAE,IAAK;YACZC,OAAO,EAAC,UAAU;YAClB1M,OAAO,EAAE0G;UAAe,CACxB,CAAC,eACF5Q,wDAAA;YAAK+J,SAAS,EAAC,gCAAgC;YAAAC,QAAA,gBAC9ClK,uDAAA,CAACjB,yDAAM;cACNkL,SAAS,EAAC,sBAAsB;cAChCG,OAAO,EAAE0G,cAAe;cAAA5G,QAAA,eAExBlK,uDAAA,CAACyM,2DAAQ;gBACRkK,IAAI,EACH9I,SAAS,GACN,gBAAgB,GAChB;cACH,CACD;YAAC,CACK,CAAC,EACR,CAAC5E,KAAK,CAACyE,QAAQ,CAAC/H,OAAO,EAAEyK,QAAQ,CAAC,iBAClCpQ,uDAAA,CAAC2M,+DAAY;cACZhB,uBAAuB;cACvBpG,GAAG,EAAE,CAAE;cACPC,GAAG,EAAEkI,QAAQ,CAAC/H,OAAO,CAACyK,QAAS;cAC/B2G,IAAI,EAAC,KAAK;cACVC,eAAe,EAAE,CAAE;cACnBtT,KAAK,EAAEgK,QAAQ,CAAC/H,OAAO,CAACsI,WAAY;cACpCnC,QAAQ,EAAEsF,kBAAmB;cAC7BnH,SAAS,EAAC,6BAA6B;cACvCxC,IAAI,EAAC;YAAQ,CACb,CACD;UAAA,CACG,CAAC,eACNzH,uDAAA,CAACjB,yDAAM;YACNsL,OAAO,EAAC,WAAW;YACnBD,OAAO,EAAEiM,kBAAmB;YAC5BpM,SAAS,EAAC,0BAA0B;YACpC4B,QAAQ,EAAEwC,QAAS;YAAAnE,QAAA,EAElBtL,mDAAE,CAAC,gBAAgB;UAAC,CACd,CAAC,EACRyP,QAAQ,iBAAIrO,uDAAA,CAACb,0DAAO,IAAE,CAAC;QAAA,CACpB,CAAC;MAAA,CACF,CAAC;IAAA,CACI;EAAC,CACR,CAAC;AAER,CAAC;AAED,iEAAegO,UAAU,E;;;;;;;;;;;ACztBzB;;;;;;;;;;;;ACAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACA4C;AACI;AACO;AACE;AACP;AACG;AAClB;AAAA;AAEnC,MAAM+J,iBAAiB,GAAGA,CAAC;EAAEC;AAAa,CAAC,KAAK;EAC/C,MAAM,CAAC5W,OAAO,EAAE6W,UAAU,CAAC,GAAGzX,4DAAQ,CAAC,CAAC;EACxC,MAAM,CAACW,UAAU,EAAE8M,aAAa,CAAC,GAAGzN,4DAAQ,CAAC,CAAC;EAC9C,MAAM0N,UAAU,GAAG4J,qEAAe,CACjC,UAAU,EACV,YAAY,EACZ,CAAChO,KAAK,CAACkO,YAAY,CAAC,GAAGA,YAAY,GAAG,IACvC,CAAC;EAEDzX,6DAAS,CAAC,MAAM;IACf0D,OAAO,CAACC,GAAG,CAAC,+BAA+B,CAAC;IAC5CvE,2DAAQ,CAAC;MACRmE,IAAI,EAAE,wBAAwB;MAC9BK,MAAM,EAAE;IACT,CAAC,CAAC,CAACJ,IAAI,CAAEZ,QAAQ,IAAK;MACrB8U,UAAU,CAAC9U,QAAQ,CAAC;IACrB,CAAC,CAAC;IACF,OAAO,MAAMc,OAAO,CAACC,GAAG,CAAC,sBAAsB,CAAC;EACjD,CAAC,EAAE,EAAE,CAAC;EAEN3D,6DAAS,CAAC,MAAM;IACf,IAAI2N,UAAU,CAACgK,WAAW,IAAI,CAAC/W,UAAU,EAAE;MAC1C,MAAMgX,kBAAkB,GAAG;QAC1B9W,EAAE,EAAE2W,YAAY;QAChB3J,gBAAgB,EACfH,UAAU,CAACkK,MAAM,EAAErP,IAAI,GAAG,iBAAiB,CAAC,EAAEsF,gBAAgB,IAC9DjN,OAAO,EAAEiN,gBAAgB;QAC1B/M,GAAG,EAAE4M,UAAU,CAACkK,MAAM,EAAEC,UAAU;QAClClK,MAAM,EACLD,UAAU,CAACkK,MAAM,EAAErP,IAAI,GAAG,4BAA4B,CAAC,IACvDmF,UAAU,CAACkK,MAAM,EAAEE,aAAa,EAAEC,KAAK,EAAEC,IAAI,EAAEH,UAAU,IACzDnK,UAAU,CAACkK,MAAM,EAAErI,KAAK,EAAEzO,GAAG;QAC9B8M,SAAS,EACRF,UAAU,CAACkK,MAAM,EAAErP,IAAI,GAAG,+BAA+B;MAC3D,CAAC;MACDkF,aAAa,CAACkK,kBAAkB,CAAC;IAClC;EACD,CAAC,EAAE,CAAC/W,OAAO,EAAE8M,UAAU,EAAE/M,UAAU,CAAC,CAAC;EAErC,IAAIA,UAAU,IAAI+M,UAAU,CAACgK,WAAW,IAAI9W,OAAO,EAAE;IACpD,oBACCL,uDAAA;MAAK+J,SAAS,EAAC,8BAA8B;MAAAC,QAAA,gBAC5ClK,sDAAA,CAACmN,8DAAU;QACVC,aAAa,EAAEA,aAAc;QAC7B9M,UAAU,EAAEA,UAAW;QACvB+M,UAAU,EAAEA,UAAW;QACvB9M,OAAO,EAAEA;MAAQ,CACjB,CAAC,eACFP,sDAAA,CAACK,0DAAiB;QAACC,UAAU,EAAEA,UAAW;QAACC,OAAO,EAAEA;MAAQ,CAAE,CAAC;IAAA,CAC3D,CAAC;EAER;EACA,oBAAOP,sDAAA,CAACb,0DAAO,IAAE,CAAC;AACnB,CAAC;AAED,iEAAe+X,iBAAiB,E;;;;;;;;;;;AC/DhC;;;;;;;;;;;ACAA,0C;;;;;;;;;;ACAA,6C;;;;;;;;;;ACAA,4C;;;;;;;;;;ACAA,0C;;;;;;;;;;ACAA,sC;;;;;;;;;;ACAA,yC;;;;;;;;;;ACAA,sC;;;;;;;;;;ACAA,4C;;;;;;;;;;ACAA,4C;;;;;;;;;;ACAA,qC;;;;;;;;;;ACAA,2C;;;;;;UCAA;UACA;;UAEA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;;UAEA;UACA;;UAEA;UACA;UACA;;;;;WCtBA;WACA;WACA;WACA;WACA;WACA,iCAAiC,WAAW;WAC5C;WACA,E;;;;;WCPA;WACA;WACA;WACA;WACA,yCAAyC,wCAAwC;WACjF;WACA;WACA,E;;;;;WCPA,wF;;;;;WCAA;WACA;WACA;WACA,uDAAuD,iBAAiB;WACxE;WACA,gDAAgD,aAAa;WAC7D,E;;;;;;;;;;;;;;;;ACNgD;AACI;;AAEpD;AAAA;AACA,MAAMW,kBAAkB,GAAGjJ,QAAQ,CAACkJ,cAAc,CACjD,mCACD,CAAC;AAED,IAAID,kBAAkB,EAAE;EACvB,MAAME,SAAS,GAAG,IAAIC,eAAe,CAACzR,MAAM,CAAC0R,QAAQ,CAACC,MAAM,CAAC;EAC7D,MAAMC,MAAM,GAAGJ,SAAS,CAACK,GAAG,CAAC,MAAM,CAAC;;EAEpC;EACA,MAAMC,kBAAkB,GAAGT,8DAAU,CAACC,kBAAkB,CAAC;EACzDQ,kBAAkB,CAACnM,MAAM,cAAClM,sDAAA,CAACkX,0DAAiB;IAACC,YAAY,EAAEgB;EAAO,CAAE,CAAC,CAAC;AACvE;;AAEA;AACA,IACC,OAAOlD,EAAE,KAAK,WAAW,IACzB,CAACA,EAAE,CAAChN,KAAK,IACT,CAACgN,EAAE,CAAChN,KAAK,CAACqQ,IAAI,IACd,CAACrD,EAAE,CAAChN,KAAK,CAACqQ,IAAI,CAACC,UAAU,CAACC,OAAO,EAChC;EACDpV,OAAO,CAACI,KAAK,CACZ,+DACD,CAAC;AACF,CAAC,MAAM;EACNJ,OAAO,CAACC,GAAG,CAAC,wDAAwD,CAAC;EAErE,MAAMoV,yBAAyB,GAAGxD,EAAE,CAAChN,KAAK,CAACqQ,IAAI,CAACC,UAAU,CAACC,OAAO;EAElE,MAAME,yBAAyB,GAAGD,yBAAyB,CAACE,MAAM,CAAC;IAClE;IACAN,kBAAkB,EAAE,IAAI;IAExBO,UAAUA,CAAA,EAAG;MACZ;MACAH,yBAAyB,CAACI,SAAS,CAACD,UAAU,CAACE,KAAK,CACnD,IAAI,EACJC,SACD,CAAC;MACD;MACA,IAAI,CAACC,EAAE,CAAC,OAAO,EAAE,IAAI,CAACC,wBAAwB,EAAE,IAAI,CAAC;IACtD,CAAC;IAEDA,wBAAwBA,CAAA,EAAG;MAC1B7V,OAAO,CAACC,GAAG,CACV,iEACD,CAAC;;MAED;MACA,IAAI,IAAI,CAACgV,kBAAkB,EAAE;QAC5BjV,OAAO,CAACC,GAAG,CAAC,iDAAiD,CAAC;QAC9D,IAAI,CAACgV,kBAAkB,CAACa,OAAO,CAAC,CAAC;QACjC,IAAI,CAACb,kBAAkB,GAAG,IAAI;MAC/B;;MAEA;MACA,MAAMc,OAAO,GAAG,IAAI,CAACC,KAAK,CAAC9Y,UAAU,CAACmH,IAAI,KAAK,OAAO;MACtD,MAAM4R,aAAa,GAClB,IAAI,CAACD,KAAK,CAAC9Y,UAAU,CAACgZ,OAAO,KAAK,KAAK,IACvC,IAAI,CAACF,KAAK,CAAC9Y,UAAU,CAAC4H,IAAI,GAAG,aAAa,CAAC,EAAEqR,QAAQ;MAEtD,IAAIJ,OAAO,IAAIE,aAAa,EAAE;QAC7BjW,OAAO,CAACC,GAAG,CACV,sEACD,CAAC;;QAED;QACA;QACA,MAAMmW,eAAe,GAAG,IAAI,CAACC,GAAG,CAACC,IAAI,CAAC,WAAW,CAAC;QAClD,IAAIF,eAAe,CAACtX,MAAM,KAAK,CAAC,EAAE;UACjCkB,OAAO,CAACI,KAAK,CACZ,oFACD,CAAC;UACD;QACD;;QAEA;QACA,MAAMmW,YAAY,GAAG/K,QAAQ,CAAC0C,aAAa,CAAC,KAAK,CAAC;QAClDqI,YAAY,CAACnZ,EAAE,GAAG,mCAAmC;QACrDgZ,eAAe,CAACI,MAAM,CAACD,YAAY,CAAC;;QAEpC;QACA,IAAI,CAACtB,kBAAkB,GAAGT,8DAAU,CAAC+B,YAAY,CAAC;QAClD,IAAI,CAACtB,kBAAkB,CAACnM,MAAM,cAC7BlM,sDAAA,CAACkX,0DAAiB;UAACC,YAAY,EAAE,IAAI,CAACiC,KAAK,CAAC9Y,UAAU,CAACE;QAAG,CAAE,CAC7D,CAAC;QACD4C,OAAO,CAACC,GAAG,CAAC,kDAAkD,CAAC;MAChE,CAAC,MAAM;QACND,OAAO,CAACC,GAAG,CACV,iEACD,CAAC;MACF;IACD,CAAC;IAED;IACAwW,MAAMA,CAAA,EAAG;MACR;MACA,IAAI,IAAI,CAACxB,kBAAkB,EAAE;QAC5BjV,OAAO,CAACC,GAAG,CACV,wDACD,CAAC;QACD,IAAI,CAACgV,kBAAkB,CAACa,OAAO,CAAC,CAAC;QACjC,IAAI,CAACb,kBAAkB,GAAG,IAAI;MAC/B;;MAEA;MACA,OAAOI,yBAAyB,CAACI,SAAS,CAACgB,MAAM,CAACf,KAAK,CACtD,IAAI,EACJC,SACD,CAAC;IACF;EACD,CAAC,CAAC;;EAEF;EACA9D,EAAE,CAAChN,KAAK,CAACqQ,IAAI,CAACC,UAAU,CAACC,OAAO,GAAGE,yBAAyB;AAC7D,C","sources":["webpack://videopack-block/./node_modules/@wordpress/icons/build-module/library/chevron-down.js","webpack://videopack-block/./node_modules/@wordpress/icons/build-module/library/chevron-up.js","webpack://videopack-block/./src/AdditionalFormats.js","webpack://videopack-block/./src/Thumbnails/Thumbnails.js","webpack://videopack-block/./src/Thumbnails/Thumbnails.scss?500e","webpack://videopack-block/./src/additional-formats.scss?9be8","webpack://videopack-block/./src/attachment-details/AttachmentDetails.js","webpack://videopack-block/./src/attachment-details/attachment-details.scss","webpack://videopack-block/external window [\"wp\",\"apiFetch\"]","webpack://videopack-block/external window [\"wp\",\"blockEditor\"]","webpack://videopack-block/external window [\"wp\",\"components\"]","webpack://videopack-block/external window [\"wp\",\"coreData\"]","webpack://videopack-block/external window [\"wp\",\"data\"]","webpack://videopack-block/external window [\"wp\",\"element\"]","webpack://videopack-block/external window [\"wp\",\"i18n\"]","webpack://videopack-block/external window [\"wp\",\"mediaUtils\"]","webpack://videopack-block/external window [\"wp\",\"primitives\"]","webpack://videopack-block/external window [\"wp\",\"url\"]","webpack://videopack-block/external window \"ReactJSXRuntime\"","webpack://videopack-block/webpack/bootstrap","webpack://videopack-block/webpack/runtime/compat get default export","webpack://videopack-block/webpack/runtime/define property getters","webpack://videopack-block/webpack/runtime/hasOwnProperty shorthand","webpack://videopack-block/webpack/runtime/make namespace object","webpack://videopack-block/./src/attachment-details/attachment-details.js"],"sourcesContent":["/**\n * WordPress dependencies\n */\nimport { SVG, Path } from '@wordpress/primitives';\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nconst chevronDown = /*#__PURE__*/_jsx(SVG, {\n  viewBox: \"0 0 24 24\",\n  xmlns: \"http://www.w3.org/2000/svg\",\n  children: /*#__PURE__*/_jsx(Path, {\n    d: \"M17.5 11.6L12 16l-5.5-4.4.9-1.2L12 14l4.5-3.6 1 1.2z\"\n  })\n});\nexport default chevronDown;\n//# sourceMappingURL=chevron-down.js.map","/**\n * WordPress dependencies\n */\nimport { SVG, Path } from '@wordpress/primitives';\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nconst chevronUp = /*#__PURE__*/_jsx(SVG, {\n  viewBox: \"0 0 24 24\",\n  xmlns: \"http://www.w3.org/2000/svg\",\n  children: /*#__PURE__*/_jsx(Path, {\n    d: \"M6.5 12.4L12 8l5.5 4.4-.9 1.2L12 10l-4.5 3.6-1-1.2z\"\n  })\n});\nexport default chevronUp;\n//# sourceMappingURL=chevron-up.js.map","/* global videopack */\n\nimport { __, sprintf } from '@wordpress/i18n';\nimport apiFetch from '@wordpress/api-fetch';\nimport {\n\tButton,\n\tCheckboxControl,\n\tPanelBody,\n\tPanelRow,\n\tSpinner,\n\t__experimentalDivider as Divider,\n\t__experimentalConfirmDialog as ConfirmDialog,\n} from '@wordpress/components';\nimport { MediaUpload } from '@wordpress/media-utils';\nimport { useRef, useEffect, useState } from '@wordpress/element';\nimport { useSelect } from '@wordpress/data';\nimport { store as coreStore } from '@wordpress/core-data';\nimport './additional-formats.scss';\n\nconst AdditionalFormats = ({ attributes, options = {} }) => {\n\tconst { id, src } = attributes;\n\tconst { ffmpeg_exists } = options;\n\tconst [videoFormats, setVideoFormats] = useState({});\n\tconst [encodeMessage, setEncodeMessage] = useState();\n\tconst [itemToDelete, setItemToDelete] = useState(null); // { type: 'file'/'job', formatId: string, jobId?: int, id?: int, name?: string }\n\tconst [deleteInProgress, setDeleteInProgress] = useState(null); // Stores formatId or jobId being deleted\n\tconst [isConfirmOpen, setIsConfirmOpen] = useState(false);\n\tconst [isLoading, setIsLoading] = useState(false);\n\tconst [isEncoding, setIsEncoding] = useState(false);\n\tconst progressTimerRef = useRef(null);\n\tconst queueApiPath = '/videopack/v1/queue';\n\n\tconst deepEqual = (obj1, obj2) => {\n\t\tif (obj1 === obj2) {\n\t\t\treturn true;\n\t\t}\n\n\t\tif (\n\t\t\ttypeof obj1 !== 'object' ||\n\t\t\ttypeof obj2 !== 'object' ||\n\t\t\tobj1 === null ||\n\t\t\tobj2 === null\n\t\t) {\n\t\t\treturn false;\n\t\t}\n\n\t\tconst keys1 = Object.keys(obj1);\n\t\tconst keys2 = Object.keys(obj2);\n\n\t\tif (keys1.length !== keys2.length) {\n\t\t\treturn false;\n\t\t}\n\n\t\tfor (const key of keys1) {\n\t\t\tif (!keys2.includes(key) || !deepEqual(obj1[key], obj2[key])) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\n\t\treturn true;\n\t};\n\n\tconst updateVideoFormats = (response) => {\n\t\tsetVideoFormats((currentVideoFormats) => {\n\t\t\tif (response && typeof response === 'object') {\n\t\t\t\tconst newFormats = { ...response };\n\t\t\t\tObject.keys(newFormats).forEach((key) => {\n\t\t\t\t\tconst newFormat = newFormats[key];\n\t\t\t\t\tconst oldFormat = currentVideoFormats?.[key];\n\n\t\t\t\t\t// Preserve the existing 'checked' state to prevent UI flicker on poll refresh.\n\t\t\t\t\tnewFormat.checked = oldFormat?.checked || false;\n\n\t\t\t\t\t// If the format is encoding, merge progress data carefully.\n\t\t\t\t\tif (newFormat.encoding_now && newFormat.progress) {\n\t\t\t\t\t\t// If there's old progress data, merge it to prevent flashes of 0%.\n\t\t\t\t\t\tif (oldFormat?.progress) {\n\t\t\t\t\t\t\tnewFormat.progress = {\n\t\t\t\t\t\t\t\t...oldFormat.progress,\n\t\t\t\t\t\t\t\t...newFormat.progress,\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t// If no old progress, ensure we don't start with a negative percent.\n\t\t\t\t\t\t\tnewFormat.progress.percent =\n\t\t\t\t\t\t\t\tnewFormat.progress.percent > 0\n\t\t\t\t\t\t\t\t\t? newFormat.progress.percent\n\t\t\t\t\t\t\t\t\t: 0;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\t// Only update state if the formats have actually changed.\n\t\t\t\tif (!deepEqual(currentVideoFormats, newFormats)) {\n\t\t\t\t\treturn newFormats;\n\t\t\t\t}\n\t\t\t} else if (!deepEqual(currentVideoFormats, response)) {\n\t\t\t\t// Fallback for non-object responses\n\t\t\t\treturn response;\n\t\t\t}\n\t\t\treturn currentVideoFormats;\n\t\t});\n\t};\n\n\tconst fetchVideoFormats = () => {\n\t\tif (!id) {\n\t\t\treturn;\n\t\t} // Don't fetch if there's no ID.\n\t\tapiFetch({ path: '/videopack/v1/formats/' + id }).then(\n\t\t\tupdateVideoFormats\n\t\t);\n\t};\n\n\tconst pollVideoFormats = () => {\n\t\tconsole.log('update');\n\t\tif (src && id) {\n\t\t\tapiFetch({ path: '/videopack/v1/formats/' + id, method: 'GET' })\n\t\t\t\t.then(updateVideoFormats)\n\t\t\t\t.catch((error) =>\n\t\t\t\t\tconsole.error('Error polling video formats:', error)\n\t\t\t\t);\n\t\t}\n\t};\n\n\tuseEffect(() => {\n\t\tfetchVideoFormats();\n\t}, [id]); // Fetch formats when the attachment ID changes\n\n\tconst isEmpty = (value) => {\n\t\tif (\n\t\t\tvalue === false ||\n\t\t\tvalue === null ||\n\t\t\t(Array.isArray(value) && value.length === 0) ||\n\t\t\t(typeof value === 'object' && Object.keys(value).length === 0)\n\t\t) {\n\t\t\treturn true;\n\t\t}\n\n\t\treturn false;\n\t};\n\n\tconst siteSettings = useSelect((select) => {\n\t\treturn select('core').getSite();\n\t}, []);\n\n\tconst shouldPoll = (formats) => {\n\t\tif (!formats) {\n\t\t\treturn false;\n\t\t}\n\t\t// Poll only if at least one format is still in a state that requires updates.\n\t\treturn Object.values(formats).some(\n\t\t\t(format) =>\n\t\t\t\tformat.status === 'queued' ||\n\t\t\t\tformat.status === 'encoding' ||\n\t\t\t\tformat.status === 'processing' ||\n\t\t\t\tformat.status === 'needs_insert'\n\t\t);\n\t};\n\n\tconst incrementEncodeProgress = () => {\n\t\tsetVideoFormats((currentVideoFormats) => {\n\t\t\tif (!currentVideoFormats || !isEncoding) {\n\t\t\t\treturn currentVideoFormats;\n\t\t\t}\n\n\t\t\tconst updatedVideoFormats = { ...currentVideoFormats };\n\t\t\tObject.keys(updatedVideoFormats).forEach((key) => {\n\t\t\t\tconst format = updatedVideoFormats[key];\n\t\t\t\tif (format.encoding_now && format.progress) {\n\t\t\t\t\tconst elapsed =\n\t\t\t\t\t\tnew Date().getTime() / 1000 - format.started;\n\t\t\t\t\tlet percent = format.progress.percent || 0;\n\t\t\t\t\tlet remaining = null;\n\n\t\t\t\t\t// Only calculate remaining time if video_duration is available.\n\t\t\t\t\tif (format.video_duration) {\n\t\t\t\t\t\tconst totalDurationInSeconds =\n\t\t\t\t\t\t\tformat.video_duration / 1000000;\n\t\t\t\t\t\tconst speedMatch = format.progress.speed\n\t\t\t\t\t\t\t? String(format.progress.speed).match(/(\\d*\\.?\\d+)/)\n\t\t\t\t\t\t\t: null;\n\t\t\t\t\t\tconst speed = speedMatch\n\t\t\t\t\t\t\t? parseFloat(speedMatch[0])\n\t\t\t\t\t\t\t: 0;\n\n\t\t\t\t\t\t// Increment percent based on speed. This function runs every second.\n\t\t\t\t\t\tif (speed > 0) {\n\t\t\t\t\t\t\tconst increment =\n\t\t\t\t\t\t\t\t(1 / totalDurationInSeconds) * 100 * speed;\n\t\t\t\t\t\t\tpercent += increment;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// Calculate remaining time based on current percent and speed\n\t\t\t\t\t\tif (percent > 0 && speed > 0) {\n\t\t\t\t\t\t\tconst remainingPercent = 100 - percent;\n\t\t\t\t\t\t\tremaining =\n\t\t\t\t\t\t\t\t(totalDurationInSeconds *\n\t\t\t\t\t\t\t\t\t(remainingPercent / 100)) /\n\t\t\t\t\t\t\t\tspeed;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tremaining = totalDurationInSeconds - elapsed;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\t// Clamp values to be within expected ranges.\n\t\t\t\t\tpercent = Math.min(100, Math.max(0, percent));\n\t\t\t\t\tremaining =\n\t\t\t\t\t\tremaining !== null ? Math.max(0, remaining) : null;\n\n\t\t\t\t\tupdatedVideoFormats[key] = {\n\t\t\t\t\t\t...format,\n\t\t\t\t\t\tprogress: {\n\t\t\t\t\t\t\t...format.progress,\n\t\t\t\t\t\t\telapsed,\n\t\t\t\t\t\t\tremaining,\n\t\t\t\t\t\t\tpercent,\n\t\t\t\t\t\t},\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t});\n\t\t\treturn updatedVideoFormats;\n\t\t});\n\t};\n\n\tuseEffect(() => {\n\t\tsetIsEncoding(shouldPoll(videoFormats));\n\t}, [videoFormats]);\n\n\tuseEffect(() => {\n\t\tlet pollTimer = null;\n\t\t// Manage progress timer based on encoding state\n\t\tif (isEncoding) {\n\t\t\t// Start polling immediately and then every 5 seconds\n\t\t\tpollVideoFormats(); // Initial poll\n\t\t\tpollTimer = setInterval(pollVideoFormats, 5000);\n\n\t\t\tif (progressTimerRef.current === null) {\n\t\t\t\tprogressTimerRef.current = setInterval(\n\t\t\t\t\tincrementEncodeProgress,\n\t\t\t\t\t1000\n\t\t\t\t);\n\t\t\t}\n\t\t} else {\n\t\t\t// Clear all timers if not encoding\n\t\t\tclearInterval(progressTimerRef.current);\n\t\t\tprogressTimerRef.current = null;\n\t\t\tclearInterval(pollTimer);\n\t\t\tpollTimer = null;\n\t\t}\n\n\t\treturn () => {\n\t\t\tif (progressTimerRef.current !== null) {\n\t\t\t\tclearInterval(progressTimerRef.current);\n\t\t\t\tprogressTimerRef.current = null;\n\t\t\t}\n\t\t\tif (pollTimer !== null) {\n\t\t\t\tclearInterval(pollTimer);\n\t\t\t\tpollTimer = null;\n\t\t\t}\n\t\t};\n\t}, [isEncoding]); // Depend on isEncoding state\n\n\tconst handleFormatCheckbox = (event, formatId) => {\n\t\tsetVideoFormats((prevVideoFormats) => {\n\t\t\tconst updatedFormats = { ...prevVideoFormats };\n\t\t\tif (updatedFormats[formatId]) {\n\t\t\t\tupdatedFormats[formatId].checked = event;\n\t\t\t}\n\t\t\treturn updatedFormats;\n\t\t});\n\t\t// Note: Checkbox state is now purely UI. Saving to DB happens on \"Encode\" button click.\n\t};\n\n\tconst getCheckboxCheckedState = (formatData) => {\n\t\treturn formatData.checked || formatData.status === 'queued';\n\t};\n\n\tconst getCheckboxDisabledState = (formatData) => {\n\t\treturn (\n\t\t\tformatData.exists ||\n\t\t\tformatData.status === 'queued' ||\n\t\t\tformatData.status === 'encoding' ||\n\t\t\tformatData.status === 'processing' ||\n\t\t\tformatData.status === 'completed'\n\t\t);\n\t};\n\n\tconst handleEnqueue = () => {\n\t\tif (!window.videopack || !window.videopack.settings) {\n\t\t\treturn <Spinner />;\n\t\t}\n\n\t\tsetIsLoading(true);\n\n\t\t// Get list of format IDs that are checked and available\n\t\tconst formatsToEncode = Object.entries(videoFormats)\n\t\t\t.filter(\n\t\t\t\t([key, value]) =>\n\t\t\t\t\tvalue.checked &&\n\t\t\t\t\tvalue.status !== 'queued' &&\n\t\t\t\t\tvalue.status !== 'processing' &&\n\t\t\t\t\tvalue.status !== 'completed'\n\t\t\t)\n\t\t\t.reduce((acc, [key, value]) => {\n\t\t\t\tacc[key] = true; // Backend expects an object { format_id: true, ... }\n\t\t\t\treturn acc;\n\t\t\t}, {});\n\n\t\tapiFetch({\n\t\t\tpath: `${queueApiPath}/${id}`,\n\t\t\tmethod: 'POST',\n\t\t\tdata: {\n\t\t\t\turl: src,\n\t\t\t\tformats: formatsToEncode,\n\t\t\t},\n\t\t})\n\t\t\t.then((response) => {\n\t\t\t\tconsole.log(response);\n\t\t\t\tconst queueMessage = () => {\n\t\t\t\t\tconst queueList = (() => {\n\t\t\t\t\t\tif (\n\t\t\t\t\t\t\tresponse?.encode_list &&\n\t\t\t\t\t\t\tArray.isArray(response.encode_list) &&\n\t\t\t\t\t\t\tresponse.encode_list.length > 0\n\t\t\t\t\t\t) {\n\t\t\t\t\t\t\treturn new Intl.ListFormat(\n\t\t\t\t\t\t\t\tsiteSettings?.language\n\t\t\t\t\t\t\t\t\t? siteSettings.language.replace('_', '-')\n\t\t\t\t\t\t\t\t\t: 'en-US',\n\t\t\t\t\t\t\t\t{ style: 'long', type: 'conjunction' }\n\t\t\t\t\t\t\t).format(response.encode_list);\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn '';\n\t\t\t\t\t})();\n\n\t\t\t\t\tif (!queueList) {\n\t\t\t\t\t\tif (response?.log?.length > 0) {\n\t\t\t\t\t\t\treturn response.log.join(' ');\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn __('No formats were added to the queue.');\n\t\t\t\t\t}\n\n\t\t\t\t\tconst queuePosition = response?.new_queue_position;\n\n\t\t\t\t\treturn sprintf(\n\t\t\t\t\t\t/* translators: %1$s is a list of video formats. %2$s is a number */\n\t\t\t\t\t\t__('%1$s added to queue in position %2$s.'),\n\t\t\t\t\t\tqueueList,\n\t\t\t\t\t\tqueuePosition\n\t\t\t\t\t);\n\t\t\t\t};\n\t\t\t\tsetEncodeMessage(queueMessage());\n\t\t\t\tsetIsLoading(false);\n\t\t\t\tfetchVideoFormats(); // Re-fetch to update statuses\n\t\t\t})\n\t\t\t.catch((error) => {\n\t\t\t\tconsole.error(error);\n\t\t\t\t// Use the detailed error messages from the server if available\n\t\t\t\tconst errorMessage = error?.data?.details\n\t\t\t\t\t? error.data.details.join(', ')\n\t\t\t\t\t: error.message;\n\t\t\t\t/* translators: %s is an error message */\n\t\t\t\tsetEncodeMessage(sprintf(__('Error: %s'), errorMessage));\n\t\t\t\tsetIsLoading(false);\n\t\t\t\tfetchVideoFormats(); // Re-fetch to ensure UI is consistent\n\t\t\t});\n\t};\n\n\tconst onSelectFormat = (formatId) => (media) => {\n\t\tif (!media || !media.id || !formatId) {\n\t\t\treturn;\n\t\t}\n\n\t\tsetIsLoading(true);\n\n\t\tconst data = {\n\t\t\tmeta: {\n\t\t\t\t'_kgflashmediaplayer-format': formatId,\n\t\t\t\t'_kgflashmediaplayer-parent': id,\n\t\t\t},\n\t\t};\n\n\t\tapiFetch({\n\t\t\tpath: `/wp/v2/media/${media.id}`,\n\t\t\tmethod: 'POST',\n\t\t\tdata,\n\t\t})\n\t\t\t.then(() => {\n\t\t\t\tsetEncodeMessage(__('Video format assigned successfully.'));\n\t\t\t\tsetIsLoading(false);\n\t\t\t\tfetchVideoFormats(); // Refresh the list\n\t\t\t})\n\t\t\t.catch((error) => {\n\t\t\t\tconsole.error('Error assigning video format:', error);\n\t\t\t\tsetEncodeMessage(\n\t\t\t\t\tsprintf(\n\t\t\t\t\t\t/* translators: %s is an error message */\n\t\t\t\t\t\t__('Error: %s'),\n\t\t\t\t\t\terror.message\n\t\t\t\t\t)\n\t\t\t\t);\n\t\t\t\tsetIsLoading(false);\n\t\t\t});\n\t};\n\n\tconst formatPickable = (format) => {\n\t\tif (\n\t\t\tvideoFormats &&\n\t\t\tvideoFormats[format] &&\n\t\t\t// A format is \"pickable\" if the file doesn't exist AND it's not already queued/processing/completed\n\t\t\t((!videoFormats[format].exists &&\n\t\t\t\tvideoFormats[format].status === 'not_encoded') ||\n\t\t\t\tvideoFormats[format].was_picked) &&\n\t\t\t!videoFormats[format].encoding_now\n\t\t) {\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t};\n\n\t// Deletes the actual media file (WP Attachment)\n\tconst handleFileDelete = (formatId) => {\n\t\tconst formatData = videoFormats?.[formatId];\n\t\tif (!formatData || !formatData.id) {\n\t\t\tsetEncodeMessage(\n\t\t\t\t__('Error: Cannot delete file, missing attachment ID.')\n\t\t\t);\n\t\t\tconsole.error(\n\t\t\t\t'Cannot delete file: Missing id for format',\n\t\t\t\tformatId\n\t\t\t);\n\t\t\treturn;\n\t\t}\n\t\tsetDeleteInProgress(formatId); // Mark this formatId as being deleted\n\t\tapiFetch({\n\t\t\tpath: `/wp/v2/media/${formatData.id}?force=true`,\n\t\t\tmethod: 'DELETE',\n\t\t})\n\t\t\t.then(() => {\n\t\t\t\tsetEncodeMessage(__('File deleted successfully.'));\n\t\t\t\tfetchVideoFormats(); // Re-fetch to get the latest status from backend\n\t\t\t})\n\t\t\t.catch((error) => {\n\t\t\t\tconsole.error('File delete failed:', error);\n\t\t\t\tsetEncodeMessage(\n\t\t\t\t\t/* translators: %s is an error message */\n\t\t\t\t\tsprintf(__('Error deleting file: %s'), error.message)\n\t\t\t\t);\n\t\t\t\tfetchVideoFormats(); // Re-fetch to get the latest status\n\t\t\t})\n\t\t\t.finally(() => {\n\t\t\t\tsetDeleteInProgress(null);\n\t\t\t});\n\t};\n\n\t// Deletes/Cancels a queue job\n\tconst handleJobDelete = (jobId) => {\n\t\tif (!jobId) {\n\t\t\tsetEncodeMessage(__('Error: Cannot delete job, missing job ID.'));\n\t\t\tconsole.error('Cannot delete job: Missing job ID');\n\t\t\treturn;\n\t\t}\n\t\tsetDeleteInProgress(jobId); // Mark this jobId as being deleted\n\t\tapiFetch({\n\t\t\tpath: `${queueApiPath}/${jobId}`,\n\t\t\tmethod: 'DELETE',\n\t\t})\n\t\t\t.then((response) => {\n\t\t\t\tsetEncodeMessage(__('Job cancelled/deleted successfully.'));\n\t\t\t\tfetchVideoFormats(); // Re-fetch to get the latest status\n\t\t\t})\n\t\t\t.catch((error) => {\n\t\t\t\tconsole.error('Job delete failed:', error);\n\t\t\t\tsetEncodeMessage(\n\t\t\t\t\t/* translators: %s is an error message */\n\t\t\t\t\tsprintf(__('Error deleting job: %s'), error.message)\n\t\t\t\t);\n\t\t\t\tfetchVideoFormats(); // Re-fetch to get the latest status\n\t\t\t})\n\t\t\t.finally(() => {\n\t\t\t\tsetDeleteInProgress(null);\n\t\t\t});\n\t};\n\n\tconst openConfirmDialog = (type, formatId) => {\n\t\tconst formatData = videoFormats?.[formatId];\n\t\tif (!formatData) {\n\t\t\treturn;\n\t\t}\n\n\t\tsetItemToDelete({\n\t\t\ttype, // 'file' or 'job'\n\t\t\tformatId,\n\t\t\tjobId: formatData.job_id,\n\t\t\tid: formatData.id,\n\t\t\tname: formatData.name,\n\t\t});\n\t\tsetIsConfirmOpen(true);\n\t};\n\n\tconst handleConfirm = () => {\n\t\tsetIsConfirmOpen(false);\n\t\tif (itemToDelete) {\n\t\t\tif (itemToDelete.type === 'file' && itemToDelete.id) {\n\t\t\t\thandleFileDelete(itemToDelete.formatId);\n\t\t\t} else if (itemToDelete.type === 'job' && itemToDelete.jobId) {\n\t\t\t\thandleJobDelete(itemToDelete.jobId);\n\t\t\t}\n\t\t}\n\t\tsetItemToDelete(null);\n\t};\n\n\tconst handleCancel = () => {\n\t\tsetItemToDelete(null);\n\t\tsetIsConfirmOpen(false);\n\t};\n\n\tconst convertToTimecode = (time) => {\n\t\tif (time === null || time === undefined || isNaN(time)) {\n\t\t\treturn '--:--';\n\t\t}\n\t\tconst padZero = (num) => Math.floor(num).toString().padStart(2, '0');\n\n\t\tconst h = Math.floor(time / 3600);\n\t\tconst m = Math.floor((time % 3600) / 60);\n\t\tconst s = Math.floor(time % 60);\n\n\t\tconst hh = h > 0 ? padZero(h) + ':' : '';\n\t\tconst mm = padZero(m);\n\t\tconst ss = padZero(s);\n\n\t\treturn hh + mm + ':' + ss;\n\t};\n\n\tconst EncodeProgress = ({ format }) => {\n\t\tconst formatData = videoFormats?.[format];\n\n\t\tif (formatData?.encoding_now && !isEmpty(formatData?.progress)) {\n\t\t\tconst percent = Math.round(formatData.progress.percent);\n\t\t\tconst percentText = sprintf('%d%%', percent);\n\t\t\tconst onCancelJob = () => {\n\t\t\t\tif (formatData.job_id) {\n\t\t\t\t\thandleJobDelete(formatData.job_id);\n\t\t\t\t}\n\t\t\t};\n\n\t\t\treturn (\n\t\t\t\t<div className=\"videopack-encode-progress\">\n\t\t\t\t\t<div className=\"videopack-meter\">\n\t\t\t\t\t\t<div\n\t\t\t\t\t\t\tclassName=\"videopack-meter-bar\"\n\t\t\t\t\t\t\tstyle={{ width: percentText }}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<div className=\"videopack-meter-text\">\n\t\t\t\t\t\t\t\t{percentText}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t{formatData.job_id && (\n\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\tonClick={onCancelJob}\n\t\t\t\t\t\t\tvariant=\"secondary\"\n\t\t\t\t\t\t\tisDestructive\n\t\t\t\t\t\t\tsize=\"small\"\n\t\t\t\t\t\t\tisBusy={deleteInProgress === formatData.job_id}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{__('Cancel')}\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t)}\n\t\t\t\t\t<div className=\"videopack-encode-progress-small-text\">\n\t\t\t\t\t\t<span>\n\t\t\t\t\t\t\t{__('Elapsed:') +\n\t\t\t\t\t\t\t\t' ' +\n\t\t\t\t\t\t\t\tconvertToTimecode(formatData.progress.elapsed)}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t\t<span>\n\t\t\t\t\t\t\t{__('Remaining:') +\n\t\t\t\t\t\t\t\t' ' +\n\t\t\t\t\t\t\t\tconvertToTimecode(\n\t\t\t\t\t\t\t\t\tformatData.progress.remaining\n\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t\t<span>\n\t\t\t\t\t\t\t{__('fps:') + ' ' + formatData.progress.fps}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t);\n\t\t}\n\t\t// Display error message if status is failed\n\t\tif (\n\t\t\tformatData?.status === 'failed' &&\n\t\t\t!isEmpty(formatData?.error_message)\n\t\t) {\n\t\t\treturn (\n\t\t\t\t<div className=\"videopack-encode-error\">\n\t\t\t\t\t{\n\t\t\t\t\t\t/* translators: %s is an error message */\n\t\t\t\t\t\tsprintf(__('Error: %s'), formatData.error_message)\n\t\t\t\t\t}\n\t\t\t\t\t{formatData.job_id && ( // Allow deleting failed jobs\n\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\tonClick={() => openConfirmDialog('job', format)}\n\t\t\t\t\t\t\tvariant=\"link\"\n\t\t\t\t\t\t\ttext={__('Delete Job')}\n\t\t\t\t\t\t\tisDestructive\n\t\t\t\t\t\t\tisBusy={deleteInProgress === formatData.job_id}\n\t\t\t\t\t\t/>\n\t\t\t\t\t)}\n\t\t\t\t</div>\n\t\t\t);\n\t\t}\n\t\treturn null;\n\t};\n\n\tconst somethingToEncode = () => {\n\t\tif (videoFormats) {\n\t\t\t// Check if any format is checked AND available AND not already in a terminal/pending state\n\t\t\treturn Object.values(videoFormats).some(\n\t\t\t\t(obj) =>\n\t\t\t\t\tobj.checked &&\n\t\t\t\t\tobj.status !== 'queued' &&\n\t\t\t\t\tobj.status !== 'processing' &&\n\t\t\t\t\tobj.status !== 'completed' &&\n\t\t\t\t\tobj.status !== 'pending_replacement'\n\t\t\t);\n\t\t}\n\t\treturn false;\n\t};\n\n\tconst encodeButtonTitle = () => {\n\t\tif (somethingToEncode()) {\n\t\t\treturn isLoading ? __('Loading') : __('Encode selected formats');\n\t\t}\n\n\t\treturn __('Select formats to encode');\n\t};\n\n\tconst isEncodeButtonDisabled =\n\t\tisLoading || ffmpeg_exists !== true || !somethingToEncode();\n\n\tconst confirmDialogMessage = () => {\n\t\tif (!itemToDelete) {\n\t\t\treturn '';\n\t\t}\n\t\tif (itemToDelete.type === 'file') {\n\t\t\treturn sprintf(\n\t\t\t\t/* translators: %s is the name of a video format (eg: H264 MP4 HD (720p) ) */\n\t\t\t\t__(\n\t\t\t\t\t'You are about to permanently delete the encoded %s video file from your site. This action cannot be undone.'\n\t\t\t\t),\n\t\t\t\titemToDelete.name\n\t\t\t);\n\t\t}\n\t\tif (itemToDelete.type === 'job') {\n\t\t\treturn sprintf(\n\t\t\t\t/* translators: %s is the name of a video format (eg: H264 MP4 HD (720p) ) */\n\t\t\t\t__(\n\t\t\t\t\t'You are about to permanently delete the encoding job for the %s video. This will also delete the encoded video file if it exists (if created by this job and not yet a separate attachment). This action cannot be undone.'\n\t\t\t\t),\n\t\t\t\titemToDelete.name\n\t\t\t);\n\t\t}\n\t};\n\n\tconst canUploadFiles = useSelect(\n\t\t(select) => select(coreStore).canUser('create', 'media', id),\n\t\t[id]\n\t);\n\n\treturn (\n\t\t<>\n\t\t\t<PanelBody title={__('Additional Formats')}>\n\t\t\t\t{canUploadFiles && (\n\t\t\t\t\t<PanelRow>\n\t\t\t\t\t\t{videoFormats ? (\n\t\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t\t<ul\n\t\t\t\t\t\t\t\t\tclassName={`videopack-formats-list${ffmpeg_exists === true ? '' : ' no-ffmpeg'}`}\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t{videopack.settings.codecs.map((codec) => {\n\t\t\t\t\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t\t\t\t\toptions.encode[codec.id]\n\t\t\t\t\t\t\t\t\t\t\t\t?.enabled !== '1'\n\t\t\t\t\t\t\t\t\t\t) {\n\t\t\t\t\t\t\t\t\t\t\treturn null;\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t\t\t\t\t<li key={codec.id}>\n\t\t\t\t\t\t\t\t\t\t\t\t<h4 className=\"videopack-codec-name\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t{codec.name}\n\t\t\t\t\t\t\t\t\t\t\t\t</h4>\n\t\t\t\t\t\t\t\t\t\t\t\t<ul>\n\t\t\t\t\t\t\t\t\t\t\t\t\t{videopack.settings.resolutions.map(\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t(resolution) => {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tconst formatId = `${codec.id}_${resolution.id}`;\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tconst formatData =\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvideoFormats[\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tformatId\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t];\n\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tif (!formatData) {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\treturn null;\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<li\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tkey={\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tformatId\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{ffmpeg_exists ===\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttrue ? (\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<CheckboxControl\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t__nextHasNoMarginBottom\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"videopack-format\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tlabel={\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tformatData.label\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tchecked={getCheckboxCheckedState(\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tformatData\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tdisabled={getCheckboxDisabledState(\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tformatData\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tonChange={(\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tevent\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t) =>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\thandleFormatCheckbox(\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tevent,\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tformatId\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span className=\"videopack-format\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tformatData.label\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{formatData.status !==\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t'not_encoded' && (\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span className=\"videopack-format-status\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tformatData.status_l10n\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{formatData.status ===\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t'not_encoded' &&\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t!formatData.was_picked && (\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<MediaUpload\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttitle={__(\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t'Pick existing file'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tonSelect={onSelectFormat(\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tformatId\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tallowedTypes={[\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t'video',\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t]}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\trender={({\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\topen,\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}) => (\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvariant=\"secondary\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tonClick={\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\topen\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"videopack-format-button\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsize=\"small\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{__(\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t'Pick'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{formatData.was_picked && ( // Show \"Replace\" if it was manually picked/linked\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<MediaUpload\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttitle={sprintf(\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t/* translators: %s is the label of a video resolution (eg: 720p ) */\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t__(\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t'Replace %s'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tformatData.label\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tonSelect={onSelectFormat(\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tformatId\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)} // Implement replace logic\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tallowedTypes={[\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t'video',\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t]}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\trender={({\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\topen,\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}) => (\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvariant=\"secondary\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tonClick={\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\topen\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"videopack-format-button\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsize=\"small\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttitle={__(\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t'Replace file'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{__(\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t'Replace'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{formatData.deletable &&\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tformatData.id && ( // Delete FILE button\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tisBusy={\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tdeleteInProgress ===\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tformatId\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tonClick={() =>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\topenConfirmDialog(\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t'file',\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tformatId\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvariant=\"link\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttext={__(\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t'Delete Permanently'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tisDestructive\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{(formatData.encoding_now ||\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tformatData.status ===\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t'failed') && (\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<EncodeProgress\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tformat={\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tformatId\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Divider />\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t\t\t</ul>\n\t\t\t\t\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\t})}\n\t\t\t\t\t\t\t\t</ul>\n\t\t\t\t\t\t\t\t<ConfirmDialog\n\t\t\t\t\t\t\t\t\tisOpen={isConfirmOpen}\n\t\t\t\t\t\t\t\t\tonConfirm={handleConfirm}\n\t\t\t\t\t\t\t\t\tonCancel={handleCancel}\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t{confirmDialogMessage()}\n\t\t\t\t\t\t\t\t</ConfirmDialog>\n\t\t\t\t\t\t\t</>\n\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t\t<Spinner />\n\t\t\t\t\t\t\t</>\n\t\t\t\t\t\t)}\n\t\t\t\t\t</PanelRow>\n\t\t\t\t)}\n\t\t\t\t{ffmpeg_exists === true && videoFormats && canUploadFiles && (\n\t\t\t\t\t<PanelRow>\n\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\tvariant=\"secondary\"\n\t\t\t\t\t\t\tonClick={handleEnqueue}\n\t\t\t\t\t\t\ttitle={encodeButtonTitle()}\n\t\t\t\t\t\t\ttext={__('Encode')}\n\t\t\t\t\t\t\tdisabled={isEncodeButtonDisabled}\n\t\t\t\t\t\t></Button>\n\t\t\t\t\t\t{isLoading && <Spinner />}\n\t\t\t\t\t\t{encodeMessage && (\n\t\t\t\t\t\t\t<span className=\"videopack-encode-message\">\n\t\t\t\t\t\t\t\t{encodeMessage}\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t)}\n\t\t\t\t\t</PanelRow>\n\t\t\t\t)}\n\t\t\t</PanelBody>\n\t\t</>\n\t);\n};\n\nexport default AdditionalFormats;\n","/* global Image */\n\nimport apiFetch from '@wordpress/api-fetch';\nimport {\n\tBaseControl,\n\tButton,\n\tDashicon,\n\tIcon,\n\tPanelBody,\n\tRangeControl,\n\tSpinner,\n\tTextControl,\n} from '@wordpress/components';\nimport { MediaUpload } from '@wordpress/block-editor';\nimport { useCallback, useRef, useEffect, useState } from '@wordpress/element';\nimport { uploadMedia } from '@wordpress/media-utils';\nimport { __ } from '@wordpress/i18n';\nimport { addQueryArgs, getFilename } from '@wordpress/url';\nimport { chevronUp, chevronDown } from '@wordpress/icons';\nimport './Thumbnails.scss';\n\nconst Thumbnails = ({\n\tsetAttributes,\n\tattributes,\n\tattachment,\n\toptions = {},\n}) => {\n\tconst { id, src, poster, poster_id } = attributes;\n\tconst total_thumbnails =\n\t\tattributes.total_thumbnails || options.total_thumbnails;\n\tconst thumbVideoPanel = useRef();\n\tconst videoRef = useRef();\n\tconst currentThumb = useRef();\n\tconst posterImageButton = useRef();\n\tconst [isPlaying, setIsPlaying] = useState(false);\n\tconst [isOpened, setIsOpened] = useState(false);\n\tconst [currentTime, setCurrentTime] = useState(false);\n\tconst [thumbChoices, setThumbChoices] = useState([]);\n\tconst [isSaving, setIsSaving] = useState(false);\n\tconst thumbApiPath = '/videopack/v1/thumbs';\n\n\tconst VIDEO_POSTER_ALLOWED_MEDIA_TYPES = ['image'];\n\n\tuseEffect(() => {\n\t\tif (window.mejs && window.mejs.players && poster) {\n\t\t\t// Find the MediaElement.js player within the media modal\n\t\t\tconst mejsContainer = document.querySelector(\n\t\t\t\t'.media-modal .mejs-container, .wp_attachment_holder .mejs-container'\n\t\t\t);\n\t\t\tif (mejsContainer) {\n\t\t\t\tconst mejsId = mejsContainer.id;\n\t\t\t\tif (mejsId && window.mejs.players[mejsId]) {\n\t\t\t\t\tconst player = window.mejs.players[mejsId];\n\t\t\t\t\tplayer.setPoster(poster);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}, [poster]);\n\n\tfunction onSelectPoster(image) {\n\t\tsetAttributes({ poster: image.url, poster_id: Number(image.id) });\n\t}\n\n\tfunction onRemovePoster() {\n\t\tsetAttributes({ poster: undefined });\n\n\t\t// Move focus back to the Media Upload button.\n\t\tposterImageButton.current.focus();\n\t}\n\n\tconst handleGenerate = async (type = 'generate') => {\n\t\tsetIsSaving(true);\n\t\tif (options?.ffmpeg_exists && !options?.browser_thumbnails) {\n\t\t\tconst newThumbImages = [];\n\t\t\tfor (let i = 1; i <= Number(total_thumbnails); i++) {\n\t\t\t\tconst response = await generateThumb(i, type);\n\t\t\t\tconst thumb = {\n\t\t\t\t\tsrc: response.real_thumb_url,\n\t\t\t\t\ttype: 'ffmpeg',\n\t\t\t\t};\n\t\t\t\tnewThumbImages.push(thumb);\n\t\t\t\tsetThumbChoices([...newThumbImages]); // Update incrementally\n\t\t\t}\n\t\t} else {\n\t\t\tgenerateThumbCanvases(type);\n\t\t}\n\t};\n\n\tconst generateThumbCanvases = useCallback(async (type) => {\n\t\tconst thumbsInt = Number(total_thumbnails);\n\n\t\tconst newThumbCanvases = [];\n\t\tconst timePoints = [...Array(thumbsInt)].map((_, i) => {\n\t\t\tlet movieoffset =\n\t\t\t\t((i + 1) / (thumbsInt + 1)) * videoRef.current.duration;\n\t\t\tif (type === 'random') {\n\t\t\t\tconst randomOffset = Math.floor(\n\t\t\t\t\tMath.random() * (videoRef.current.duration / thumbsInt)\n\t\t\t\t);\n\t\t\t\tmovieoffset = Math.max(movieoffset - randomOffset, 0);\n\t\t\t}\n\t\t\treturn movieoffset;\n\t\t});\n\n\t\tconst timeupdateListener = () => {\n\t\t\tlet thumb;\n\t\t\tdrawCanvasThumb() // This now returns a Promise resolving to a canvas object\n\t\t\t\t.then((canvas) => {\n\t\t\t\t\ttry {\n\t\t\t\t\t\tthumb = {\n\t\t\t\t\t\t\tsrc: canvas.toDataURL(),\n\t\t\t\t\t\t\ttype: 'canvas',\n\t\t\t\t\t\t\tcanvasObject: canvas, // Store the canvas object for later upload\n\t\t\t\t\t\t};\n\t\t\t\t\t} catch (error) {\n\t\t\t\t\t\tconsole.error(error);\n\t\t\t\t\t\tvideoRef.current.removeEventListener(\n\t\t\t\t\t\t\t'timeupdate',\n\t\t\t\t\t\t\ttimeupdateListener\n\t\t\t\t\t\t);\n\t\t\t\t\t\tsetIsSaving(false);\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tnewThumbCanvases.push(thumb);\n\t\t\t\t\tsetThumbChoices([...newThumbCanvases]);\n\t\t\t\t\tif (newThumbCanvases.length === thumbsInt) {\n\t\t\t\t\t\tvideoRef.current.removeEventListener(\n\t\t\t\t\t\t\t'timeupdate',\n\t\t\t\t\t\t\ttimeupdateListener\n\t\t\t\t\t\t);\n\t\t\t\t\t\tsetIsSaving(false);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tvideoRef.current.currentTime =\n\t\t\t\t\t\t\ttimePoints[newThumbCanvases.length];\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\t.catch((error) => {\n\t\t\t\t\tconsole.error('Error processing canvas:', error);\n\t\t\t\t});\n\t\t};\n\n\t\tvideoRef.current.addEventListener('timeupdate', timeupdateListener);\n\t\tvideoRef.current.currentTime = timePoints[0];\n\t});\n\n\t// function to toggle video playback\n\tconst togglePlayback = () => {\n\t\tif (videoRef.current?.paused) {\n\t\t\tvideoRef.current.play();\n\t\t\tsetIsPlaying(true);\n\t\t} else {\n\t\t\tvideoRef.current?.pause();\n\t\t\tsetIsPlaying(false);\n\t\t}\n\t};\n\n\tconst pauseVideo = () => {\n\t\tvideoRef.current.pause();\n\t\tsetIsPlaying(false);\n\t};\n\n\tconst playVideo = () => {\n\t\tvideoRef.current.play();\n\t\tsetIsPlaying(true);\n\t};\n\n\t// function to handle slider changes\n\tconst handleSliderChange = (value) => {\n\t\tvideoRef.current.currentTime = value;\n\t\tsetCurrentTime(value);\n\t};\n\n\tuseEffect(() => {\n\t\tconst handleTimeUpdate = () => {\n\t\t\tsetCurrentTime(videoRef.current.currentTime); // update currentTime state variable\n\t\t};\n\n\t\tvideoRef.current?.addEventListener('timeupdate', handleTimeUpdate);\n\t\treturn () => {\n\t\t\tvideoRef.current?.removeEventListener(\n\t\t\t\t'timeupdate',\n\t\t\t\thandleTimeUpdate\n\t\t\t);\n\t\t};\n\t}, []);\n\n\tconst drawCanvasThumb = async () => {\n\t\tconst canvas = document.createElement('canvas');\n\t\tcanvas.width = videoRef.current.videoWidth;\n\t\tcanvas.height = videoRef.current.videoHeight;\n\t\tconst ctx = canvas.getContext('2d');\n\t\tctx.drawImage(videoRef.current, 0, 0, canvas.width, canvas.height);\n\n\t\tif (options?.ffmpeg_thumb_watermark?.url) {\n\t\t\ttry {\n\t\t\t\tconst watermarkCanvas = drawWatermarkOnCanvas(canvas);\n\t\t\t\treturn watermarkCanvas;\n\t\t\t} catch (error) {\n\t\t\t\tconsole.error('Error drawing watermark:', error);\n\t\t\t}\n\t\t} else {\n\t\t\treturn canvas;\n\t\t}\n\t};\n\n\tconst handleSaveThumbnail = (event, thumb, index) => {\n\t\tevent.currentTarget.classList.add('saving');\n\t\tsetIsSaving(true);\n\t\tif (thumb.type === 'ffmpeg') {\n\t\t\tsetImgAsPoster(thumb.src); // Pass the canvas object directly\n\t\t} else {\n\t\t\tsetCanvasAsPoster(thumb.canvasObject, index); // Pass the canvas object directly\n\t\t}\n\t};\n\n\tconst handleSaveAllThumbnails = async () => {\n\t\tsetIsSaving(true); // Show spinner for the whole operation\n\t\tconst firstThumbType = thumbChoices[0]?.type; // Assuming all generated thumbs are of the same type\n\n\t\tif (firstThumbType === 'canvas') {\n\t\t\t// For canvas thumbnails, upload each one individually using uploadMedia\n\t\t\tfor (const [index, thumb] of thumbChoices.entries()) {\n\t\t\t\ttry {\n\t\t\t\t\tconst videoFilename = getFilename(src);\n\t\t\t\t\tconst thumbBasename =\n\t\t\t\t\t\tvideoFilename.substring(\n\t\t\t\t\t\t\t0,\n\t\t\t\t\t\t\tvideoFilename.lastIndexOf('.')\n\t\t\t\t\t\t) || videoFilename;\n\n\t\t\t\t\tconst file = await new Promise((resolve) =>\n\t\t\t\t\t\tthumb.canvasObject.toBlob((blob) => {\n\t\t\t\t\t\t\tresolve(\n\t\t\t\t\t\t\t\tnew File(\n\t\t\t\t\t\t\t\t\t[blob],\n\t\t\t\t\t\t\t\t\t`${thumbBasename}${filenameSuffix}`,\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\ttype: 'image/png',\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t}, 'image/png')\n\t\t\t\t\t);\n\n\t\t\t\t\tawait uploadMedia({\n\t\t\t\t\t\t// No need to store response, just upload\n\t\t\t\t\t\tfilesList: [file],\n\t\t\t\t\t\tallowedTypes: ['image/png'],\n\t\t\t\t\t\ttitle: `${thumbBasename} ${__('thumbnail')} ${index + 1}`,\n\t\t\t\t\t});\n\t\t\t\t} catch (error) {\n\t\t\t\t\tconsole.error(\n\t\t\t\t\t\t`Error uploading canvas thumbnail ${index + 1}:`,\n\t\t\t\t\t\terror\n\t\t\t\t\t);\n\t\t\t\t\t// Optionally, show a notice for individual failures.\n\t\t\t\t}\n\t\t\t}\n\t\t\tsetThumbChoices([]); // Clear choices after saving\n\t\t} else if (firstThumbType === 'ffmpeg') {\n\t\t\t// For FFmpeg thumbnails, send their temporary URLs to the server to be saved\n\t\t\tconst thumbUrls = thumbChoices.map((thumb) => thumb.src);\n\t\t\ttry {\n\t\t\t\tawait apiFetch({\n\t\t\t\t\tpath: `${thumbApiPath}/save_all`,\n\t\t\t\t\tmethod: 'POST',\n\t\t\t\t\tdata: {\n\t\t\t\t\t\tattachment_id: id,\n\t\t\t\t\t\tthumb_urls: thumbUrls,\n\t\t\t\t\t},\n\t\t\t\t});\n\t\t\t\tsetThumbChoices([]); // Clear choices after saving\n\t\t\t} catch (error) {\n\t\t\t\tconsole.error('Error saving all FFmpeg thumbnails:', error);\n\t\t\t}\n\t\t}\n\t\tsetIsSaving(false); // Hide spinner after all operations complete\n\t};\n\n\tfunction drawWatermarkOnCanvas(canvas) {\n\t\treturn new Promise(async (resolve, reject) => {\n\t\t\ttry {\n\t\t\t\tif (!options?.ffmpeg_thumb_watermark?.url) {\n\t\t\t\t\treject(new Error('No thumbnail watermark set'));\n\t\t\t\t}\n\t\t\t\tconst ctx = canvas.getContext('2d');\n\t\t\t\tconst watermarkImage = new Image();\n\t\t\t\tconst { url, scale, align, x, valign, y } =\n\t\t\t\t\toptions.ffmpeg_thumb_watermark;\n\n\t\t\t\twatermarkImage.crossOrigin = 'Anonymous';\n\t\t\t\twatermarkImage.src = url;\n\n\t\t\t\twatermarkImage.onload = () => {\n\t\t\t\t\tconst canvasWidth = canvas.width;\n\t\t\t\t\tconst canvasHeight = canvas.height;\n\t\t\t\t\tconst watermarkWidth = (canvasWidth * scale) / 100;\n\t\t\t\t\tconst watermarkHeight = (canvasHeight * scale) / 100;\n\n\t\t\t\t\tconst horizontalOffset = (canvasWidth * x) / 100;\n\t\t\t\t\tconst verticalOffset = (canvasHeight * y) / 100;\n\n\t\t\t\t\tlet xPos, yPos;\n\n\t\t\t\t\tswitch (align) {\n\t\t\t\t\t\tcase 'left':\n\t\t\t\t\t\t\txPos = horizontalOffset;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'center':\n\t\t\t\t\t\t\txPos =\n\t\t\t\t\t\t\t\t(canvasWidth - watermarkWidth) / 2 +\n\t\t\t\t\t\t\t\thorizontalOffset;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'right':\n\t\t\t\t\t\t\txPos =\n\t\t\t\t\t\t\t\tcanvasWidth - watermarkWidth - horizontalOffset;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\treject(\n\t\t\t\t\t\t\t\tnew Error(\n\t\t\t\t\t\t\t\t\t__('Invalid horizontal alignment provided')\n\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tswitch (valign) {\n\t\t\t\t\t\tcase 'top':\n\t\t\t\t\t\t\tyPos = verticalOffset;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'center':\n\t\t\t\t\t\t\tyPos =\n\t\t\t\t\t\t\t\t(canvasHeight - watermarkHeight) / 2 +\n\t\t\t\t\t\t\t\tverticalOffset;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'bottom':\n\t\t\t\t\t\t\tyPos =\n\t\t\t\t\t\t\t\tcanvasHeight - watermarkHeight - verticalOffset;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\treject(\n\t\t\t\t\t\t\t\tnew Error(\n\t\t\t\t\t\t\t\t\t__('Invalid vertical alignment provided')\n\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tctx.drawImage(\n\t\t\t\t\t\twatermarkImage,\n\t\t\t\t\t\txPos,\n\t\t\t\t\t\tyPos,\n\t\t\t\t\t\twatermarkWidth,\n\t\t\t\t\t\twatermarkHeight\n\t\t\t\t\t);\n\t\t\t\t\tresolve(canvas);\n\t\t\t\t};\n\n\t\t\t\twatermarkImage.onerror = () => {\n\t\t\t\t\treject(new Error(__('Failed to load watermark image')));\n\t\t\t\t};\n\t\t\t} catch (error) {\n\t\t\t\treject(error);\n\t\t\t}\n\t\t});\n\t}\n\n\tconst setCanvasAsPoster = async (canvasObject, thumbnailIndex = null) => {\n\t\tconst videoFilename = getFilename(src);\n\t\tconst thumbBasename =\n\t\t\tvideoFilename.substring(0, videoFilename.lastIndexOf('.')) ||\n\t\t\tvideoFilename;\n\t\tconst filenameSuffix =\n\t\t\tthumbnailIndex !== null\n\t\t\t\t? `_thumb_canvas_${thumbnailIndex + 1}.png`\n\t\t\t\t: '_thumb_canvas.png';\n\t\tconst titleSuffix =\n\t\t\tthumbnailIndex !== null\n\t\t\t\t? ` ${__('thumbnail')} ${thumbnailIndex + 1}`\n\t\t\t\t: ` ${__('thumbnail')}`;\n\n\t\ttry {\n\t\t\tconst file = await new Promise((resolve) =>\n\t\t\t\tcanvasObject.toBlob((blob) => {\n\t\t\t\t\tresolve(\n\t\t\t\t\t\tnew File([blob], `${thumbBasename}${filenameSuffix}`, {\n\t\t\t\t\t\t\ttype: 'image/png',\n\t\t\t\t\t\t})\n\t\t\t\t\t);\n\t\t\t\t}, 'image/png')\n\t\t\t);\n\n\t\t\tsetIsSaving(true);\n\n\t\t\t// Wrap uploadMedia in a new Promise to ensure we wait for the upload to complete.\n\t\t\tconst media = await new Promise((resolve, reject) => {\n\t\t\t\tuploadMedia({\n\t\t\t\t\tfilesList: [file],\n\t\t\t\t\tallowedTypes: ['image/png'],\n\t\t\t\t\ttitle: `${thumbBasename}${titleSuffix}`,\n\t\t\t\t\tonFileChange: (mediaData) => {\n\t\t\t\t\t\tif (mediaData[0].id) {\n\t\t\t\t\t\t\tresolve(mediaData[0]);\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\tonError: (error) => reject(error),\n\t\t\t\t});\n\t\t\t});\n\n\t\t\tif (media) {\n\t\t\t\tif (\n\t\t\t\t\twp.media &&\n\t\t\t\t\twp.media.featuredImage &&\n\t\t\t\t\twp.media.featuredImage.set\n\t\t\t\t) {\n\t\t\t\t\twp.media.featuredImage.set(media.id);\n\t\t\t\t}\n\t\t\t\tsetPosterData(media.url, media.id);\n\t\t\t} else {\n\t\t\t\t// Handle case where upload succeeds but returns no media data\n\t\t\t\tthrow new Error(__('Media upload failed to return data.'));\n\t\t\t}\n\t\t\tsetIsSaving(false);\n\t\t} catch (error) {\n\t\t\tconsole.error(__('Upload error:'), error);\n\t\t\tsetIsSaving(false);\n\t\t\t// createErrorNotice( error, { type: 'snackbar' } ); // Assuming createErrorNotice is available if needed\n\t\t}\n\t};\n\n\tconst setPosterData = async (new_poster, new_poster_id) => {\n\t\ttry {\n\t\t\tconst metaData = {};\n\t\t\tif (new_poster) {\n\t\t\t\t// Only include if new_poster has a value\n\t\t\t\tmetaData['_kgflashmediaplayer-poster'] = new_poster;\n\t\t\t\tmetaData['_kgflashmediaplayer-poster-id'] =\n\t\t\t\t\tNumber(new_poster_id);\n\t\t\t}\n\n\t\t\tawait attachment?.edit({\n\t\t\t\tfeatured_media: new_poster_id ? Number(new_poster_id) : null,\n\t\t\t\tmeta: metaData,\n\t\t\t});\n\t\t\tawait attachment?.save();\n\n\t\t\tsetAttributes({ poster: new_poster, poster_id: new_poster_id });\n\t\t\tsetThumbChoices([]);\n\t\t} catch (error) {\n\t\t\tconsole.error('Error updating attachment:', error);\n\t\t}\n\t};\n\n\tconst setImgAsPoster = async (thumb_url, index) => {\n\t\ttry {\n\t\t\tconst response = await apiFetch({\n\t\t\t\tpath: thumbApiPath,\n\t\t\t\tmethod: 'PUT',\n\t\t\t\tdata: {\n\t\t\t\t\tattachment_id: id,\n\t\t\t\t\tthumburl: thumb_url,\n\t\t\t\t\tthumbnail_index: index,\n\t\t\t\t},\n\t\t\t});\n\t\t\tsetPosterData(response.thumb_url, response.thumb_id);\n\t\t} catch (error) {\n\t\t\tconsole.error(error);\n\t\t}\n\t};\n\n\tconst generateThumb = async (i, type) => {\n\t\ttry {\n\t\t\tconst path = addQueryArgs(thumbApiPath, {\n\t\t\t\turl: src,\n\t\t\t\ttotal_thumbnails,\n\t\t\t\tthumbnail_index: i,\n\t\t\t\tattachment_id: id,\n\t\t\t\tgenerate_button: type,\n\t\t\t});\n\n\t\t\tconst response = await apiFetch({ path });\n\n\t\t\treturn response;\n\t\t} catch (error) {\n\t\t\tconsole.error(error);\n\t\t}\n\t};\n\n\tconst handleVideoKeyboardControl = (event) => {\n\t\tevent.stopImmediatePropagation();\n\n\t\tswitch (event.code) {\n\t\t\tcase 'Space': // spacebar\n\t\t\t\ttogglePlayback();\n\t\t\t\tbreak;\n\n\t\t\tcase 'ArrowLeft': // left\n\t\t\t\tpauseVideo();\n\t\t\t\tvideoRef.current.currentTime =\n\t\t\t\t\tvideoRef.current.currentTime - 0.042;\n\t\t\t\tbreak;\n\n\t\t\tcase 'ArrowRight': // right\n\t\t\t\tpauseVideo();\n\t\t\t\tvideoRef.current.currentTime =\n\t\t\t\t\tvideoRef.current.currentTime + 0.042;\n\t\t\t\tbreak;\n\n\t\t\tcase 'KeyJ': //j\n\t\t\t\tif (isPlaying) {\n\t\t\t\t\tvideoRef.current.playbackRate = Math.max(\n\t\t\t\t\t\t0,\n\t\t\t\t\t\tvideoRef.current.playbackRate - 1\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t\tbreak;\n\n\t\t\tcase 'KeyK': // k\n\t\t\t\tpauseVideo();\n\t\t\t\tbreak;\n\n\t\t\tcase 'KeyL': //l\n\t\t\t\tif (isPlaying) {\n\t\t\t\t\tvideoRef.current.playbackRate =\n\t\t\t\t\t\tvideoRef.current.playbackRate + 1;\n\t\t\t\t}\n\t\t\t\tplayVideo();\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\t\t\t\treturn; // exit this handler for other keys\n\t\t}\n\t\tevent.preventDefault(); // prevent the default action (scroll / move caret)\n\t};\n\n\tconst handleUseThisFrame = async () => {\n\t\tsetIsSaving(true);\n\t\tconst canvas = await drawCanvasThumb(); // Await the canvas object (no index for single frame)\n\t\tsetCanvasAsPoster(canvas); // Pass the canvas object directly, index will be null\n\t};\n\n\tconst handleToggleVideoPlayer = (event) => {\n\t\tevent.preventDefault();\n\t\tconst next = !isOpened;\n\t\tsetIsOpened(next);\n\t\tif (next && thumbVideoPanel.current) {\n\t\t\tthumbVideoPanel.current.focus();\n\t\t\tthumbVideoPanel.current.addEventListener(\n\t\t\t\t'keydown',\n\t\t\t\thandleVideoKeyboardControl\n\t\t\t);\n\t\t} else {\n\t\t\tthumbVideoPanel.current.addEventListener(\n\t\t\t\t'keydown',\n\t\t\t\thandleVideoKeyboardControl\n\t\t\t);\n\t\t}\n\t};\n\n\treturn (\n\t\t<div className=\"videopack-thumbnail-generator\">\n\t\t\t<PanelBody title={__('Thumbnails')}>\n\t\t\t\t{poster && (\n\t\t\t\t\t<img\n\t\t\t\t\t\tclassName=\"videopack-current-thumbnail\"\n\t\t\t\t\t\tsrc={poster}\n\t\t\t\t\t\talt={__('Current Thumbnail')}\n\t\t\t\t\t/>\n\t\t\t\t)}\n\t\t\t\t<BaseControl className=\"editor-video-poster-control\">\n\t\t\t\t\t<BaseControl.VisualLabel>\n\t\t\t\t\t\t{__('Video Thumbnail')}\n\t\t\t\t\t</BaseControl.VisualLabel>\n\t\t\t\t\t<MediaUpload\n\t\t\t\t\t\ttitle={__('Select video thumbnail')}\n\t\t\t\t\t\tonSelect={onSelectPoster}\n\t\t\t\t\t\tallowedTypes={VIDEO_POSTER_ALLOWED_MEDIA_TYPES}\n\t\t\t\t\t\trender={({ open }) => (\n\t\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\t\tvariant=\"secondary\"\n\t\t\t\t\t\t\t\tonClick={open}\n\t\t\t\t\t\t\t\tref={posterImageButton}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t{!poster ? __('Select') : __('Replace')}\n\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t)}\n\t\t\t\t\t/>\n\t\t\t\t\t{!!poster && (\n\t\t\t\t\t\t<Button onClick={onRemovePoster} variant=\"tertiary\">\n\t\t\t\t\t\t\t{__('Remove')}\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t)}\n\t\t\t\t</BaseControl>\n\t\t\t\t<TextControl // This is the UI control for total_thumbnails.\n\t\t\t\t\tvalue={total_thumbnails}\n\t\t\t\t\tonChange={(value) => {\n\t\t\t\t\t\tif (!value) {\n\t\t\t\t\t\t\tsetAttributes({ total_thumbnails: '' });\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tsetAttributes({ total_thumbnails: Number(value) });\n\t\t\t\t\t\t}\n\t\t\t\t\t}}\n\t\t\t\t\tclassName=\"videopack-total-thumbnails\"\n\t\t\t\t\tdisabled={isSaving}\n\t\t\t\t/>\n\t\t\t\t<Button\n\t\t\t\t\tvariant=\"secondary\"\n\t\t\t\t\tonClick={() => handleGenerate('generate')}\n\t\t\t\t\tclassName=\"videopack-generate\"\n\t\t\t\t\tdisabled={isSaving}\n\t\t\t\t>\n\t\t\t\t\t{__('Generate')}\n\t\t\t\t</Button>\n\t\t\t\t<Button\n\t\t\t\t\tvariant=\"secondary\"\n\t\t\t\t\tonClick={() => handleGenerate('random')}\n\t\t\t\t\tclassName=\"videopack-generate\"\n\t\t\t\t\tdisabled={isSaving}\n\t\t\t\t>\n\t\t\t\t\t{__('Random')}\n\t\t\t\t</Button>\n\t\t\t\t{thumbChoices.length > 0 && (\n\t\t\t\t\t<Button\n\t\t\t\t\t\tvariant=\"primary\"\n\t\t\t\t\t\tonClick={handleSaveAllThumbnails}\n\t\t\t\t\t\tdisabled={isSaving}\n\t\t\t\t\t>\n\t\t\t\t\t\t{__('Save All')}\n\t\t\t\t\t</Button>\n\t\t\t\t)}\n\t\t\t\t{thumbChoices.length > 0 && (\n\t\t\t\t\t<div\n\t\t\t\t\t\tclassName={`videopack-thumbnail-holder${isSaving ? ' disabled' : ''}`}\n\t\t\t\t\t>\n\t\t\t\t\t\t{thumbChoices.map((thumb, index) => (\n\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\t\t\tclassName={'videopack-thumbnail spinner-container'}\n\t\t\t\t\t\t\t\tkey={index}\n\t\t\t\t\t\t\t\tonClick={(event) => {\n\t\t\t\t\t\t\t\t\thandleSaveThumbnail(event, thumb, index);\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<img\n\t\t\t\t\t\t\t\t\tsrc={thumb.src}\n\t\t\t\t\t\t\t\t\talt={`Thumbnail ${index + 1}`}\n\t\t\t\t\t\t\t\t\ttitle={__('Save and set thumbnail')}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t{isSaving && <Spinner />}\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t))}\n\t\t\t\t\t</div>\n\t\t\t\t)}\n\t\t\t\t<div\n\t\t\t\t\tclassName={`components-panel__body videopack-thumb-video ${isOpened ? 'is-opened' : ''}`}\n\t\t\t\t>\n\t\t\t\t\t<h2 className=\"components-panel__body-title\">\n\t\t\t\t\t\t<button\n\t\t\t\t\t\t\tclassName=\"components-button components-panel__body-toggle\"\n\t\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\t\tonClick={handleToggleVideoPlayer}\n\t\t\t\t\t\t\taria-expanded={isOpened}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<span aria-hidden=\"true\">\n\t\t\t\t\t\t\t\t<Icon\n\t\t\t\t\t\t\t\t\tclassName=\"components-panel__arrow\"\n\t\t\t\t\t\t\t\t\ticon={isOpened ? chevronUp : chevronDown}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t{__('Choose From Video')}\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</h2>\n\t\t\t\t\t<div\n\t\t\t\t\t\t\tclassName={`videopack-thumb-video-panel spinner-container${\n\t\t\t\t\t\t\t\tisSaving ? ' saving' : ''\n\t\t\t\t\t\t\t}`}\n\t\t\t\t\t\t\ttabIndex={0}\n\t\t\t\t\t\t\tref={thumbVideoPanel}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t<video\n\t\t\t\t\t\t\tsrc={src}\n\t\t\t\t\t\t\tref={videoRef}\n\t\t\t\t\t\t\tmuted={true}\n\t\t\t\t\t\t\tpreload=\"metadata\"\n\t\t\t\t\t\t\tonClick={togglePlayback}\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<div className=\"videopack-thumb-video-controls\">\n\t\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\t\tclassName=\"videopack-play-pause\"\n\t\t\t\t\t\t\t\tonClick={togglePlayback}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<Dashicon\n\t\t\t\t\t\t\t\t\ticon={\n\t\t\t\t\t\t\t\t\t\tisPlaying\n\t\t\t\t\t\t\t\t\t\t\t? 'controls-pause'\n\t\t\t\t\t\t\t\t\t\t\t: 'controls-play'\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t{!isNaN(videoRef.current?.duration) && (\n\t\t\t\t\t\t\t\t<RangeControl\n\t\t\t\t\t\t\t\t\t__nextHasNoMarginBottom\n\t\t\t\t\t\t\t\t\tmin={0}\n\t\t\t\t\t\t\t\t\tmax={videoRef.current.duration}\n\t\t\t\t\t\t\t\t\tstep=\"any\"\n\t\t\t\t\t\t\t\t\tinitialPosition={0}\n\t\t\t\t\t\t\t\t\tvalue={videoRef.current.currentTime}\n\t\t\t\t\t\t\t\t\tonChange={handleSliderChange}\n\t\t\t\t\t\t\t\t\tclassName=\"videopack-thumbvideo-slider\"\n\t\t\t\t\t\t\t\t\ttype=\"slider\"\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\tvariant=\"secondary\"\n\t\t\t\t\t\t\tonClick={handleUseThisFrame}\n\t\t\t\t\t\t\tclassName=\"videopack-use-this-frame\"\n\t\t\t\t\t\t\tdisabled={isSaving}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{__('Use this frame')}\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t{isSaving && <Spinner />}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</PanelBody>\n\t\t</div>\n\t);\n};\n\nexport default Thumbnails;\n","// extracted by mini-css-extract-plugin\nexport {};","// extracted by mini-css-extract-plugin\nexport {};","import apiFetch from '@wordpress/api-fetch';\nimport { Spinner } from '@wordpress/components';\nimport { useEntityRecord } from '@wordpress/core-data';\nimport { useState, useEffect } from '@wordpress/element';\nimport Thumbnails from '../Thumbnails/Thumbnails';\nimport AdditionalFormats from '../AdditionalFormats';\nimport './attachment-details.scss';\n\nconst AttachmentDetails = ({ attachmentId }) => {\n\tconst [options, setOptions] = useState();\n\tconst [attributes, setAttributes] = useState();\n\tconst attachment = useEntityRecord(\n\t\t'postType',\n\t\t'attachment',\n\t\t!isNaN(attachmentId) ? attachmentId : null\n\t);\n\n\tuseEffect(() => {\n\t\tconsole.log('Attachment component mounted.');\n\t\tapiFetch({\n\t\t\tpath: '/videopack/v1/settings',\n\t\t\tmethod: 'GET',\n\t\t}).then((response) => {\n\t\t\tsetOptions(response);\n\t\t});\n\t\treturn () => console.log('Component unmounted!');\n\t}, []);\n\n\tuseEffect(() => {\n\t\tif (attachment.hasResolved && !attributes) {\n\t\t\tconst combinedAttributes = {\n\t\t\t\tid: attachmentId,\n\t\t\t\ttotal_thumbnails:\n\t\t\t\t\tattachment.record?.meta?.['_videopack-meta']?.total_thumbnails ||\n\t\t\t\t\toptions?.total_thumbnails,\n\t\t\t\tsrc: attachment.record?.source_url,\n\t\t\t\tposter:\n\t\t\t\t\tattachment.record?.meta?.['_kgflashmediaplayer-poster'] ||\n\t\t\t\t\tattachment.record?.media_details?.sizes?.full?.source_url ||\n\t\t\t\t\tattachment.record?.image?.src,\n\t\t\t\tposter_id:\n\t\t\t\t\tattachment.record?.meta?.['_kgflashmediaplayer-poster-id'],\n\t\t\t};\n\t\t\tsetAttributes(combinedAttributes);\n\t\t}\n\t}, [options, attachment, attributes]);\n\n\tif (attributes && attachment.hasResolved && options) {\n\t\treturn (\n\t\t\t<div className=\"videopack-attachment-details\">\n\t\t\t\t<Thumbnails\n\t\t\t\t\tsetAttributes={setAttributes}\n\t\t\t\t\tattributes={attributes}\n\t\t\t\t\tattachment={attachment}\n\t\t\t\t\toptions={options}\n\t\t\t\t/>\n\t\t\t\t<AdditionalFormats attributes={attributes} options={options} />\n\t\t\t</div>\n\t\t);\n\t}\n\treturn <Spinner />;\n};\n\nexport default AttachmentDetails;\n","// extracted by mini-css-extract-plugin\nexport {};","module.exports = window[\"wp\"][\"apiFetch\"];","module.exports = window[\"wp\"][\"blockEditor\"];","module.exports = window[\"wp\"][\"components\"];","module.exports = window[\"wp\"][\"coreData\"];","module.exports = window[\"wp\"][\"data\"];","module.exports = window[\"wp\"][\"element\"];","module.exports = window[\"wp\"][\"i18n\"];","module.exports = window[\"wp\"][\"mediaUtils\"];","module.exports = window[\"wp\"][\"primitives\"];","module.exports = window[\"wp\"][\"url\"];","module.exports = window[\"ReactJSXRuntime\"];","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","import { createRoot } from '@wordpress/element';\nimport AttachmentDetails from './AttachmentDetails';\n\n// render on edit media screen\nconst editMediaContainer = document.getElementById(\n\t'videopack-attachment-details-root'\n);\n\nif (editMediaContainer) {\n\tconst urlParams = new URLSearchParams(window.location.search);\n\tconst postId = urlParams.get('post');\n\n\t// Create a new React root and render the component.\n\tconst videopackReactRoot = createRoot(editMediaContainer);\n\tvideopackReactRoot.render(<AttachmentDetails attachmentId={postId} />);\n}\n\n// Ensure wp.media is loaded.\nif (\n\ttypeof wp === 'undefined' ||\n\t!wp.media ||\n\t!wp.media.view ||\n\t!wp.media.view.Attachment.Details\n) {\n\tconsole.error(\n\t\t'Videopack: wp.media.view.Attachment.Details is not available.'\n\t);\n} else {\n\tconsole.log('Videopack: Extending wp.media.view.Attachment.Details.');\n\n\tconst originalAttachmentDetails = wp.media.view.Attachment.Details;\n\n\tconst extendedAttachmentDetails = originalAttachmentDetails.extend({\n\t\t// A reference to the React root instance.\n\t\tvideopackReactRoot: null,\n\n\t\tinitialize() {\n\t\t\t// Call the original initialize method.\n\t\t\toriginalAttachmentDetails.prototype.initialize.apply(\n\t\t\t\tthis,\n\t\t\t\targuments\n\t\t\t);\n\t\t\t// Listen for the 'ready' event, which is fired after the view is rendered.\n\t\t\tthis.on('ready', this.renderVideopackComponent, this);\n\t\t},\n\n\t\trenderVideopackComponent() {\n\t\t\tconsole.log(\n\t\t\t\t'Videopack: Attachment details ready. Rendering React component.'\n\t\t\t);\n\n\t\t\t// Unmount any existing React component before re-rendering.\n\t\t\tif (this.videopackReactRoot) {\n\t\t\t\tconsole.log('Videopack: Unmounting existing React component.');\n\t\t\t\tthis.videopackReactRoot.unmount();\n\t\t\t\tthis.videopackReactRoot = null;\n\t\t\t}\n\n\t\t\t// Check if the attachment is a video.\n\t\t\tconst isVideo = this.model.attributes.type === 'video';\n\t\t\tconst isAnimatedGif =\n\t\t\t\tthis.model.attributes.subtype === 'gif' &&\n\t\t\t\tthis.model.attributes.meta?.['_kgvid-meta']?.animated;\n\n\t\t\tif (isVideo || isAnimatedGif) {\n\t\t\t\tconsole.log(\n\t\t\t\t\t'Videopack: Video or animated GIF detected. Mounting React component.'\n\t\t\t\t);\n\n\t\t\t\t// Find the .settings section in the attachment details sidebar.\n\t\t\t\t// Note: We use this.$el to scope the find to this view's element.\n\t\t\t\tconst settingsSection = this.$el.find('.settings');\n\t\t\t\tif (settingsSection.length === 0) {\n\t\t\t\t\tconsole.error(\n\t\t\t\t\t\t'Videopack: Could not find the .settings section in the attachment details sidebar.'\n\t\t\t\t\t);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\t// Create and append the root div for our React component.\n\t\t\t\tconst reactRootDiv = document.createElement('div');\n\t\t\t\treactRootDiv.id = 'videopack-attachment-details-root';\n\t\t\t\tsettingsSection.append(reactRootDiv);\n\n\t\t\t\t// Create a new React root and render the component.\n\t\t\t\tthis.videopackReactRoot = createRoot(reactRootDiv);\n\t\t\t\tthis.videopackReactRoot.render(\n\t\t\t\t\t<AttachmentDetails attachmentId={this.model.attributes.id} />\n\t\t\t\t);\n\t\t\t\tconsole.log('Videopack: React component mounted successfully.');\n\t\t\t} else {\n\t\t\t\tconsole.log(\n\t\t\t\t\t'Videopack: Attachment is not a video, skipping React component.'\n\t\t\t\t);\n\t\t\t}\n\t\t},\n\n\t\t// We also need to override remove to clean up our React root.\n\t\tremove() {\n\t\t\t// Unmount the React component when the view is removed.\n\t\t\tif (this.videopackReactRoot) {\n\t\t\t\tconsole.log(\n\t\t\t\t\t'Videopack: Unmounting React component on view removal.'\n\t\t\t\t);\n\t\t\t\tthis.videopackReactRoot.unmount();\n\t\t\t\tthis.videopackReactRoot = null;\n\t\t\t}\n\n\t\t\t// Call the original remove method.\n\t\t\treturn originalAttachmentDetails.prototype.remove.apply(\n\t\t\t\tthis,\n\t\t\t\targuments\n\t\t\t);\n\t\t},\n\t});\n\n\t// Replace the original view with our extended one.\n\twp.media.view.Attachment.Details = extendedAttachmentDetails;\n}\n"],"names":["__","sprintf","apiFetch","Button","CheckboxControl","PanelBody","PanelRow","Spinner","__experimentalDivider","Divider","__experimentalConfirmDialog","ConfirmDialog","MediaUpload","useRef","useEffect","useState","useSelect","store","coreStore","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","AdditionalFormats","attributes","options","id","src","ffmpeg_exists","videoFormats","setVideoFormats","encodeMessage","setEncodeMessage","itemToDelete","setItemToDelete","deleteInProgress","setDeleteInProgress","isConfirmOpen","setIsConfirmOpen","isLoading","setIsLoading","isEncoding","setIsEncoding","progressTimerRef","queueApiPath","deepEqual","obj1","obj2","keys1","Object","keys","keys2","length","key","includes","updateVideoFormats","response","currentVideoFormats","newFormats","forEach","newFormat","oldFormat","checked","encoding_now","progress","percent","fetchVideoFormats","path","then","pollVideoFormats","console","log","method","catch","error","isEmpty","value","Array","isArray","siteSettings","select","getSite","shouldPoll","formats","values","some","format","status","incrementEncodeProgress","updatedVideoFormats","elapsed","Date","getTime","started","remaining","video_duration","totalDurationInSeconds","speedMatch","speed","String","match","parseFloat","increment","remainingPercent","Math","min","max","pollTimer","setInterval","current","clearInterval","handleFormatCheckbox","event","formatId","prevVideoFormats","updatedFormats","getCheckboxCheckedState","formatData","getCheckboxDisabledState","exists","handleEnqueue","window","videopack","settings","formatsToEncode","entries","filter","reduce","acc","data","url","queueMessage","queueList","encode_list","Intl","ListFormat","language","replace","style","type","join","queuePosition","new_queue_position","errorMessage","details","message","onSelectFormat","media","meta","formatPickable","was_picked","handleFileDelete","finally","handleJobDelete","jobId","openConfirmDialog","job_id","name","handleConfirm","handleCancel","convertToTimecode","time","undefined","isNaN","padZero","num","floor","toString","padStart","h","m","s","hh","mm","ss","EncodeProgress","round","percentText","onCancelJob","className","children","width","onClick","variant","isDestructive","size","isBusy","fps","error_message","text","somethingToEncode","obj","encodeButtonTitle","isEncodeButtonDisabled","confirmDialogMessage","canUploadFiles","canUser","title","codecs","map","codec","encode","enabled","resolutions","resolution","__nextHasNoMarginBottom","label","disabled","onChange","status_l10n","onSelect","allowedTypes","render","open","deletable","isOpen","onConfirm","onCancel","BaseControl","Dashicon","Icon","RangeControl","TextControl","useCallback","uploadMedia","addQueryArgs","getFilename","chevronUp","chevronDown","Thumbnails","setAttributes","attachment","poster","poster_id","total_thumbnails","thumbVideoPanel","videoRef","currentThumb","posterImageButton","isPlaying","setIsPlaying","isOpened","setIsOpened","currentTime","setCurrentTime","thumbChoices","setThumbChoices","isSaving","setIsSaving","thumbApiPath","VIDEO_POSTER_ALLOWED_MEDIA_TYPES","mejs","players","mejsContainer","document","querySelector","mejsId","player","setPoster","onSelectPoster","image","Number","onRemovePoster","focus","handleGenerate","browser_thumbnails","newThumbImages","i","generateThumb","thumb","real_thumb_url","push","generateThumbCanvases","thumbsInt","newThumbCanvases","timePoints","_","movieoffset","duration","randomOffset","random","timeupdateListener","drawCanvasThumb","canvas","toDataURL","canvasObject","removeEventListener","addEventListener","togglePlayback","paused","play","pause","pauseVideo","playVideo","handleSliderChange","handleTimeUpdate","createElement","videoWidth","height","videoHeight","ctx","getContext","drawImage","ffmpeg_thumb_watermark","watermarkCanvas","drawWatermarkOnCanvas","handleSaveThumbnail","index","currentTarget","classList","add","setImgAsPoster","setCanvasAsPoster","handleSaveAllThumbnails","firstThumbType","videoFilename","thumbBasename","substring","lastIndexOf","file","Promise","resolve","toBlob","blob","File","filenameSuffix","filesList","thumbUrls","attachment_id","thumb_urls","reject","Error","watermarkImage","Image","scale","align","x","valign","y","crossOrigin","onload","canvasWidth","canvasHeight","watermarkWidth","watermarkHeight","horizontalOffset","verticalOffset","xPos","yPos","onerror","thumbnailIndex","titleSuffix","onFileChange","mediaData","onError","wp","featuredImage","set","setPosterData","new_poster","new_poster_id","metaData","edit","featured_media","save","thumb_url","thumburl","thumbnail_index","thumb_id","generate_button","handleVideoKeyboardControl","stopImmediatePropagation","code","playbackRate","preventDefault","handleUseThisFrame","handleToggleVideoPlayer","next","alt","VisualLabel","ref","icon","tabIndex","muted","preload","step","initialPosition","useEntityRecord","AttachmentDetails","attachmentId","setOptions","hasResolved","combinedAttributes","record","source_url","media_details","sizes","full","createRoot","editMediaContainer","getElementById","urlParams","URLSearchParams","location","search","postId","get","videopackReactRoot","view","Attachment","Details","originalAttachmentDetails","extendedAttachmentDetails","extend","initialize","prototype","apply","arguments","on","renderVideopackComponent","unmount","isVideo","model","isAnimatedGif","subtype","animated","settingsSection","$el","find","reactRootDiv","append","remove"],"sourceRoot":""}