{"version":3,"file":"attachment-details.js","mappings":"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","sources":["webpack://videopack-block/./node_modules/@wordpress/icons/build-module/library/chevron-down.js","webpack://videopack-block/./node_modules/@wordpress/icons/build-module/library/chevron-up.js","webpack://videopack-block/./src/AdditionalFormats.js","webpack://videopack-block/./src/Thumbnails/Thumbnails.js","webpack://videopack-block/./src/Thumbnails/Thumbnails.scss","webpack://videopack-block/./src/attachment-details/AttachmentDetails.js","webpack://videopack-block/./src/icon.js","webpack://videopack-block/external window [\"wp\",\"apiFetch\"]","webpack://videopack-block/external window [\"wp\",\"blockEditor\"]","webpack://videopack-block/external window [\"wp\",\"components\"]","webpack://videopack-block/external window [\"wp\",\"compose\"]","webpack://videopack-block/external window [\"wp\",\"coreData\"]","webpack://videopack-block/external window [\"wp\",\"data\"]","webpack://videopack-block/external window [\"wp\",\"element\"]","webpack://videopack-block/external window [\"wp\",\"i18n\"]","webpack://videopack-block/external window [\"wp\",\"mediaUtils\"]","webpack://videopack-block/external window [\"wp\",\"primitives\"]","webpack://videopack-block/external window [\"wp\",\"url\"]","webpack://videopack-block/external window \"ReactJSXRuntime\"","webpack://videopack-block/webpack/bootstrap","webpack://videopack-block/webpack/runtime/compat get default export","webpack://videopack-block/webpack/runtime/define property getters","webpack://videopack-block/webpack/runtime/hasOwnProperty shorthand","webpack://videopack-block/webpack/runtime/make namespace object","webpack://videopack-block/./src/attachment-details/attachment-details.js"],"sourcesContent":["/**\n * WordPress dependencies\n */\nimport { SVG, Path } from '@wordpress/primitives';\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nconst chevronDown = /*#__PURE__*/_jsx(SVG, {\n  viewBox: \"0 0 24 24\",\n  xmlns: \"http://www.w3.org/2000/svg\",\n  children: /*#__PURE__*/_jsx(Path, {\n    d: \"M17.5 11.6L12 16l-5.5-4.4.9-1.2L12 14l4.5-3.6 1 1.2z\"\n  })\n});\nexport default chevronDown;\n//# sourceMappingURL=chevron-down.js.map","/**\n * WordPress dependencies\n */\nimport { SVG, Path } from '@wordpress/primitives';\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nconst chevronUp = /*#__PURE__*/_jsx(SVG, {\n  viewBox: \"0 0 24 24\",\n  xmlns: \"http://www.w3.org/2000/svg\",\n  children: /*#__PURE__*/_jsx(Path, {\n    d: \"M6.5 12.4L12 8l5.5 4.4-.9 1.2L12 10l-4.5 3.6-1-1.2z\"\n  })\n});\nexport default chevronUp;\n//# sourceMappingURL=chevron-up.js.map","/* global videopack */\n\nimport { __, _x, sprintf } from '@wordpress/i18n';\nimport apiFetch from '@wordpress/api-fetch';\nimport {\n\tButton,\n\tCheckboxControl,\n\tDashicon,\n\tIcon,\n\tPanelBody,\n\tPanelRow,\n\tSpinner,\n\t__experimentalDivider as Divider,\n\t__experimentalConfirmDialog as ConfirmDialog,\n} from '@wordpress/components';\nimport {\n\tMediaUpload,\n\tMediaUploadCheck,\n\t__experimentalGetElementClassName,\n} from '@wordpress/block-editor';\nimport { useRef, useEffect, useState } from '@wordpress/element';\nimport { useSelect } from '@wordpress/data';\n\nconst AdditionalFormats = ({\n\tsetAttributes,\n\tattributes,\n\tattachmentRecord,\n\toptions = {},\n}) => {\n\tconst { id, src, height } = attributes;\n\tconst { ffmpeg_exists } = options;\n\tconst [videoFormats, setVideoFormats] = useState();\n\tconst [encodeMessage, setEncodeMessage] = useState();\n\tconst [itemToDelete, setItemToDelete] = useState(null); // { type: 'file'/'job', formatId: string, jobId?: int, id?: int, name?: string }\n\tconst [deleteInProgress, setDeleteInProgress] = useState(null); // Stores formatId or jobId being deleted\n\tconst [isConfirmOpen, setIsConfirmOpen] = useState(false);\n\tconst [isLoading, setIsLoading] = useState(false);\n\tconst [isEncoding, setIsEncoding] = useState(false);\n\tconst checkboxTimerRef = useRef(null);\n\tconst progressTimerRef = useRef(null);\n\tconst queueApiPath = '/videopack/v1/queue';\n\n\tconst deepEqual = (obj1, obj2) => {\n\t\tif (obj1 === obj2) {\n\t\t\treturn true;\n\t\t}\n\n\t\tif (\n\t\t\ttypeof obj1 !== 'object' ||\n\t\t\ttypeof obj2 !== 'object' ||\n\t\t\tobj1 === null ||\n\t\t\tobj2 === null\n\t\t) {\n\t\t\treturn false;\n\t\t}\n\n\t\tconst keys1 = Object.keys(obj1);\n\t\tconst keys2 = Object.keys(obj2);\n\n\t\tif (keys1.length !== keys2.length) {\n\t\t\treturn false;\n\t\t}\n\n\t\tfor (const key of keys1) {\n\t\t\tif (!keys2.includes(key) || !deepEqual(obj1[key], obj2[key])) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\n\t\treturn true;\n\t};\n\n\tconst updateVideoFormats = (response) => {\n\t\tif (response && typeof response === 'object') {\n\t\t\tconst newFormats = { ...response };\n\t\t\tObject.keys(newFormats).forEach((key) => {\n\t\t\t\t// When updating, preserve the existing 'checked' state.\n\t\t\t\t// This prevents the UI from losing state on a poll refresh.\n\t\t\t\tnewFormats[key].checked = videoFormats?.[key]?.checked || false;\n\t\t\t});\n\n\t\t\t// Only update state if the formats have actually changed.\n\t\t\tif (!deepEqual(videoFormats, newFormats)) {\n\t\t\t\tsetVideoFormats(newFormats);\n\t\t\t}\n\t\t} else if (!deepEqual(videoFormats, response)) {\n\t\t\t// Fallback for non-object responses\n\t\t\tsetVideoFormats(response);\n\t\t}\n\t};\n\n\tconst fetchVideoFormats = () => {\n\t\tif (!id) {\n\t\t\treturn;\n\t\t} // Don't fetch if there's no ID.\n\t\tapiFetch({ path: '/videopack/v1/formats/' + id }).then(\n\t\t\tupdateVideoFormats\n\t\t);\n\t};\n\n\tconst pollVideoFormats = () => {\n\t\tconsole.log('update');\n\t\tif (src && id) {\n\t\t\tapiFetch({ path: '/videopack/v1/formats/' + id, method: 'GET' })\n\t\t\t\t.then(updateVideoFormats)\n\t\t\t\t.catch((error) =>\n\t\t\t\t\tconsole.error('Error polling video formats:', error)\n\t\t\t\t);\n\t\t}\n\t};\n\n\tuseEffect(() => {\n\t\tfetchVideoFormats();\n\t}, [id]); // Fetch formats when the attachment ID changes\n\n\tconst isEmpty = (value) => {\n\t\tif (\n\t\t\tvalue === false ||\n\t\t\tvalue === null ||\n\t\t\t(Array.isArray(value) && value.length === 0) ||\n\t\t\t(typeof value === 'object' && Object.keys(value).length === 0)\n\t\t) {\n\t\t\treturn true;\n\t\t}\n\n\t\treturn false;\n\t};\n\n\tconst siteSettings = useSelect((select) => {\n\t\treturn select('core').getSite();\n\t}, []);\n\n\tconst checkIsEncoding = (formats) => {\n\t\tif (!formats) {\n\t\t\treturn false;\n\t\t}\n\t\t// Check if any format has status 'processing' or 'encoding'\n\t\treturn Object.values(formats).some(\n\t\t\t(format) =>\n\t\t\t\tformat.hasOwnProperty('encoding_now') && format.encoding_now\n\t\t);\n\t};\n\n\tconst incrementEncodeProgress = () => {\n\t\tconsole.log('progress');\n\t\tif (isEncoding) {\n\t\t\t// Use the state variable\n\t\t\tconst updatedVideoFormats = Object.entries(videoFormats).reduce(\n\t\t\t\t(updated, [key, format]) => {\n\t\t\t\t\tif (!isEmpty(format.progress)) {\n\t\t\t\t\t\tconst currentSeconds =\n\t\t\t\t\t\t\tformat.progress.current_seconds +\n\t\t\t\t\t\t\tparseInt(format.progress.fps) / 30;\n\n\t\t\t\t\t\tlet percentDone = Math.round(\n\t\t\t\t\t\t\t(format.progress.current_seconds /\n\t\t\t\t\t\t\t\tparseInt(format.progress.duration)) *\n\t\t\t\t\t\t\t\t100\n\t\t\t\t\t\t);\n\t\t\t\t\t\tif (percentDone > 100) {\n\t\t\t\t\t\t\tpercentDone = 100;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (percentDone !== 0) {\n\t\t\t\t\t\t\tformat.progress.elapsed =\n\t\t\t\t\t\t\t\tformat.progress.elapsed + 1;\n\t\t\t\t\t\t\tif (!isNaN(format.progress.remaining)) {\n\t\t\t\t\t\t\t\tif (format.progress.remaining > 0) {\n\t\t\t\t\t\t\t\t\tformat.progress.remaining--;\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tformat.progress.remaing = 0;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tupdated[key] = {\n\t\t\t\t\t\t\t...format,\n\t\t\t\t\t\t\tprogress: {\n\t\t\t\t\t\t\t\t...format.progress,\n\t\t\t\t\t\t\t\tcurrent_seconds: currentSeconds,\n\t\t\t\t\t\t\t\telapsed: format.progress.elapsed,\n\t\t\t\t\t\t\t\tpercent_done: percentDone,\n\t\t\t\t\t\t\t\tremaining: format.progress.remaining,\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t};\n\t\t\t\t\t} else {\n\t\t\t\t\t\tupdated[key] = format;\n\t\t\t\t\t}\n\t\t\t\t\treturn updated;\n\t\t\t\t},\n\t\t\t\t{}\n\t\t\t);\n\n\t\t\tsetVideoFormats(updatedVideoFormats);\n\t\t}\n\t};\n\n\tuseEffect(() => {\n\t\tsetIsEncoding(checkIsEncoding(videoFormats));\n\t}, [videoFormats]);\n\n\tuseEffect(() => {\n\t\t// Schedule polling for updates\n\t\tcheckboxTimerRef.current = setTimeout(pollVideoFormats, 5000);\n\n\t\t// Manage progress timer based on encoding state\n\t\tif (!isEncoding) {\n\t\t\tclearInterval(progressTimerRef.current);\n\t\t\tprogressTimerRef.current = null;\n\n\t\t\treturn;\n\t\t}\n\t\tif (progressTimerRef.current === null) {\n\t\t\tprogressTimerRef.current = setInterval(\n\t\t\t\tincrementEncodeProgress,\n\t\t\t\t1000\n\t\t\t);\n\t\t}\n\n\t\treturn () => {\n\t\t\tif (progressTimerRef.current !== null) {\n\t\t\t\tclearInterval(progressTimerRef.current);\n\t\t\t\tprogressTimerRef.current = null;\n\t\t\t}\n\t\t\tif (checkboxTimerRef.current !== null) {\n\t\t\t\tclearTimeout(checkboxTimerRef.current);\n\t\t\t\tcheckboxTimerRef.current = null;\n\t\t\t}\n\t\t};\n\t}, [isEncoding]); // Depend on isEncoding state\n\n\tconst handleFormatCheckbox = (event, format) => {\n\t\tsetVideoFormats((prevVideoFormats) => {\n\t\t\tconst updatedFormats = { ...prevVideoFormats };\n\t\t\tif (updatedFormats[format]) {\n\t\t\t\tupdatedFormats[format].checked = event;\n\t\t\t}\n\t\t\treturn updatedFormats;\n\t\t});\n\t\t// Note: Checkbox state is now purely UI. Saving to DB happens on \"Encode\" button click.\n\t};\n\n\tconst onSelectFormat = (media) => {\n\t\tconsole.log('select');\n\t};\n\n\tconst handleEnqueue = () => {\n\t\tsetIsLoading(true);\n\n\t\t// Get list of format IDs that are checked and available\n\t\tconst formatsToEncode = Object.entries(videoFormats)\n\t\t\t.filter(\n\t\t\t\t([key, value]) =>\n\t\t\t\t\tvalue.checked &&\n\t\t\t\t\tvalue.status !== 'queued' &&\n\t\t\t\t\tvalue.status !== 'processing' &&\n\t\t\t\t\tvalue.status !== 'completed'\n\t\t\t)\n\t\t\t.reduce((acc, [key, value]) => {\n\t\t\t\tacc[key] = true; // Backend expects an object { format_id: true, ... }\n\t\t\t\treturn acc;\n\t\t\t}, {});\n\n\t\tapiFetch({\n\t\t\tpath: `${queueApiPath}/${id}`,\n\t\t\tmethod: 'POST',\n\t\t\tdata: {\n\t\t\t\turl: src,\n\t\t\t\tformats: formatsToEncode,\n\t\t\t},\n\t\t})\n\t\t\t.then((response) => {\n\t\t\t\tconsole.log(response);\n\t\t\t\tconst queueMessage = () => {\n\t\t\t\t\tconst queueList = (() => {\n\t\t\t\t\t\tif (response?.enqueue_data?.encode_list) {\n\t\t\t\t\t\t\treturn new Intl.ListFormat(\n\t\t\t\t\t\t\t\tsiteSettings?.language\n\t\t\t\t\t\t\t\t\t? siteSettings.language.replace('_', '-')\n\t\t\t\t\t\t\t\t\t: 'en-US',\n\t\t\t\t\t\t\t\t{ style: 'long', type: 'conjunction' }\n\t\t\t\t\t\t\t).format(\n\t\t\t\t\t\t\t\tObject.values(\n\t\t\t\t\t\t\t\t\tresponse?.enqueue_data?.encode_list\n\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\treturn '';\n\t\t\t\t\t})();\n\n\t\t\t\t\tif (response?.enqueue_data?.new_queue_position == false) {\n\t\t\t\t\t\tconst queuePosition =\n\t\t\t\t\t\t\tresponse?.enqueue_data?.existing_queue_position;\n\n\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t!JSON.stringify(\n\t\t\t\t\t\t\t\tresponse?.enqueue_data?.encode_list\n\t\t\t\t\t\t\t) !== '[]'\n\t\t\t\t\t\t) {\n\t\t\t\t\t\t\treturn sprintf(\n\t\t\t\t\t\t\t\t__(\n\t\t\t\t\t\t\t\t\t'%1$s updated in existing queue entry in position %2$s.'\n\t\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t\tqueueList,\n\t\t\t\t\t\t\t\tqueuePosition\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\treturn sprintf(\n\t\t\t\t\t\t\t__('Video is already %1$s in the queue.'),\n\t\t\t\t\t\t\tqueuePosition\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t\tif (response?.enqueue_data?.new_queue_position === 1) {\n\t\t\t\t\t\treturn __('Starting…');\n\t\t\t\t\t}\n\n\t\t\t\t\tconst queuePosition =\n\t\t\t\t\t\tresponse?.enqueue_data?.new_queue_position;\n\n\t\t\t\t\treturn sprintf(\n\t\t\t\t\t\t__('%1$s added to queue in position %2$s.'),\n\t\t\t\t\t\tqueueList,\n\t\t\t\t\t\tqueuePosition\n\t\t\t\t\t);\n\t\t\t\t};\n\t\t\t\tsetEncodeMessage(queueMessage());\n\t\t\t\tsetIsLoading(false);\n\t\t\t\tfetchVideoFormats(); // Re-fetch to update statuses\n\t\t\t})\n\t\t\t.catch((error) => {\n\t\t\t\tconsole.error(error);\n\t\t\t\t// Use the detailed error messages from the server if available\n\t\t\t\tconst errorMessage = error?.data?.details\n\t\t\t\t\t? error.data.details.join(', ')\n\t\t\t\t\t: error.message;\n\t\t\t\tsetEncodeMessage(sprintf(__('Error: %s'), errorMessage));\n\t\t\t\tsetIsLoading(false);\n\t\t\t\tfetchVideoFormats(); // Re-fetch to ensure UI is consistent\n\t\t\t});\n\t};\n\n\tconst formatPickable = (format) => {\n\t\tif (\n\t\t\tvideoFormats &&\n\t\t\tvideoFormats[format] &&\n\t\t\t// A format is \"pickable\" if the file doesn't exist AND it's not already queued/processing/completed\n\t\t\t((!videoFormats[format].exists &&\n\t\t\t\tvideoFormats[format].status === 'not_encoded') ||\n\t\t\t\tvideoFormats[format].was_picked) &&\n\t\t\t!videoFormats[format].encoding_now\n\t\t) {\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t};\n\n\t// Deletes the actual media file (WP Attachment)\n\tconst handleFileDelete = (formatId) => {\n\t\tconst formatData = videoFormats?.[formatId];\n\t\tif (!formatData || !formatData.id) {\n\t\t\tsetEncodeMessage(\n\t\t\t\t__('Error: Cannot delete file, missing attachment ID.')\n\t\t\t);\n\t\t\tconsole.error(\n\t\t\t\t'Cannot delete file: Missing id for format',\n\t\t\t\tformatId\n\t\t\t);\n\t\t\treturn;\n\t\t}\n\t\tsetDeleteInProgress(formatId); // Mark this formatId as being deleted\n\t\tapiFetch({\n\t\t\tpath: `/wp/v2/media/${formatData.id}?force=true`,\n\t\t\tmethod: 'DELETE',\n\t\t})\n\t\t\t.then(() => {\n\t\t\t\tsetEncodeMessage(__('File deleted successfully.'));\n\t\t\t\tfetchVideoFormats(); // Re-fetch to get the latest status from backend\n\t\t\t})\n\t\t\t.catch((error) => {\n\t\t\t\tconsole.error('File delete failed:', error);\n\t\t\t\tsetEncodeMessage(\n\t\t\t\t\tsprintf(__('Error deleting file: %s'), error.message)\n\t\t\t\t);\n\t\t\t\tfetchVideoFormats(); // Re-fetch to get the latest status\n\t\t\t})\n\t\t\t.finally(() => {\n\t\t\t\tsetDeleteInProgress(null);\n\t\t\t});\n\t};\n\n\t// Deletes/Cancels a queue job\n\tconst handleJobDelete = (jobId) => {\n\t\tif (!jobId) {\n\t\t\tsetEncodeMessage(__('Error: Cannot delete job, missing job ID.'));\n\t\t\tconsole.error('Cannot delete job: Missing job ID');\n\t\t\treturn;\n\t\t}\n\t\tsetDeleteInProgress(jobId); // Mark this jobId as being deleted\n\t\tapiFetch({\n\t\t\tpath: `${queueApiPath}/${jobId}`,\n\t\t\tmethod: 'DELETE',\n\t\t})\n\t\t\t.then((response) => {\n\t\t\t\tsetEncodeMessage(__('Job cancelled/deleted successfully.'));\n\t\t\t\tfetchVideoFormats(); // Re-fetch to get the latest status\n\t\t\t})\n\t\t\t.catch((error) => {\n\t\t\t\tconsole.error('Job delete failed:', error);\n\t\t\t\tsetEncodeMessage(\n\t\t\t\t\tsprintf(__('Error deleting job: %s'), error.message)\n\t\t\t\t);\n\t\t\t\tfetchVideoFormats(); // Re-fetch to get the latest status\n\t\t\t})\n\t\t\t.finally(() => {\n\t\t\t\tsetDeleteInProgress(null);\n\t\t\t});\n\t};\n\n\tconst openConfirmDialog = (type, formatId) => {\n\t\tconst formatData = videoFormats?.[formatId];\n\t\tif (!formatData) {\n\t\t\treturn;\n\t\t}\n\n\t\tsetItemToDelete({\n\t\t\ttype, // 'file' or 'job'\n\t\t\tformatId,\n\t\t\tjobId: formatData.job_id,\n\t\t\tid: formatData.id,\n\t\t\tname: formatData.name,\n\t\t});\n\t\tsetIsConfirmOpen(true);\n\t};\n\n\tconst handleConfirm = () => {\n\t\tsetIsConfirmOpen(false);\n\t\tif (itemToDelete) {\n\t\t\tif (itemToDelete.type === 'file' && itemToDelete.id) {\n\t\t\t\thandleFileDelete(itemToDelete.formatId);\n\t\t\t} else if (itemToDelete.type === 'job' && itemToDelete.jobId) {\n\t\t\t\thandleJobDelete(itemToDelete.jobId);\n\t\t\t}\n\t\t}\n\t\tsetItemToDelete(null);\n\t};\n\n\tconst handleCancel = () => {\n\t\tsetItemToDelete(null);\n\t\tsetIsConfirmOpen(false);\n\t};\n\n\tconst convertToTimecode = (time) => {\n\t\tif (time === null || time === undefined || isNaN(time)) {\n\t\t\treturn '--:--';\n\t\t}\n\t\tconst padZero = (num) => Math.floor(num).toString().padStart(2, '0');\n\n\t\tconst h = Math.floor(time / 3600);\n\t\tconst m = Math.floor((time % 3600) / 60);\n\t\tconst s = Math.floor(time % 60);\n\n\t\tconst hh = h > 0 ? padZero(h) + ':' : '';\n\t\tconst mm = padZero(m);\n\t\tconst ss = padZero(s);\n\n\t\treturn hh + mm + ':' + ss;\n\t};\n\n\tconst EncodeProgress = ({ format }) => {\n\t\tconst formatData = videoFormats?.[format];\n\n\t\tif (\n\t\t\tformatData?.status === 'processing' &&\n\t\t\t!isEmpty(formatData?.progress)\n\t\t) {\n\t\t\tconst percentText = sprintf(\n\t\t\t\t__('%d%%'),\n\t\t\t\tformatData.progress.percent_done\n\t\t\t);\n\t\t\tconst onCancelJob = () => {\n\t\t\t\tif (formatData.job_id) {\n\t\t\t\t\thandleJobDelete(formatData.job_id);\n\t\t\t\t}\n\t\t\t};\n\n\t\t\treturn (\n\t\t\t\t<div className=\"videopack-encode-progress\">\n\t\t\t\t\t<div className=\"videopack-meter\">\n\t\t\t\t\t\t<div\n\t\t\t\t\t\t\tclassName=\"videopack-meter-bar\"\n\t\t\t\t\t\t\tstyle={{ width: percentText }}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<div className=\"videopack-meter-text\">\n\t\t\t\t\t\t\t\t{formatData.progress.percent_done > 20 &&\n\t\t\t\t\t\t\t\t\tpercentText}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t{formatData.job_id && (\n\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\tonClick={onCancelJob}\n\t\t\t\t\t\t\tvariant=\"secondary\"\n\t\t\t\t\t\t\tisDestructive\n\t\t\t\t\t\t\tsize=\"small\"\n\t\t\t\t\t\t\tisBusy={deleteInProgress === formatData.job_id}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{__('Cancel')}\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t)}\n\t\t\t\t\t<div className=\"videopack-encode-progress-small-text\">\n\t\t\t\t\t\t<span>\n\t\t\t\t\t\t\t{__('Elapsed:') +\n\t\t\t\t\t\t\t\t' ' +\n\t\t\t\t\t\t\t\tconvertToTimecode(formatData.progress.elapsed)}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t\t<span>\n\t\t\t\t\t\t\t{__('Remaining:') +\n\t\t\t\t\t\t\t\t' ' +\n\t\t\t\t\t\t\t\tconvertToTimecode(\n\t\t\t\t\t\t\t\t\tformatData.progress.remaining\n\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t\t<span>\n\t\t\t\t\t\t\t{__('fps:') + ' ' + formatData.progress.fps}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t);\n\t\t}\n\t\t// Display error message if status is failed\n\t\tif (\n\t\t\tformatData?.status === 'failed' &&\n\t\t\t!isEmpty(formatData?.error_message)\n\t\t) {\n\t\t\treturn (\n\t\t\t\t<div className=\"videopack-encode-error\">\n\t\t\t\t\t{sprintf(__('Error: %s'), formatData.error_message)}\n\t\t\t\t\t{formatData.job_id && ( // Allow deleting failed jobs\n\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\tonClick={() => openConfirmDialog('job', format)}\n\t\t\t\t\t\t\tvariant=\"link\"\n\t\t\t\t\t\t\ttext={__('Delete Job')}\n\t\t\t\t\t\t\tisDestructive\n\t\t\t\t\t\t\tisBusy={deleteInProgress === formatData.job_id}\n\t\t\t\t\t\t/>\n\t\t\t\t\t)}\n\t\t\t\t</div>\n\t\t\t);\n\t\t}\n\t\treturn null;\n\t};\n\n\tconst somethingToEncode = () => {\n\t\tif (videoFormats) {\n\t\t\t// Check if any format is checked AND available AND not already in a terminal/pending state\n\t\t\treturn Object.values(videoFormats).some(\n\t\t\t\t(obj) =>\n\t\t\t\t\tobj.checked &&\n\t\t\t\t\tobj.status !== 'queued' &&\n\t\t\t\t\tobj.status !== 'processing' &&\n\t\t\t\t\tobj.status !== 'completed' &&\n\t\t\t\t\tobj.status !== 'pending_replacement'\n\t\t\t);\n\t\t}\n\t\treturn false;\n\t};\n\n\tconst encodeButtonTitle = () => {\n\t\tif (somethingToEncode()) {\n\t\t\treturn isLoading ? __('Loading…') : __('Encode selected formats');\n\t\t}\n\n\t\treturn __('Select formats to encode');\n\t};\n\n\tconst isEncodeButtonDisabled =\n\t\tisLoading || ffmpeg_exists !== true || !somethingToEncode();\n\n\tconst confirmDialogMessage = () => {\n\t\tif (!itemToDelete) {\n\t\t\treturn '';\n\t\t}\n\t\tif (itemToDelete.type === 'file') {\n\t\t\treturn sprintf(\n\t\t\t\t__(\n\t\t\t\t\t'You are about to permanently delete the encoded %s video file from your site. This action cannot be undone.'\n\t\t\t\t),\n\t\t\t\titemToDelete.name\n\t\t\t);\n\t\t}\n\t\tif (itemToDelete.type === 'job') {\n\t\t\treturn sprintf(\n\t\t\t\t__(\n\t\t\t\t\t'You are about to permanently delete the encoding job for the %s video. This will also delete the encoded video file if it exists (if created by this job and not yet a separate attachment). This action cannot be undone.'\n\t\t\t\t),\n\t\t\t\titemToDelete.name\n\t\t\t);\n\t\t}\n\t};\n\n\treturn (\n\t\t<>\n\t\t\t<PanelBody title={__('Additional Formats')}>\n\t\t\t\t<MediaUploadCheck>\n\t\t\t\t\t<PanelRow>\n\t\t\t\t\t\t{videoFormats ? (\n\t\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t\t<ul\n\t\t\t\t\t\t\t\t\tclassName={`videopack-formats-list${ffmpeg_exists === true ? '' : ' no-ffmpeg'}`}\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t{videopack.settings.codecs.map((codec) => {\n\t\t\t\t\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t\t\t\t\t!options.encode[codec.id] ||\n\t\t\t\t\t\t\t\t\t\t\t!options.encode[codec.id].enabled\n\t\t\t\t\t\t\t\t\t\t) {\n\t\t\t\t\t\t\t\t\t\t\treturn null;\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t\t\t\t\t<li key={codec.id}>\n\t\t\t\t\t\t\t\t\t\t\t\t<h4 className=\"videopack-codec-name\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t{codec.name}\n\t\t\t\t\t\t\t\t\t\t\t\t</h4>\n\t\t\t\t\t\t\t\t\t\t\t\t<ul>\n\t\t\t\t\t\t\t\t\t\t\t\t\t{videopack.settings.resolutions.map(\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t(resolution) => {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tconst formatId = `${codec.id}_${resolution.id}`;\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tconst formatData =\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvideoFormats[\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tformatId\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t];\n\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tif (!formatData) {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\treturn null;\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t(options.hide_video_formats &&\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t!options\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t.encode[\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tcodec.id\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t.resolutions[\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tresolution\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t.id\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t]) ||\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t(ffmpeg_exists !==\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttrue &&\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tresolution.id ===\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t'fullres')\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t) {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\treturn null;\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tconst isCheckboxDisabled =\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tffmpeg_exists !==\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttrue ||\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tformatData.exists;\n\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<li\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tkey={\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tformatId\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{ffmpeg_exists ===\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttrue ? (\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<CheckboxControl\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t__nextHasNoMarginBottom\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"videopack-format\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tlabel={\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tformatData.label\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tchecked={\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tformatData.checked\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tdisabled={\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tisCheckboxDisabled\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tonChange={(\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tevent\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t) =>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\thandleFormatCheckbox(\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tevent,\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tformatId\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span className=\"videopack-format\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tformatData.label\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{formatData.status !==\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t'not_encoded' && (\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span className=\"videopack-format-status\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tformatData.status_l10n\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{formatData.status ===\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t'not_encoded' &&\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t!formatData.was_picked && (\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvariant=\"secondary\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tonClick={() =>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tonSelectFormat(\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tformatData\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t} // Implement onSelectFormat for linking\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"videopack-format-button\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsize=\"small\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttitle={__(\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t'Pick existing file'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{__(\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t'Pick'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{formatData.was_picked && ( // Show \"Replace\" if it was manually picked/linked\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<MediaUpload\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttitle={sprintf(\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t__(\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t'Replace %s'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tformatData.label\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tonSelect={\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tonSelectFormat\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t} // Implement replace logic\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tallowedTypes={[\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t'video',\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t]}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\trender={({\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\topen,\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}) => (\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvariant=\"secondary\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tonClick={\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\topen\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"videopack-format-button\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsize=\"small\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttitle={__(\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t'Replace file'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{__(\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t'Replace'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{formatData.deletable &&\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tformatData.id && ( // Delete FILE button\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tisBusy={\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tdeleteInProgress ===\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tformatId\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tonClick={() =>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\topenConfirmDialog(\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t'file',\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tformatId\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvariant=\"link\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttext={__(\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t'Delete Permanently'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tisDestructive\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{(formatData.status ===\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t'processing' ||\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tformatData.status ===\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t'failed') && (\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<EncodeProgress\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tformat={\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tformatId\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Divider />\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t\t\t</ul>\n\t\t\t\t\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\t})}\n\t\t\t\t\t\t\t\t</ul>\n\t\t\t\t\t\t\t\t<ConfirmDialog\n\t\t\t\t\t\t\t\t\tisOpen={isConfirmOpen}\n\t\t\t\t\t\t\t\t\tonConfirm={handleConfirm}\n\t\t\t\t\t\t\t\t\tonCancel={handleCancel}\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t{confirmDialogMessage()}\n\t\t\t\t\t\t\t\t</ConfirmDialog>\n\t\t\t\t\t\t\t</>\n\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t\t<Spinner />\n\t\t\t\t\t\t\t</>\n\t\t\t\t\t\t)}\n\t\t\t\t\t</PanelRow>\n\t\t\t\t\t{ffmpeg_exists === true && videoFormats && (\n\t\t\t\t\t\t<PanelRow>\n\t\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\t\tvariant=\"secondary\"\n\t\t\t\t\t\t\t\tonClick={handleEnqueue}\n\t\t\t\t\t\t\t\ttitle={encodeButtonTitle()}\n\t\t\t\t\t\t\t\ttext={__('Encode')}\n\t\t\t\t\t\t\t\tdisabled={isEncodeButtonDisabled}\n\t\t\t\t\t\t\t></Button>\n\t\t\t\t\t\t\t{isLoading && <Spinner />}\n\t\t\t\t\t\t\t{encodeMessage && (\n\t\t\t\t\t\t\t\t<span className=\"videopack-encode-message\">\n\t\t\t\t\t\t\t\t\t{encodeMessage}\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t</PanelRow>\n\t\t\t\t\t)}\n\t\t\t\t</MediaUploadCheck>\n\t\t\t</PanelBody>\n\t\t</>\n\t);\n};\n\nexport default AdditionalFormats;\n","/* global videopack */\n\nimport apiFetch from '@wordpress/api-fetch';\nimport {\n\tBaseControl,\n\tButton,\n\tDashicon,\n\tIcon,\n\tPanelBody,\n\tRangeControl,\n\tSpinner,\n\tTextControl,\n} from '@wordpress/components';\nimport {\n\tMediaUpload,\n\tMediaUploadCheck,\n\t__experimentalGetElementClassName,\n} from '@wordpress/block-editor';\nimport { useCallback, useRef, useEffect, useState } from '@wordpress/element';\nimport { uploadMedia } from '@wordpress/media-utils';\nimport { __, _x } from '@wordpress/i18n';\nimport { addQueryArgs, getFilename } from '@wordpress/url';\nimport { chevronUp, chevronDown } from '@wordpress/icons';\nimport './Thumbnails.scss';\n\nconst Thumbnails = ({\n\tsetAttributes,\n\tattributes,\n\tattachmentRecord,\n\toptions = {},\n}) => {\n\tconst { id, src, poster, poster_id } = attributes;\n\tconst total_thumbnails =\n\t\tattributes.total_thumbnails || options.total_thumbnails;\n\tconst thumbVideoPanel = useRef();\n\tconst videoRef = useRef();\n\tconst currentThumb = useRef();\n\tconst posterImageButton = useRef();\n\tconst [isPlaying, setIsPlaying] = useState(false);\n\tconst [isOpened, setIsOpened] = useState(false);\n\tconst [currentTime, setCurrentTime] = useState(false);\n\tconst [thumbChoices, setThumbChoices] = useState([]);\n\tconst [isSaving, setIsSaving] = useState(false);\n\tconst thumbApiPath = '/videopack/v1/thumbs';\n\n\tconst VIDEO_POSTER_ALLOWED_MEDIA_TYPES = ['image'];\n\n\tfunction onSelectPoster(image) {\n\t\tsetAttributes({ poster: image.url, poster_id: Number(image.id) });\n\t}\n\n\tfunction onRemovePoster() {\n\t\tsetAttributes({ poster: undefined });\n\n\t\t// Move focus back to the Media Upload button.\n\t\tposterImageButton.current.focus();\n\t}\n\n\tconst handleGenerate = async (type = 'generate') => {\n\t\tsetIsSaving(true);\n\t\tif (options?.ffmpeg_exists && !options?.browser_thumbnails) {\n\t\t\tconst newThumbImages = [];\n\t\t\tfor (let i = 1; i <= Number(total_thumbnails); i++) {\n\t\t\t\tconst response = await generateThumb(i, type);\n\t\t\t\tconst thumb = {\n\t\t\t\t\tsrc: response.real_thumb_url,\n\t\t\t\t\ttype: 'ffmpeg',\n\t\t\t\t};\n\t\t\t\tnewThumbImages.push(thumb);\n\t\t\t\tsetThumbChoices([...newThumbImages]); // Update incrementally\n\t\t\t}\n\t\t} else {\n\t\t\tgenerateThumbCanvases(type);\n\t\t}\n\t};\n\n\tconst generateThumbCanvases = useCallback(async (type) => {\n\t\tconst thumbsInt = Number(total_thumbnails);\n\n\t\tconst newThumbCanvases = [];\n\t\tconst timePoints = [...Array(thumbsInt)].map((_, i) => {\n\t\t\tlet movieoffset =\n\t\t\t\t((i + 1) / (thumbsInt + 1)) * videoRef.current.duration;\n\t\t\tif (type === 'random') {\n\t\t\t\tconst randomOffset = Math.floor(\n\t\t\t\t\tMath.random() * (videoRef.current.duration / thumbsInt)\n\t\t\t\t);\n\t\t\t\tmovieoffset = Math.max(movieoffset - randomOffset, 0);\n\t\t\t}\n\t\t\treturn movieoffset;\n\t\t});\n\n\t\tconst timeupdateListener = () => {\n\t\t\tlet thumb;\n\t\t\tdrawCanvasThumb() // This now returns a Promise resolving to a canvas object\n\t\t\t\t.then((canvas) => {\n\t\t\t\t\ttry {\n\t\t\t\t\t\tthumb = {\n\t\t\t\t\t\t\tsrc: canvas.toDataURL(),\n\t\t\t\t\t\t\ttype: 'canvas',\n\t\t\t\t\t\t\tcanvasObject: canvas, // Store the canvas object for later upload\n\t\t\t\t\t\t};\n\t\t\t\t\t} catch (error) {\n\t\t\t\t\t\tconsole.error(error);\n\t\t\t\t\t\tvideoRef.current.removeEventListener(\n\t\t\t\t\t\t\t'timeupdate',\n\t\t\t\t\t\t\ttimeupdateListener\n\t\t\t\t\t\t);\n\t\t\t\t\t\tsetIsSaving(false);\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tnewThumbCanvases.push(thumb);\n\t\t\t\t\tsetThumbChoices([...newThumbCanvases]);\n\t\t\t\t\tif (newThumbCanvases.length === thumbsInt) {\n\t\t\t\t\t\tvideoRef.current.removeEventListener(\n\t\t\t\t\t\t\t'timeupdate',\n\t\t\t\t\t\t\ttimeupdateListener\n\t\t\t\t\t\t);\n\t\t\t\t\t\tsetIsSaving(false);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tvideoRef.current.currentTime =\n\t\t\t\t\t\t\ttimePoints[newThumbCanvases.length];\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\t.catch((error) => {\n\t\t\t\t\tconsole.error('Error processing canvas:', error);\n\t\t\t\t});\n\t\t};\n\n\t\tvideoRef.current.addEventListener('timeupdate', timeupdateListener);\n\t\tvideoRef.current.currentTime = timePoints[0];\n\t});\n\n\t// function to toggle video playback\n\tconst togglePlayback = () => {\n\t\tif (videoRef.current?.paused) {\n\t\t\tvideoRef.current.play();\n\t\t\tsetIsPlaying(true);\n\t\t} else {\n\t\t\tvideoRef.current?.pause();\n\t\t\tsetIsPlaying(false);\n\t\t}\n\t};\n\n\tconst pauseVideo = () => {\n\t\tvideoRef.current.pause();\n\t\tsetIsPlaying(false);\n\t};\n\n\tconst playVideo = () => {\n\t\tvideoRef.current.play();\n\t\tsetIsPlaying(true);\n\t};\n\n\t// function to handle slider changes\n\tconst handleSliderChange = (value) => {\n\t\tvideoRef.current.currentTime = value;\n\t\tsetCurrentTime(value);\n\t};\n\n\tuseEffect(() => {\n\t\tconst handleTimeUpdate = () => {\n\t\t\tsetCurrentTime(videoRef.current.currentTime); // update currentTime state variable\n\t\t};\n\n\t\tvideoRef.current?.addEventListener('timeupdate', handleTimeUpdate);\n\t\treturn () => {\n\t\t\tvideoRef.current?.removeEventListener(\n\t\t\t\t'timeupdate',\n\t\t\t\thandleTimeUpdate\n\t\t\t);\n\t\t};\n\t}, []);\n\n\tconst drawCanvasThumb = async () => {\n\t\tconst canvas = document.createElement('canvas');\n\t\tcanvas.width = videoRef.current.videoWidth;\n\t\tcanvas.height = videoRef.current.videoHeight;\n\t\tconst ctx = canvas.getContext('2d');\n\t\tctx.drawImage(videoRef.current, 0, 0, canvas.width, canvas.height);\n\n\t\tif (options?.ffmpeg_thumb_watermark?.url) {\n\t\t\ttry {\n\t\t\t\tconst watermarkCanvas = drawWatermarkOnCanvas(canvas);\n\t\t\t\treturn watermarkCanvas;\n\t\t\t} catch (error) {\n\t\t\t\tconsole.error('Error drawing watermark:', error);\n\t\t\t}\n\t\t} else {\n\t\t\treturn canvas;\n\t\t}\n\t};\n\n\tconst handleSaveThumbnail = (event, thumb, index) => {\n\t\tevent.currentTarget.classList.add('saving');\n\t\tsetIsSaving(true);\n\t\tif (thumb.type === 'ffmpeg') {\n\t\t\tsetImgAsPoster(thumb.src); // Pass the canvas object directly\n\t\t} else {\n\t\t\tsetCanvasAsPoster(thumb.canvasObject, index); // Pass the canvas object directly\n\t\t}\n\t};\n\n\tconst handleSaveAllThumbnails = async () => {\n\t\tsetIsSaving(true); // Show spinner for the whole operation\n\t\tconst firstThumbType = thumbChoices[0]?.type; // Assuming all generated thumbs are of the same type\n\n\t\tif (firstThumbType === 'canvas') {\n\t\t\t// For canvas thumbnails, upload each one individually using uploadMedia\n\t\t\tfor (const [index, thumb] of thumbChoices.entries()) {\n\t\t\t\ttry {\n\t\t\t\t\tconst videoFilename = getFilename(src);\n\t\t\t\t\tconst thumbBasename =\n\t\t\t\t\t\tvideoFilename.substring(\n\t\t\t\t\t\t\t0,\n\t\t\t\t\t\t\tvideoFilename.lastIndexOf('.')\n\t\t\t\t\t\t) || videoFilename;\n\n\t\t\t\t\tconst file = await new Promise((resolve) =>\n\t\t\t\t\t\tthumb.canvasObject.toBlob((blob) => {\n\t\t\t\t\t\t\tresolve(\n\t\t\t\t\t\t\t\tnew File(\n\t\t\t\t\t\t\t\t\t[blob],\n\t\t\t\t\t\t\t\t\t`${thumbBasename}_thumb_canvas_${index + 1}.png`,\n\t\t\t\t\t\t\t\t\t{ type: 'image/png' }\n\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t}, 'image/png')\n\t\t\t\t\t);\n\n\t\t\t\t\tawait uploadMedia({\n\t\t\t\t\t\t// No need to store response, just upload\n\t\t\t\t\t\tfilesList: [file],\n\t\t\t\t\t\tallowedTypes: ['image/png'],\n\t\t\t\t\t\ttitle: `${thumbBasename} ${__('thumbnail')} ${index + 1}`,\n\t\t\t\t\t});\n\t\t\t\t} catch (error) {\n\t\t\t\t\tconsole.error(\n\t\t\t\t\t\t`Error uploading canvas thumbnail ${index + 1}:`,\n\t\t\t\t\t\terror\n\t\t\t\t\t);\n\t\t\t\t\t// Optionally, show a notice for individual failures.\n\t\t\t\t}\n\t\t\t}\n\t\t\tsetThumbChoices([]); // Clear choices after saving\n\t\t} else if (firstThumbType === 'ffmpeg') {\n\t\t\t// For FFmpeg thumbnails, send their temporary URLs to the server to be saved\n\t\t\tconst thumbUrls = thumbChoices.map((thumb) => thumb.src);\n\t\t\ttry {\n\t\t\t\tawait apiFetch({\n\t\t\t\t\tpath: `${thumbApiPath}/save_all`,\n\t\t\t\t\tmethod: 'POST',\n\t\t\t\t\tdata: {\n\t\t\t\t\t\tattachment_id: id,\n\t\t\t\t\t\tthumb_urls: thumbUrls,\n\t\t\t\t\t},\n\t\t\t\t});\n\t\t\t\tsetThumbChoices([]); // Clear choices after saving\n\t\t\t} catch (error) {\n\t\t\t\tconsole.error('Error saving all FFmpeg thumbnails:', error);\n\t\t\t}\n\t\t}\n\t\tsetIsSaving(false); // Hide spinner after all operations complete\n\t};\n\n\tfunction drawWatermarkOnCanvas(canvas) {\n\t\treturn new Promise(async (resolve, reject) => {\n\t\t\ttry {\n\t\t\t\tif (!options?.ffmpeg_thumb_watermark?.url) {\n\t\t\t\t\treject(new Error('No thumbnail watermark set'));\n\t\t\t\t}\n\t\t\t\tconst ctx = canvas.getContext('2d');\n\t\t\t\tconst watermarkImage = new Image();\n\t\t\t\tconst { url, scale, align, x, valign, y } =\n\t\t\t\t\toptions.ffmpeg_thumb_watermark;\n\n\t\t\t\twatermarkImage.crossOrigin = 'Anonymous';\n\t\t\t\twatermarkImage.src = url;\n\n\t\t\t\twatermarkImage.onload = () => {\n\t\t\t\t\tconst canvasWidth = canvas.width;\n\t\t\t\t\tconst canvasHeight = canvas.height;\n\t\t\t\t\tconst watermarkWidth = (canvasWidth * scale) / 100;\n\t\t\t\t\tconst watermarkHeight = (canvasHeight * scale) / 100;\n\n\t\t\t\t\tconst horizontalOffset = (canvasWidth * x) / 100;\n\t\t\t\t\tconst verticalOffset = (canvasHeight * y) / 100;\n\n\t\t\t\t\tlet xPos, yPos;\n\n\t\t\t\t\tswitch (align) {\n\t\t\t\t\t\tcase 'left':\n\t\t\t\t\t\t\txPos = horizontalOffset;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'center':\n\t\t\t\t\t\t\txPos =\n\t\t\t\t\t\t\t\t(canvasWidth - watermarkWidth) / 2 +\n\t\t\t\t\t\t\t\thorizontalOffset;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'right':\n\t\t\t\t\t\t\txPos =\n\t\t\t\t\t\t\t\tcanvasWidth - watermarkWidth - horizontalOffset;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\treject(\n\t\t\t\t\t\t\t\tnew Error(\n\t\t\t\t\t\t\t\t\t__('Invalid horizontal alignment provided')\n\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tswitch (valign) {\n\t\t\t\t\t\tcase 'top':\n\t\t\t\t\t\t\tyPos = verticalOffset;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'center':\n\t\t\t\t\t\t\tyPos =\n\t\t\t\t\t\t\t\t(canvasHeight - watermarkHeight) / 2 +\n\t\t\t\t\t\t\t\tverticalOffset;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'bottom':\n\t\t\t\t\t\t\tyPos =\n\t\t\t\t\t\t\t\tcanvasHeight - watermarkHeight - verticalOffset;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\treject(\n\t\t\t\t\t\t\t\tnew Error(\n\t\t\t\t\t\t\t\t\t__('Invalid vertical alignment provided')\n\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tctx.drawImage(\n\t\t\t\t\t\twatermarkImage,\n\t\t\t\t\t\txPos,\n\t\t\t\t\t\tyPos,\n\t\t\t\t\t\twatermarkWidth,\n\t\t\t\t\t\twatermarkHeight\n\t\t\t\t\t);\n\t\t\t\t\tresolve(canvas);\n\t\t\t\t};\n\n\t\t\t\twatermarkImage.onerror = () => {\n\t\t\t\t\treject(new Error(__('Failed to load watermark image')));\n\t\t\t\t};\n\t\t\t} catch (error) {\n\t\t\t\treject(error);\n\t\t\t}\n\t\t});\n\t}\n\n\tconst setCanvasAsPoster = async (canvasObject, thumbnailIndex = null) => {\n\t\tconst videoFilename = getFilename(src);\n\t\tconst thumbBasename =\n\t\t\tvideoFilename.substring(0, videoFilename.lastIndexOf('.')) ||\n\t\t\tvideoFilename;\n\t\tconst filenameSuffix =\n\t\t\tthumbnailIndex !== null\n\t\t\t\t? `_thumb_canvas_${thumbnailIndex + 1}.png`\n\t\t\t\t: '_thumb_canvas.png';\n\t\tconst titleSuffix =\n\t\t\tthumbnailIndex !== null\n\t\t\t\t? ` ${__('thumbnail')} ${thumbnailIndex + 1}`\n\t\t\t\t: ` ${__('thumbnail')}`;\n\n\t\ttry {\n\t\t\tconst file = await new Promise((resolve) =>\n\t\t\t\tcanvasObject.toBlob((blob) => {\n\t\t\t\t\tresolve(\n\t\t\t\t\t\tnew File([blob], `${thumbBasename}${filenameSuffix}`, {\n\t\t\t\t\t\t\ttype: 'image/png',\n\t\t\t\t\t\t})\n\t\t\t\t\t);\n\t\t\t\t}, 'image/png')\n\t\t\t);\n\n\t\t\tsetIsSaving(true);\n\t\t\t// uploadMedia returns a promise that resolves with the media object.\n\t\t\tconst media = await uploadMedia({\n\t\t\t\tfilesList: [file],\n\t\t\t\tallowedTypes: ['image/png'],\n\t\t\t\ttitle: `${thumbBasename}${titleSuffix}`,\n\t\t\t});\n\t\t\tsetPosterData(media.url, media.id);\n\t\t\tsetIsSaving(false);\n\t\t} catch (error) {\n\t\t\tconsole.error(__('Upload error:'), error);\n\t\t\t// createErrorNotice( error, { type: 'snackbar' } ); // Assuming createErrorNotice is available if needed\n\t\t}\n\t};\n\n\tconst setPosterData = (new_poster, new_poster_id) => {\n\t\tsetAttributes({ poster: new_poster, poster_id: new_poster_id });\n\t\tsetThumbChoices([]);\n\t\tattachmentRecord\n\t\t\t?.edit({\n\t\t\t\tfeatured_media: new_poster_id ? Number(new_poster_id) : null,\n\t\t\t\tmeta: {\n\t\t\t\t\t'_kgflashmediaplayer-poster': new_poster,\n\t\t\t\t\t'_kgflashmediaplayer-poster-id': Number(new_poster_id),\n\t\t\t\t},\n\t\t\t})\n\t\t\t.then((response) => {\n\t\t\t\tattachmentRecord.save().then((response) => {\n\t\t\t\t\tconsole.log(attachmentRecord);\n\t\t\t\t});\n\t\t\t})\n\t\t\t.catch((error) => {\n\t\t\t\tconsole.error(error);\n\t\t\t});\n\t};\n\n\tconst setImgAsPoster = async (thumb_url, index) => {\n\t\ttry {\n\t\t\tconst response = await apiFetch({\n\t\t\t\tpath: thumbApiPath,\n\t\t\t\tmethod: 'PUT',\n\t\t\t\tdata: {\n\t\t\t\t\tattachment_id: id,\n\t\t\t\t\tthumburl: thumb_url,\n\t\t\t\t\tthumbnail_index: index,\n\t\t\t\t},\n\t\t\t});\n\t\t\tsetPosterData(response.thumb_url, response.thumb_id);\n\t\t} catch (error) {\n\t\t\tconsole.error(error);\n\t\t}\n\t};\n\n\tconst generateThumb = async (i, type) => {\n\t\ttry {\n\t\t\tconst path = addQueryArgs(thumbApiPath, {\n\t\t\t\turl: src,\n\t\t\t\ttotal_thumbnails,\n\t\t\t\tthumbnail_index: i,\n\t\t\t\tattachment_id: id,\n\t\t\t\tgenerate_button: type,\n\t\t\t});\n\n\t\t\tconst response = await apiFetch({ path });\n\n\t\t\treturn response;\n\t\t} catch (error) {\n\t\t\tconsole.error(error);\n\t\t}\n\t};\n\n\tconst handleVideoKeyboardControl = (event) => {\n\t\tevent.stopImmediatePropagation();\n\n\t\tswitch (event.code) {\n\t\t\tcase 'Space': // spacebar\n\t\t\t\ttogglePlayback();\n\t\t\t\tbreak;\n\n\t\t\tcase 'ArrowLeft': // left\n\t\t\t\tpauseVideo();\n\t\t\t\tvideoRef.current.currentTime =\n\t\t\t\t\tvideoRef.current.currentTime - 0.042;\n\t\t\t\tbreak;\n\n\t\t\tcase 'ArrowRight': // right\n\t\t\t\tpauseVideo();\n\t\t\t\tvideoRef.current.currentTime =\n\t\t\t\t\tvideoRef.current.currentTime + 0.042;\n\t\t\t\tbreak;\n\n\t\t\tcase 'KeyJ': //j\n\t\t\t\tif (isPlaying) {\n\t\t\t\t\tvideoRef.current.playbackRate = Math.max(\n\t\t\t\t\t\t0,\n\t\t\t\t\t\tvideoRef.current.playbackRate - 1\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t\tbreak;\n\n\t\t\tcase 'KeyK': // k\n\t\t\t\tpauseVideo();\n\t\t\t\tbreak;\n\n\t\t\tcase 'KeyL': //l\n\t\t\t\tif (isPlaying) {\n\t\t\t\t\tvideoRef.current.playbackRate =\n\t\t\t\t\t\tvideoRef.current.playbackRate + 1;\n\t\t\t\t}\n\t\t\t\tplayVideo();\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\t\t\t\treturn; // exit this handler for other keys\n\t\t}\n\t\tevent.preventDefault(); // prevent the default action (scroll / move caret)\n\t};\n\n\tconst handleUseThisFrame = async () => {\n\t\tsetIsSaving(true);\n\t\tconst canvas = await drawCanvasThumb(); // Await the canvas object (no index for single frame)\n\t\tsetCanvasAsPoster(canvas); // Pass the canvas object directly, index will be null\n\t};\n\n\tconst handleToggleVideoPlayer = (event) => {\n\t\tevent.preventDefault();\n\t\tconst next = !isOpened;\n\t\tsetIsOpened(next);\n\t\tif (next && thumbVideoPanel.current) {\n\t\t\tthumbVideoPanel.current.focus();\n\t\t\tthumbVideoPanel.current.addEventListener(\n\t\t\t\t'keydown',\n\t\t\t\thandleVideoKeyboardControl\n\t\t\t);\n\t\t} else {\n\t\t\tthumbVideoPanel.current.addEventListener(\n\t\t\t\t'keydown',\n\t\t\t\thandleVideoKeyboardControl\n\t\t\t);\n\t\t}\n\t};\n\n\treturn (\n\t\t<div className=\"videopack-thumbnail-generator\">\n\t\t\t<PanelBody title={__('Thumbnails')}>\n\t\t\t\t{poster && (\n\t\t\t\t\t<img\n\t\t\t\t\t\tclassName=\"videopack-current-thumbnail\"\n\t\t\t\t\t\tsrc={poster}\n\t\t\t\t\t\tref={currentThumb}\n\t\t\t\t\t\talt={__('Current Thumbnail')}\n\t\t\t\t\t/>\n\t\t\t\t)}\n\t\t\t\t<BaseControl className=\"editor-video-poster-control\">\n\t\t\t\t\t<BaseControl.VisualLabel>\n\t\t\t\t\t\t{__('Video Thumbnail')}\n\t\t\t\t\t</BaseControl.VisualLabel>\n\t\t\t\t\t<MediaUpload\n\t\t\t\t\t\ttitle={__('Select video thumbnail')}\n\t\t\t\t\t\tonSelect={onSelectPoster}\n\t\t\t\t\t\tallowedTypes={VIDEO_POSTER_ALLOWED_MEDIA_TYPES}\n\t\t\t\t\t\trender={({ open }) => (\n\t\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\t\tvariant=\"secondary\"\n\t\t\t\t\t\t\t\tonClick={open}\n\t\t\t\t\t\t\t\tref={posterImageButton}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t{!poster ? __('Select') : __('Replace')}\n\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t)}\n\t\t\t\t\t/>\n\t\t\t\t\t{!!poster && (\n\t\t\t\t\t\t<Button onClick={onRemovePoster} variant=\"tertiary\">\n\t\t\t\t\t\t\t{__('Remove')}\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t)}\n\t\t\t\t</BaseControl>\n\t\t\t\t<TextControl // This is the UI control for total_thumbnails.\n\t\t\t\t\tvalue={total_thumbnails}\n\t\t\t\t\tonChange={(value) => {\n\t\t\t\t\t\tif (!value) {\n\t\t\t\t\t\t\tsetAttributes({ total_thumbnails: '' });\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tsetAttributes({ total_thumbnails: Number(value) });\n\t\t\t\t\t\t}\n\t\t\t\t\t}}\n\t\t\t\t\tclassName=\"videopack-total-thumbnails\"\n\t\t\t\t\tdisabled={isSaving}\n\t\t\t\t/>\n\t\t\t\t<Button\n\t\t\t\t\tvariant=\"secondary\"\n\t\t\t\t\tonClick={() => handleGenerate('generate')}\n\t\t\t\t\tclassName=\"videopack-generate\"\n\t\t\t\t\tdisabled={isSaving}\n\t\t\t\t>\n\t\t\t\t\t{__('Generate')}\n\t\t\t\t</Button>\n\t\t\t\t<Button\n\t\t\t\t\tvariant=\"secondary\"\n\t\t\t\t\tonClick={() => handleGenerate('random')}\n\t\t\t\t\tclassName=\"videopack-generate\"\n\t\t\t\t\tdisabled={isSaving}\n\t\t\t\t>\n\t\t\t\t\t{__('Random')}\n\t\t\t\t</Button>\n\t\t\t\t{thumbChoices.length > 0 && (\n\t\t\t\t\t<Button\n\t\t\t\t\t\tvariant=\"primary\"\n\t\t\t\t\t\tonClick={handleSaveAllThumbnails}\n\t\t\t\t\t\tdisabled={isSaving}\n\t\t\t\t\t>\n\t\t\t\t\t\t{__('Save All')}\n\t\t\t\t\t</Button>\n\t\t\t\t)}\n\t\t\t\t{thumbChoices.length > 0 && (\n\t\t\t\t\t<div\n\t\t\t\t\t\tclassName={`videopack-thumbnail-holder${isSaving ? ' disabled' : ''}`}\n\t\t\t\t\t>\n\t\t\t\t\t\t{thumbChoices.map((thumb, index) => (\n\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\t\t\tclassName={'videopack-thumbnail'}\n\t\t\t\t\t\t\t\tkey={index}\n\t\t\t\t\t\t\t\tonClick={(event) => {\n\t\t\t\t\t\t\t\t\thandleSaveThumbnail(event, thumb, index);\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<img\n\t\t\t\t\t\t\t\t\tsrc={thumb.src}\n\t\t\t\t\t\t\t\t\talt={`Thumbnail ${index + 1}`}\n\t\t\t\t\t\t\t\t\ttitle={__('Save and set thumbnail')}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t<Spinner />\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t))}\n\t\t\t\t\t</div>\n\t\t\t\t)}\n\t\t\t\t<div\n\t\t\t\t\tclassName={`components-panel__body videopack-thumb-video ${isOpened ? 'is-opened' : ''}`}\n\t\t\t\t>\n\t\t\t\t\t<h2 className=\"components-panel__body-title\">\n\t\t\t\t\t\t<button\n\t\t\t\t\t\t\tclassName=\"components-button components-panel__body-toggle\"\n\t\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\t\tonClick={handleToggleVideoPlayer}\n\t\t\t\t\t\t\taria-expanded={isOpened}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<span aria-hidden=\"true\">\n\t\t\t\t\t\t\t\t<Icon\n\t\t\t\t\t\t\t\t\tclassName=\"components-panel__arrow\"\n\t\t\t\t\t\t\t\t\ticon={isOpened ? chevronUp : chevronDown}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t{__('Choose From Video')}\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</h2>\n\t\t\t\t\t<div\n\t\t\t\t\t\tclassName=\"videopack-thumb-video-panel\"\n\t\t\t\t\t\ttabIndex={0}\n\t\t\t\t\t\tref={thumbVideoPanel}\n\t\t\t\t\t>\n\t\t\t\t\t\t<video\n\t\t\t\t\t\t\tsrc={src}\n\t\t\t\t\t\t\tref={videoRef}\n\t\t\t\t\t\t\tmuted={true}\n\t\t\t\t\t\t\tpreload=\"metadata\"\n\t\t\t\t\t\t\tonClick={togglePlayback}\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\tclassName=\"videopack-play-pause\"\n\t\t\t\t\t\t\tonClick={togglePlayback}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<Dashicon\n\t\t\t\t\t\t\t\ticon={\n\t\t\t\t\t\t\t\t\tisPlaying\n\t\t\t\t\t\t\t\t\t\t? 'controls-pause'\n\t\t\t\t\t\t\t\t\t\t: 'controls-play'\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t{!isNaN(videoRef.current?.duration) && (\n\t\t\t\t\t\t\t<RangeControl\n\t\t\t\t\t\t\t\t__nextHasNoMarginBottom\n\t\t\t\t\t\t\t\tmin={0}\n\t\t\t\t\t\t\t\tmax={videoRef.current.duration}\n\t\t\t\t\t\t\t\tstep=\"any\"\n\t\t\t\t\t\t\t\tinitialPosition={0}\n\t\t\t\t\t\t\t\tvalue={videoRef.current.currentTime}\n\t\t\t\t\t\t\t\tonChange={handleSliderChange}\n\t\t\t\t\t\t\t\tclassName=\"videopack-thumbvideo-slider\"\n\t\t\t\t\t\t\t\ttype=\"slider\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t)}\n\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\tvariant=\"secondary\"\n\t\t\t\t\t\t\tonClick={handleUseThisFrame}\n\t\t\t\t\t\t\tdisabled={isSaving}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{__('Use this frame')}\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</PanelBody>\n\t\t</div>\n\t);\n};\n\nexport default Thumbnails;\n","// extracted by mini-css-extract-plugin\nexport {};","import { __, _x } from '@wordpress/i18n';\nimport apiFetch from '@wordpress/api-fetch';\nimport {\n\tButton,\n\tIcon,\n\tPanel,\n\tPanelRow,\n\tSpinner,\n\tTabPanel,\n\tTooltip,\n} from '@wordpress/components';\nimport { useDebounce } from '@wordpress/compose';\nimport { useEntityRecord } from '@wordpress/core-data';\nimport { createRoot, useMemo, useState, useEffect } from '@wordpress/element';\nimport { videopack } from '../icon';\nimport Thumbnails from '../Thumbnails/Thumbnails';\nimport AdditionalFormats from '../AdditionalFormats';\n\nconst AttachmentDetails = ({ attachmentAttributes }) => {\n\tconst { id } = attachmentAttributes;\n\tconst [options, setOptions] = useState();\n\tconst [attributes, setAttributes] = useState();\n\tconst attachmentRecord = isNaN(id)\n\t\t? null\n\t\t: useEntityRecord('postType', 'attachment', id);\n\n\tuseEffect(() => {\n\t\tconsole.log('Attachment component mounted.');\n\t\tapiFetch({\n\t\t\tpath: '/videopack/v1/settings',\n\t\t\tmethod: 'GET',\n\t\t}).then((response) => {\n\t\t\tsetOptions(response);\n\t\t});\n\t\treturn () => console.log('Component unmounted!');\n\t}, []);\n\n\tuseEffect(() => {\n\t\tconst combinedAttributes = {\n\t\t\tid,\n\t\t\ttotal_thumbnails:\n\t\t\t\tattachmentAttributes?.meta?.['_videopack-meta']\n\t\t\t\t\t?.total_thumbnails || options?.total_thumbnails,\n\t\t\tsrc: attachmentAttributes?.url,\n\t\t\tposter:\n\t\t\t\tattachmentAttributes?.meta?.['_kgflashmediaplayer-poster'] ||\n\t\t\t\tattachmentAttributes?.image?.src,\n\t\t\tposter_id:\n\t\t\t\tattachmentAttributes?.meta?.['_kgflashmediaplayer-poster-id'],\n\t\t};\n\t\tsetAttributes(combinedAttributes);\n\t}, [options]);\n\n\tif (attributes && attachmentRecord.hasResolved && options) {\n\t\treturn (\n\t\t\t<div className=\"videopack-attachment-details\">\n\t\t\t\t<Thumbnails\n\t\t\t\t\tsetAttributes={setAttributes}\n\t\t\t\t\tattributes={attributes}\n\t\t\t\t\tattachmentRecord={attachmentRecord}\n\t\t\t\t\toptions={options}\n\t\t\t\t/>\n\t\t\t\t<AdditionalFormats\n\t\t\t\t\tsetAttributes={setAttributes}\n\t\t\t\t\tattributes={attributes}\n\t\t\t\t\tattachmentRecord={attachmentRecord}\n\t\t\t\t\toptions={options}\n\t\t\t\t/>\n\t\t\t</div>\n\t\t);\n\t}\n\treturn <Spinner />;\n};\n\nexport default AttachmentDetails;\n","const videopack = <svg width='20px' height='20px' xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 395.11 395.11\">\n<g data-name=\"Ellipse 1\" transform=\"rotate(-45 -201.149 592.789)\">\n  <circle\n    cx=\"360.24\"\n    cy=\"595.24\"\n    r=\"182.56\"\n    fill=\"none\"\n    stroke=\"#cd0000\"\n    strokeWidth=\"30\"\n  ></circle>\n</g>\n<path\n  fill=\"#cd0000\"\n  d=\"M95.4 108.3h45.81l57.42 98.69 55.57-98.69h47.49L198.54 286.81 95.4 109.68\"\n></path>\n<path fill=\"#f26a6b\" d=\"M254.2 108.3l-55.57 98.69-57.42-98.69\"></path>\n</svg>;\n\nconst volumeDown = <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 0 24 24\" width=\"24px\" fill=\"currentColor\">\n  <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n  <path d=\"M18.5 12c0-1.77-1.02-3.29-2.5-4.03v8.05c1.48-.73 2.5-2.25 2.5-4.02zM5 9v6h4l5 5V4L9 9H5z\"/>\n</svg>;\n\nconst volumeUp = <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 0 24 24\" width=\"24px\" fill=\"currentColor\">\n  <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n  <path d=\"M3 9v6h4l5 5V4L7 9H3zm13.5 3c0-1.77-1.02-3.29-2.5-4.03v8.05c1.48-.73 2.5-2.25 2.5-4.02zM14 3.23v2.06c2.89.86 5 3.54 5 6.71s-2.11 5.85-5 6.71v2.06c4.01-.91 7-4.49 7-8.77s-2.99-7.86-7-8.77z\"/>\n</svg>;\n\nconst save = <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 0 24 24\" width=\"24px\" fill=\"currentColor\">\n  <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/><path d=\"M17 3H3v18h18V7l-4-4zm-5 16c-1.66 0-3-1.34-3-3s1.34-3 3-3 3 1.34 3 3-1.34 3-3 3zm3-10H5V5h10v4z\"/>\n</svg>;\n\nconst insertImage = <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 0 24 24\" width=\"24px\" fill=\"currentColor\">\n  <path d=\"M21 21V3H3v18h18zM8.5 13.5l2.5 3.01L14.5 12l4.5 6H5l3.5-4.5z\"/>\n</svg>\n\nexport { insertImage, save, videopack, volumeDown, volumeUp };\n","module.exports = window[\"wp\"][\"apiFetch\"];","module.exports = window[\"wp\"][\"blockEditor\"];","module.exports = window[\"wp\"][\"components\"];","module.exports = window[\"wp\"][\"compose\"];","module.exports = window[\"wp\"][\"coreData\"];","module.exports = window[\"wp\"][\"data\"];","module.exports = window[\"wp\"][\"element\"];","module.exports = window[\"wp\"][\"i18n\"];","module.exports = window[\"wp\"][\"mediaUtils\"];","module.exports = window[\"wp\"][\"primitives\"];","module.exports = window[\"wp\"][\"url\"];","module.exports = window[\"ReactJSXRuntime\"];","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","import { createRoot } from '@wordpress/element';\nimport AttachmentDetails from './AttachmentDetails';\n\njQuery(function ($) {\n    // Ensure wp.media is loaded.\n    if (typeof wp === 'undefined' || !wp.media || !wp.media.view || !wp.media.view.Attachment.Details) {\n        console.error('Videopack: wp.media.view.Attachment.Details is not available.');\n        return;\n    }\n\n    console.log('Videopack: Extending wp.media.view.Attachment.Details.');\n\n    const originalAttachmentDetails = wp.media.view.Attachment.Details;\n\n    wp.media.view.Attachment.Details = originalAttachmentDetails.extend({\n        // A reference to the React root instance.\n        videopackReactRoot: null,\n\n        render: function () {\n            console.log('Videopack: Rendering attachment details.');\n\n            // First, call the original render method.\n            originalAttachmentDetails.prototype.render.apply(this, arguments);\n\n            // Unmount any existing React component before re-rendering.\n            if (this.videopackReactRoot) {\n                console.log('Videopack: Unmounting existing React component.');\n                this.videopackReactRoot.unmount();\n                this.videopackReactRoot = null;\n            }\n\n            // Check if the attachment is a video or an animated GIF with our meta.\n            const isVideo = this.model.attributes.type === 'video';\n            const isAnimatedGif = this.model.attributes.subtype === 'gif' && this.model.attributes.meta?.['_kgvid-meta']?.animated;\n\n            if (isVideo || isAnimatedGif) {\n                console.log('Videopack: Video or animated GIF detected. Mounting React component.');\n\n                const settingsSection = this.$el.find('.settings');\n                if (settingsSection.length === 0) {\n                    console.error('Videopack: Could not find the .settings section in the attachment details sidebar.');\n                    return;\n                }\n\n                // Create and append the root div for our React component.\n                const reactRootDiv = document.createElement('div');\n                reactRootDiv.id = 'videopack-attachment-details-root';\n                settingsSection.append(reactRootDiv);\n\n                // Create a new React root and render the component.\n                this.videopackReactRoot = createRoot(reactRootDiv);\n                this.videopackReactRoot.render(\n                    <AttachmentDetails\n                        attachmentAttributes={this.model.attributes}\n                    />\n                );\n                console.log('Videopack: React component mounted successfully.');\n            } else {\n                console.log('Videopack: Attachment is not a video, skipping React component.');\n            }\n\n            return this;\n        },\n\n        remove: function () {\n            // Unmount the React component when the view is removed.\n            if (this.videopackReactRoot) {\n                console.log('Videopack: Unmounting React component on view removal.');\n                this.videopackReactRoot.unmount();\n                this.videopackReactRoot = null;\n            }\n\n            // Call the original remove method.\n            return originalAttachmentDetails.prototype.remove.apply(this, arguments);\n        },\n    });\n});"],"names":["__","_x","sprintf","apiFetch","Button","CheckboxControl","Dashicon","Icon","PanelBody","PanelRow","Spinner","__experimentalDivider","Divider","__experimentalConfirmDialog","ConfirmDialog","MediaUpload","MediaUploadCheck","__experimentalGetElementClassName","useRef","useEffect","useState","useSelect","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","AdditionalFormats","setAttributes","attributes","attachmentRecord","options","id","src","height","ffmpeg_exists","videoFormats","setVideoFormats","encodeMessage","setEncodeMessage","itemToDelete","setItemToDelete","deleteInProgress","setDeleteInProgress","isConfirmOpen","setIsConfirmOpen","isLoading","setIsLoading","isEncoding","setIsEncoding","checkboxTimerRef","progressTimerRef","queueApiPath","deepEqual","obj1","obj2","keys1","Object","keys","keys2","length","key","includes","updateVideoFormats","response","newFormats","forEach","checked","fetchVideoFormats","path","then","pollVideoFormats","console","log","method","catch","error","isEmpty","value","Array","isArray","siteSettings","select","getSite","checkIsEncoding","formats","values","some","format","hasOwnProperty","encoding_now","incrementEncodeProgress","updatedVideoFormats","entries","reduce","updated","progress","currentSeconds","current_seconds","parseInt","fps","percentDone","Math","round","duration","elapsed","isNaN","remaining","remaing","percent_done","current","setTimeout","clearInterval","setInterval","clearTimeout","handleFormatCheckbox","event","prevVideoFormats","updatedFormats","onSelectFormat","media","handleEnqueue","formatsToEncode","filter","status","acc","data","url","queueMessage","queueList","enqueue_data","encode_list","Intl","ListFormat","language","replace","style","type","new_queue_position","queuePosition","existing_queue_position","JSON","stringify","errorMessage","details","join","message","formatPickable","exists","was_picked","handleFileDelete","formatId","formatData","finally","handleJobDelete","jobId","openConfirmDialog","job_id","name","handleConfirm","handleCancel","convertToTimecode","time","undefined","padZero","num","floor","toString","padStart","h","m","s","hh","mm","ss","EncodeProgress","percentText","onCancelJob","className","children","width","onClick","variant","isDestructive","size","isBusy","error_message","text","somethingToEncode","obj","encodeButtonTitle","isEncodeButtonDisabled","confirmDialogMessage","title","videopack","settings","codecs","map","codec","encode","enabled","resolutions","resolution","hide_video_formats","isCheckboxDisabled","__nextHasNoMarginBottom","label","disabled","onChange","status_l10n","onSelect","allowedTypes","render","open","deletable","isOpen","onConfirm","onCancel","BaseControl","RangeControl","TextControl","useCallback","uploadMedia","addQueryArgs","getFilename","chevronUp","chevronDown","Thumbnails","poster","poster_id","total_thumbnails","thumbVideoPanel","videoRef","currentThumb","posterImageButton","isPlaying","setIsPlaying","isOpened","setIsOpened","currentTime","setCurrentTime","thumbChoices","setThumbChoices","isSaving","setIsSaving","thumbApiPath","VIDEO_POSTER_ALLOWED_MEDIA_TYPES","onSelectPoster","image","Number","onRemovePoster","focus","handleGenerate","browser_thumbnails","newThumbImages","i","generateThumb","thumb","real_thumb_url","push","generateThumbCanvases","thumbsInt","newThumbCanvases","timePoints","_","movieoffset","randomOffset","random","max","timeupdateListener","drawCanvasThumb","canvas","toDataURL","canvasObject","removeEventListener","addEventListener","togglePlayback","paused","play","pause","pauseVideo","playVideo","handleSliderChange","handleTimeUpdate","document","createElement","videoWidth","videoHeight","ctx","getContext","drawImage","ffmpeg_thumb_watermark","watermarkCanvas","drawWatermarkOnCanvas","handleSaveThumbnail","index","currentTarget","classList","add","setImgAsPoster","setCanvasAsPoster","handleSaveAllThumbnails","firstThumbType","videoFilename","thumbBasename","substring","lastIndexOf","file","Promise","resolve","toBlob","blob","File","filesList","thumbUrls","attachment_id","thumb_urls","reject","Error","watermarkImage","Image","scale","align","x","valign","y","crossOrigin","onload","canvasWidth","canvasHeight","watermarkWidth","watermarkHeight","horizontalOffset","verticalOffset","xPos","yPos","onerror","thumbnailIndex","filenameSuffix","titleSuffix","setPosterData","new_poster","new_poster_id","edit","featured_media","meta","save","thumb_url","thumburl","thumbnail_index","thumb_id","generate_button","handleVideoKeyboardControl","stopImmediatePropagation","code","playbackRate","preventDefault","handleUseThisFrame","handleToggleVideoPlayer","next","ref","alt","VisualLabel","icon","tabIndex","muted","preload","min","step","initialPosition","Panel","TabPanel","Tooltip","useDebounce","useEntityRecord","createRoot","useMemo","AttachmentDetails","attachmentAttributes","setOptions","combinedAttributes","hasResolved","xmlns","viewBox","transform","cx","cy","r","fill","stroke","strokeWidth","d","volumeDown","volumeUp","insertImage","jQuery","$","wp","view","Attachment","Details","originalAttachmentDetails","extend","videopackReactRoot","prototype","apply","arguments","unmount","isVideo","model","isAnimatedGif","subtype","animated","settingsSection","$el","find","reactRootDiv","append","remove"],"sourceRoot":""}